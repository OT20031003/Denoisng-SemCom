Loading model from models/ldm/text2img-large/model.ckpt
autoencoder.py
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
ldm.modules/diffusionmodules/util.py ; make_schedule = linear
ldm/modules/diffusionmodules/model.py, Enocoder; in_channels = 3, ch_mult = [1, 2, 4, 4]
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
making attention of type 'vanilla' with 512 in_channels
ldm/models/autoencoder.py, AutoencoderKL init, created
Working with z of shape (1, 4, 32, 32) = 4096 dimensions.
making attention of type 'vanilla' with 512 in_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
remove_png complete
img shape = torch.Size([20, 3, 256, 256])
20 images are saved in ./sentimg/
Encoder, forward@@@@@@@@@@@@@@@
autoencoder.py, h = torch.Size([20, 8, 32, 32])
autoencoder.py , moments = torch.Size([20, 8, 32, 32])
encode start = 
z_variance before normalization = tensor([0.5784, 0.5625, 0.6547, 0.5627, 0.7620, 0.7667, 0.7091, 0.6634, 0.5682,
        0.5879, 1.0899, 0.7934, 0.5333, 0.5789, 1.0793, 0.9505, 0.4996, 0.8074,
        0.7414, 0.5451], device='cuda:0')
Variance (Real, all elements): 0.5764585733413696
Variance (Imag, all elements): 0.4260505735874176
--------SNR = -5,  rho_ul = 0.07905694150420949-----------
G_variance = tensor([0.9260, 0.8658, 0.8989, 1.3087, 0.9775, 1.0039, 1.0597, 1.2529, 1.1154,
        0.9457, 1.1081, 1.3059, 0.8888, 0.8646, 1.0964, 0.9095, 0.7786, 0.8737,
        1.4089, 0.8524], device='cuda:0')
G_hat_variance = tensor([0.6100, 0.5904, 0.5313, 0.6231, 0.6828, 0.5358, 0.6066, 0.7571, 0.6308,
        0.6971, 0.5441, 0.8777, 0.6248, 0.6296, 0.5279, 0.6988, 0.5573, 0.5286,
        0.9387, 0.5211], device='cuda:0')
G_tilde_var = tensor([0.3919, 0.2114, 0.4141, 0.6052, 0.3287, 0.3508, 0.3501, 0.3419, 0.4654,
        0.3837, 0.4039, 0.3966, 0.3950, 0.2846, 0.3985, 0.3020, 0.4527, 0.4128,
        0.3469, 0.3596], device='cuda:0')
gamma = tensor([[[0.6126, 0.6126, 0.6126, 0.6126]]], device='cuda:0')
Z_mean = tensor([ 0.0369+0.0937j,  0.0203+0.1857j,  0.1670+0.1528j,  0.1134-0.0544j,
         0.1486+0.0823j, -0.1354+0.0168j, -0.1945-0.0697j,  0.1405+0.1001j,
        -0.0967-0.0900j,  0.1897-0.0724j, -0.0399+0.1098j,  0.0604+0.1086j,
        -0.1810-0.1020j,  0.1008+0.0686j,  0.1043+0.1141j, -0.0526+0.1561j,
        -0.2889+0.0421j, -0.0684-0.1505j,  0.0529-0.1118j, -0.1474-0.0257j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.9958, 0.9638, 0.8673, 1.0171, 1.1147, 0.8747, 0.9902, 1.2360, 1.0297,
        1.1380, 0.8883, 1.4329, 1.0200, 1.0278, 0.8618, 1.1408, 0.9097, 0.8629,
        1.5323, 0.8507], device='cuda:0')
Real_SNR = tensor([-5.2827, -6.0970, -3.9037, -3.4426, -5.2830, -5.3303, -4.1573, -3.4679,
        -4.7200, -4.3177, -4.4152, -2.7023, -4.7883, -5.7313, -5.7692, -3.7223,
        -5.3970, -5.1530, -2.9796, -4.7813], device='cuda:0')
q_var = tensor([1.0002, 0.9991, 0.9982, 1.0002, 0.9911, 0.9937, 0.9805, 0.9986, 1.0000,
        0.9896, 0.9995, 0.9908, 0.9946, 1.0002, 0.9971, 0.9893, 0.9989, 0.9973,
        0.9908, 0.9870], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([1.0002, 0.9991, 0.9982, 1.0002, 0.9911, 0.9937, 0.9805, 0.9986, 1.0000,
        0.9896, 0.9995, 0.9908, 0.9946, 1.0002, 0.9971, 0.9893, 0.9989, 0.9973,
        0.9908, 0.9870], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([3.6850, 3.0846, 5.2452, 5.7736, 3.7684, 3.7023, 4.7344, 5.6576, 4.2694,
        4.7353, 4.5100, 6.8426, 4.1988, 3.4280, 3.3815, 5.3266, 3.6936, 3.8601,
        6.3867, 4.2221], device='cuda:0')
signal_var = tensor([0.2913, 0.2439, 0.4147, 0.4564, 0.2979, 0.2927, 0.3743, 0.4473, 0.3375,
        0.3744, 0.3565, 0.5410, 0.3319, 0.2710, 0.2673, 0.4211, 0.2920, 0.3052,
        0.5049, 0.3338], device='cuda:0')
w_var = tensor([0.9832, 0.9928, 1.0188, 1.0084, 1.0055, 0.9987, 0.9748, 0.9939, 1.0007,
        1.0117, 0.9855, 1.0078, 0.9998, 1.0142, 1.0092, 0.9922, 1.0118, 0.9996,
        1.0027, 1.0037], device='cuda:0')
y_var = tensor([1.2775, 1.2330, 1.4201, 1.4815, 1.3158, 1.2871, 1.3525, 1.4552, 1.3431,
        1.4083, 1.3373, 1.5454, 1.3153, 1.2925, 1.2797, 1.4267, 1.3018, 1.3087,
        1.5095, 1.3350], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([1.5497, 1.5497, 1.5497, 1.5497, 1.5497, 1.5497, 1.5497, 1.5497, 1.5497,
        1.5497, 1.5497, 1.5497, 1.5497, 1.5497, 1.5497, 1.5497, 1.5497, 1.5497,
        1.5497, 1.5497], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 4])) = tensor([[0.1049, 0.1192, 0.1593, 0.1500],
        [0.2281, 0.1240, 0.1878, 0.1744],
        [0.2036, 0.1219, 0.2380, 0.2179],
        [0.1139, 0.0884, 0.1772, 0.1512],
        [0.1920, 0.1155, 0.0892, 0.1083],
        [0.1371, 0.1971, 0.1096, 0.2461],
        [0.2951, 0.1257, 0.1123, 0.1824],
        [0.1324, 0.0956, 0.1009, 0.1851],
        [0.1892, 0.1913, 0.1500, 0.2021],
        [0.1615, 0.0896, 0.1257, 0.1413],
        [0.1857, 0.1328, 0.1926, 0.1626],
        [0.1551, 0.1052, 0.0664, 0.1991],
        [0.1320, 0.1261, 0.4654, 0.1162],
        [0.1203, 0.1494, 0.1079, 0.2264],
        [0.1625, 0.2048, 0.0954, 0.2074],
        [0.1526, 0.1014, 0.2727, 0.1353],
        [0.1292, 0.1885, 0.1041, 0.1192],
        [0.2107, 0.1024, 0.2613, 0.1145],
        [0.0820, 0.0687, 0.1478, 0.1221],
        [0.1850, 0.1182, 0.2161, 0.2054]], device='cuda:0')
Var (shape: torch.Size([20, 4])) = tensor([[0.1177, 0.1338, 0.1788, 0.1684],
        [0.2560, 0.1392, 0.2109, 0.1958],
        [0.2286, 0.1368, 0.2672, 0.2446],
        [0.1279, 0.0992, 0.1990, 0.1697],
        [0.2156, 0.1296, 0.1001, 0.1216],
        [0.1540, 0.2212, 0.1230, 0.2762],
        [0.3313, 0.1411, 0.1260, 0.2047],
        [0.1486, 0.1073, 0.1132, 0.2078],
        [0.2124, 0.2147, 0.1683, 0.2268],
        [0.1813, 0.1006, 0.1411, 0.1586],
        [0.2085, 0.1491, 0.2162, 0.1825],
        [0.1740, 0.1181, 0.0745, 0.2234],
        [0.1482, 0.1415, 0.5224, 0.1304],
        [0.1351, 0.1677, 0.1211, 0.2541],
        [0.1825, 0.2299, 0.1070, 0.2328],
        [0.1713, 0.1138, 0.3061, 0.1519],
        [0.1450, 0.2116, 0.1168, 0.1338],
        [0.2366, 0.1150, 0.2933, 0.1286],
        [0.0921, 0.0771, 0.1659, 0.1371],
        [0.2077, 0.1326, 0.2426, 0.2305]], device='cuda:0')
***********
SINR = tensor([-4.7760, -5.9593, -6.2661, -4.5730, -4.3175, -5.5969, -5.5662, -4.4435,
        -6.2217, -4.5686, -5.8235, -4.1025, -5.4784, -5.0941, -5.4647, -5.2829,
        -4.7518, -5.3472, -3.4695, -5.9860], device='cuda:0')
Real_SINR = tensor([-5.0514, -5.9865, -7.2249, -5.1631, -4.5556, -6.1274, -6.2663, -4.7962,
        -6.5850, -4.9365, -5.6586, -4.9669, -6.8066, -5.3660, -5.9249, -5.7982,
        -4.9043, -6.0970, -3.7866, -6.3266], device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2498, 0.2023, 0.1911, 0.2587, 0.2701, 0.2161, 0.2173, 0.2644, 0.1927,
        0.2588, 0.2074, 0.2800, 0.2207, 0.2363, 0.2213, 0.2286, 0.2508, 0.2260,
        0.3103, 0.2013], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200,
        200, 200, 200, 200, 200, 200], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/t=200/
20 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = -4,  rho_ul = 0.0995267926383743-----------
G_variance = tensor([0.8029, 0.7321, 1.0061, 0.8211, 1.0236, 1.3181, 1.0119, 1.0587, 0.8220,
        1.1089, 0.8690, 1.2799, 1.2788, 1.0730, 0.9009, 1.1989, 0.7762, 0.8026,
        0.8964, 1.4526], device='cuda:0')
G_hat_variance = tensor([0.5804, 0.5368, 0.7315, 0.6585, 0.6207, 0.7485, 0.7456, 0.7970, 0.6421,
        0.7002, 0.5483, 0.6591, 0.7799, 0.6609, 0.6416, 0.6166, 0.6772, 0.5245,
        0.7252, 0.9262], device='cuda:0')
G_tilde_var = tensor([0.3221, 0.2927, 0.3152, 0.3049, 0.3264, 0.3607, 0.4039, 0.3203, 0.2980,
        0.3826, 0.2730, 0.4185, 0.3164, 0.2637, 0.3817, 0.4302, 0.3374, 0.2372,
        0.2852, 0.4196], device='cuda:0')
gamma = tensor([[[0.6656, 0.6656, 0.6656, 0.6656]]], device='cuda:0')
Z_mean = tensor([-0.2250+0.1020j,  0.0659+0.0154j,  0.1256-0.0311j, -0.0275+0.1335j,
        -0.0031+0.1098j, -0.0726+0.0284j,  0.0016-0.0569j,  0.2065-0.0549j,
        -0.0456+0.0522j,  0.1071-0.0700j, -0.0041+0.0508j, -0.0610+0.1192j,
        -0.1548+0.1805j, -0.1917+0.0055j, -0.0444+0.0622j,  0.1311+0.2644j,
        -0.0915-0.1597j,  0.0278+0.0564j,  0.1849+0.1010j,  0.0598-0.0440j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.8720, 0.8064, 1.0989, 0.9894, 0.9325, 1.1246, 1.1201, 1.1973, 0.9646,
        1.0520, 0.8237, 0.9902, 1.1717, 0.9929, 0.9639, 0.9264, 1.0174, 0.7880,
        1.0895, 1.3915], device='cuda:0')
Real_SNR = tensor([-4.4210, -5.6504, -3.1779, -6.3508, -5.3493, -3.2185, -3.7663, -3.5258,
        -4.9322, -2.0815, -4.6124, -3.3943, -1.6628, -3.5693, -4.8768, -4.7027,
        -4.6623, -3.9876, -5.1730, -2.4268], device='cuda:0')
q_var = tensor([1.0002, 0.9991, 0.9982, 1.0002, 0.9911, 0.9937, 0.9805, 0.9986, 1.0000,
        0.9896, 0.9995, 0.9908, 0.9946, 1.0002, 0.9971, 0.9893, 0.9989, 0.9973,
        0.9908, 0.9870], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([1.0002, 0.9991, 0.9982, 1.0002, 0.9911, 0.9937, 0.9805, 0.9986, 1.0000,
        0.9896, 0.9995, 0.9908, 0.9946, 1.0002, 0.9971, 0.9893, 0.9989, 0.9973,
        0.9908, 0.9870], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([3.6134, 2.7232, 4.8392, 2.3870, 2.9585, 4.7930, 4.2200, 4.4575, 3.2845,
        6.3799, 3.4437, 4.6377, 6.9028, 4.4079, 3.2014, 3.3507, 3.4490, 3.9700,
        3.0773, 5.6686], device='cuda:0')
signal_var = tensor([0.3596, 0.2710, 0.4816, 0.2376, 0.2944, 0.4770, 0.4200, 0.4436, 0.3269,
        0.6350, 0.3427, 0.4616, 0.6870, 0.4387, 0.3186, 0.3335, 0.3433, 0.3951,
        0.3063, 0.5642], device='cuda:0')
w_var = tensor([0.9953, 0.9956, 1.0012, 1.0253, 1.0091, 1.0009, 0.9997, 0.9991, 1.0177,
        1.0254, 0.9913, 1.0085, 1.0075, 0.9979, 0.9794, 0.9848, 1.0043, 0.9897,
        1.0079, 0.9865], device='cuda:0')
y_var = tensor([1.3471, 1.2698, 1.4560, 1.2693, 1.3012, 1.4893, 1.4293, 1.4275, 1.3407,
        1.6673, 1.3368, 1.4882, 1.6894, 1.4339, 1.2972, 1.3186, 1.3425, 1.3834,
        1.3250, 1.5842], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([1.3376, 1.3376, 1.3376, 1.3376, 1.3376, 1.3376, 1.3376, 1.3376, 1.3376,
        1.3376, 1.3376, 1.3376, 1.3376, 1.3376, 1.3376, 1.3376, 1.3376, 1.3376,
        1.3376, 1.3376], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 4])) = tensor([[0.1144, 0.1184, 0.1082, 0.1612],
        [0.2773, 0.1277, 0.1884, 0.1407],
        [0.1393, 0.2777, 0.1983, 0.1821],
        [0.1380, 0.1187, 0.1614, 0.0880],
        [0.3305, 0.1825, 0.2176, 0.3156],
        [0.1618, 0.1310, 0.2189, 0.2074],
        [0.2436, 0.1158, 0.1088, 0.1990],
        [0.1224, 0.1182, 0.1518, 0.1420],
        [0.1153, 0.2108, 0.1131, 0.1180],
        [0.1959, 0.1794, 0.1489, 0.1489],
        [0.2107, 0.1221, 0.2857, 0.0829],
        [0.4506, 0.2803, 0.1302, 0.0807],
        [0.0982, 0.0833, 0.1320, 0.1650],
        [0.2020, 0.1515, 0.2437, 0.1292],
        [0.2722, 0.1077, 0.1217, 0.1101],
        [0.1610, 0.1458, 0.1489, 0.1051],
        [0.1228, 0.1365, 0.1207, 0.1953],
        [0.1136, 0.1486, 0.1514, 0.3398],
        [0.0903, 0.1405, 0.0989, 0.1209],
        [0.1369, 0.0736, 0.0828, 0.0729]], device='cuda:0')
Var (shape: torch.Size([20, 4])) = tensor([[0.1296, 0.1342, 0.1227, 0.1826],
        [0.3142, 0.1447, 0.2135, 0.1595],
        [0.1579, 0.3147, 0.2247, 0.2063],
        [0.1564, 0.1345, 0.1829, 0.0997],
        [0.3745, 0.2068, 0.2466, 0.3577],
        [0.1833, 0.1485, 0.2480, 0.2350],
        [0.2760, 0.1312, 0.1233, 0.2255],
        [0.1386, 0.1339, 0.1720, 0.1609],
        [0.1307, 0.2388, 0.1282, 0.1337],
        [0.2220, 0.2033, 0.1687, 0.1687],
        [0.2388, 0.1383, 0.3237, 0.0939],
        [0.5106, 0.3176, 0.1475, 0.0914],
        [0.1112, 0.0944, 0.1496, 0.1870],
        [0.2289, 0.1717, 0.2762, 0.1464],
        [0.3085, 0.1220, 0.1379, 0.1247],
        [0.1825, 0.1652, 0.1688, 0.1191],
        [0.1391, 0.1546, 0.1368, 0.2213],
        [0.1287, 0.1684, 0.1716, 0.3850],
        [0.1024, 0.1592, 0.1120, 0.1370],
        [0.1552, 0.0834, 0.0938, 0.0826]], device='cuda:0')
***********
SINR = tensor([-3.2156, -4.5772, -5.0654, -3.1368, -6.2384, -4.6962, -4.0451, -3.5421,
        -3.4764, -4.5297, -3.8033, -4.2254, -2.8096, -4.6612, -3.5432, -3.6829,
        -3.7465, -4.3580, -2.7206, -1.6607], device='cuda:0')
Real_SINR = tensor([-2.9897, -4.9584, -5.1362, -3.3378, -6.2751, -4.9774, -4.6616, -3.7266,
        -3.7501, -4.7188, -4.1912, -6.0336, -3.3309, -4.8387, -3.8523, -4.0659,
        -4.1241, -4.8051, -2.7390, -2.1190], device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3229, 0.2585, 0.2375, 0.3269, 0.1921, 0.2533, 0.2826, 0.3067, 0.3099,
        0.2606, 0.2941, 0.2743, 0.3437, 0.2548, 0.3066, 0.2999, 0.2968, 0.2683,
        0.3483, 0.4056], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200,
        200, 200, 200, 200, 200, 200], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/t=200/
20 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = -3,  rho_ul = 0.12529680840681806-----------
G_variance = tensor([1.0754, 0.9449, 0.7023, 1.0517, 1.0286, 1.0187, 0.9617, 1.1483, 1.0344,
        1.2169, 1.1372, 0.8334, 1.1272, 0.9140, 0.9271, 1.0839, 1.0303, 0.9294,
        1.4019, 0.9554], device='cuda:0')
G_hat_variance = tensor([0.6530, 0.7728, 0.4925, 0.7303, 0.6362, 0.6557, 0.8467, 0.7774, 0.8436,
        0.8523, 0.5999, 0.5326, 0.7242, 0.7092, 0.6189, 0.7288, 0.6534, 0.6374,
        1.0668, 0.6875], device='cuda:0')
G_tilde_var = tensor([0.3343, 0.2414, 0.2783, 0.3310, 0.3087, 0.3929, 0.2458, 0.2845, 0.2122,
        0.3660, 0.2357, 0.3317, 0.2472, 0.2952, 0.2888, 0.3464, 0.3178, 0.2589,
        0.3217, 0.2823], device='cuda:0')
gamma = tensor([[[0.7148, 0.7148, 0.7148, 0.7148]]], device='cuda:0')
Z_mean = tensor([ 0.0818+0.1218j, -0.0199-0.2287j,  0.2654-0.0455j, -0.1167+0.0809j,
         0.0973+0.0166j,  0.0342-0.1074j, -0.1383-0.0807j, -0.2016+0.2170j,
         0.0126-0.2011j, -0.1571+0.1410j, -0.1813+0.1425j,  0.0102+0.0071j,
        -0.0398+0.0800j, -0.1031+0.1206j, -0.1655+0.0347j,  0.0136-0.1143j,
         0.0281-0.0516j, -0.1507-0.1734j,  0.0323-0.0225j,  0.1136-0.1185j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.9135, 1.0812, 0.6890, 1.0217, 0.8901, 0.9173, 1.1846, 1.0877, 1.1802,
        1.1924, 0.8393, 0.7451, 1.0132, 0.9922, 0.8659, 1.0196, 0.9141, 0.8918,
        1.4925, 0.9619], device='cuda:0')
Real_SNR = tensor([-3.2005, -2.9922, -4.6157, -1.8961, -3.2992, -3.4103, -2.8715, -2.6557,
        -2.2939, -1.7804, -2.6699, -3.5767, -2.8744, -4.2106, -1.6712, -1.7879,
        -2.3092, -3.9144, -1.0338, -3.1390], device='cuda:0')
q_var = tensor([1.0002, 0.9991, 0.9982, 1.0002, 0.9911, 0.9937, 0.9805, 0.9986, 1.0000,
        0.9896, 0.9995, 0.9908, 0.9946, 1.0002, 0.9971, 0.9893, 0.9989, 0.9973,
        0.9908, 0.9870], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([1.0002, 0.9991, 0.9982, 1.0002, 0.9911, 0.9937, 0.9805, 0.9986, 1.0000,
        0.9896, 0.9995, 0.9908, 0.9946, 1.0002, 0.9971, 0.9893, 0.9989, 0.9973,
        0.9908, 0.9870], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([3.8430, 4.0726, 2.7032, 5.1850, 3.7163, 3.7428, 4.2015, 4.3019, 4.6562,
        5.3729, 4.1802, 3.5754, 4.2199, 3.0231, 5.5129, 5.3148, 4.6213, 3.2388,
        6.1748, 3.8764], device='cuda:0')
signal_var = tensor([0.4815, 0.5103, 0.3387, 0.6497, 0.4656, 0.4690, 0.5264, 0.5390, 0.5834,
        0.6732, 0.5238, 0.4480, 0.5287, 0.3788, 0.6907, 0.6659, 0.5790, 0.4058,
        0.7737, 0.4857], device='cuda:0')
w_var = tensor([1.0061, 1.0163, 0.9804, 1.0053, 0.9954, 1.0284, 1.0197, 0.9935, 0.9894,
        1.0144, 0.9686, 1.0208, 1.0249, 0.9987, 1.0149, 1.0051, 0.9854, 0.9994,
        0.9816, 1.0006], device='cuda:0')
y_var = tensor([1.4941, 1.5213, 1.3227, 1.6352, 1.4723, 1.5055, 1.5510, 1.5087, 1.5673,
        1.6880, 1.4854, 1.4537, 1.5617, 1.3852, 1.7021, 1.6446, 1.5734, 1.4075,
        1.7476, 1.4866], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([1.1409, 1.1409, 1.1409, 1.1409, 1.1409, 1.1409, 1.1409, 1.1409, 1.1409,
        1.1409, 1.1409, 1.1409, 1.1409, 1.1409, 1.1409, 1.1409, 1.1409, 1.1409,
        1.1409, 1.1409], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 4])) = tensor([[0.2732, 0.1954, 0.1029, 0.1453],
        [0.1695, 0.1644, 0.0927, 0.3860],
        [0.3836, 0.1583, 0.2692, 0.1235],
        [0.2002, 0.1558, 0.1015, 0.2308],
        [0.2077, 0.1165, 0.2513, 0.1734],
        [0.1729, 0.0866, 0.1488, 0.2397],
        [0.1806, 0.1525, 0.0936, 0.0653],
        [0.1764, 0.1799, 0.1323, 0.2220],
        [0.1359, 0.1217, 0.1378, 0.0904],
        [0.1355, 0.1073, 0.0770, 0.1231],
        [0.1262, 0.1959, 0.2150, 0.1498],
        [0.1466, 0.1397, 0.2982, 0.1345],
        [0.2393, 0.1181, 0.1213, 0.1161],
        [0.1367, 0.1115, 0.1102, 0.1174],
        [0.1418, 0.1074, 0.1386, 0.2877],
        [0.0796, 0.1294, 0.1371, 0.1973],
        [0.2633, 0.0982, 0.5685, 0.1027],
        [0.1215, 0.1271, 0.1106, 0.2016],
        [0.0527, 0.1333, 0.1899, 0.1175],
        [0.1528, 0.1862, 0.1234, 0.1801]], device='cuda:0')
Var (shape: torch.Size([20, 4])) = tensor([[0.3122, 0.2233, 0.1176, 0.1661],
        [0.1937, 0.1879, 0.1059, 0.4412],
        [0.4384, 0.1809, 0.3076, 0.1412],
        [0.2288, 0.1780, 0.1160, 0.2638],
        [0.2374, 0.1332, 0.2872, 0.1982],
        [0.1977, 0.0990, 0.1701, 0.2740],
        [0.2064, 0.1743, 0.1070, 0.0746],
        [0.2016, 0.2056, 0.1512, 0.2538],
        [0.1554, 0.1391, 0.1576, 0.1034],
        [0.1549, 0.1227, 0.0880, 0.1407],
        [0.1442, 0.2239, 0.2457, 0.1712],
        [0.1676, 0.1597, 0.3408, 0.1537],
        [0.2735, 0.1349, 0.1386, 0.1327],
        [0.1563, 0.1274, 0.1260, 0.1342],
        [0.1621, 0.1227, 0.1584, 0.3289],
        [0.0910, 0.1479, 0.1567, 0.2255],
        [0.3010, 0.1122, 0.6497, 0.1174],
        [0.1389, 0.1453, 0.1264, 0.2304],
        [0.0602, 0.1523, 0.2171, 0.1343],
        [0.1746, 0.2128, 0.1410, 0.2058]], device='cuda:0')
***********
SINR = tensor([-3.0359, -3.0378, -3.9129, -2.9974, -3.4355, -2.5736, -1.2712, -3.4084,
        -1.7799, -1.3047, -3.2133, -3.1412, -2.3799, -1.7811, -2.7574, -1.9416,
        -3.0187, -2.2942, -1.0309, -3.0017], device='cuda:0')
Real_SINR = tensor([-3.9993, -4.1946, -4.5693, -3.2575, -3.7710, -3.5104, -1.9851, -3.4562,
        -2.0070, -2.3862, -3.0631, -3.5610, -2.8072, -1.8613, -3.2394, -2.2715,
        -4.8977, -2.2954, -2.1597, -3.5082], device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3320, 0.3319, 0.2889, 0.3340, 0.3119, 0.3560, 0.4273, 0.3133, 0.3990,
        0.4255, 0.3230, 0.3267, 0.3663, 0.3989, 0.3464, 0.3901, 0.3329, 0.3709,
        0.4409, 0.3338], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200,
        200, 200, 200, 200, 200, 200], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/t=200/
20 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = -2,  rho_ul = 0.1577393361200483-----------
G_variance = tensor([1.0810, 1.0219, 0.9425, 0.7922, 0.9014, 1.0822, 1.0053, 1.2378, 1.0275,
        0.8651, 0.7069, 1.1797, 0.9118, 1.0043, 1.0156, 1.0253, 0.8770, 0.9458,
        0.8517, 0.9813], device='cuda:0')
G_hat_variance = tensor([0.7424, 0.7285, 0.7116, 0.5198, 0.7888, 0.8116, 0.9273, 1.0067, 0.9051,
        0.7742, 0.5988, 0.9395, 0.7391, 0.7348, 0.7299, 0.8702, 0.7243, 0.6784,
        0.7748, 0.7876], device='cuda:0')
G_tilde_var = tensor([0.2698, 0.2445, 0.2501, 0.3052, 0.2986, 0.2188, 0.1812, 0.2352, 0.2351,
        0.2754, 0.2511, 0.2175, 0.3313, 0.2297, 0.2523, 0.2202, 0.1970, 0.2497,
        0.1514, 0.2580], device='cuda:0')
gamma = tensor([[[0.7593, 0.7593, 0.7593, 0.7593]]], device='cuda:0')
Z_mean = tensor([ 0.0384+0.0102j, -0.0254+0.1754j,  0.1790-0.1556j,  0.0157+0.0621j,
        -0.2182+0.2077j,  0.0302+0.0105j, -0.0878-0.2116j,  0.0139-0.0062j,
        -0.1411-0.1403j,  0.1268-0.0137j, -0.0943+0.1268j,  0.2312-0.0234j,
         0.1953+0.0358j, -0.0929-0.0241j,  0.0232+0.0696j, -0.0490-0.1770j,
         0.0291-0.0617j, -0.2653-0.0821j, -0.1649+0.0316j, -0.1459+0.1796j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.9777, 0.9595, 0.9372, 0.6845, 1.0389, 1.0689, 1.2213, 1.3258, 1.1920,
        1.0196, 0.7886, 1.2373, 0.9733, 0.9678, 0.9612, 1.1460, 0.9539, 0.8934,
        1.0204, 1.0373], device='cuda:0')
Real_SNR = tensor([-1.2119, -1.4293, -1.3814, -3.4843, -1.0007, -0.7751, -0.9430, -0.4268,
        -0.5886, -1.1908, -2.6514, -1.3332, -2.4147, -2.6577, -0.8927, -0.7200,
        -2.8973, -2.2125, -3.0600, -2.0784], device='cuda:0')
q_var = tensor([1.0002, 0.9991, 0.9982, 1.0002, 0.9911, 0.9937, 0.9805, 0.9986, 1.0000,
        0.9896, 0.9995, 0.9908, 0.9946, 1.0002, 0.9971, 0.9893, 0.9989, 0.9973,
        0.9908, 0.9870], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([1.0002, 0.9991, 0.9982, 1.0002, 0.9911, 0.9937, 0.9805, 0.9986, 1.0000,
        0.9896, 0.9995, 0.9908, 0.9946, 1.0002, 0.9971, 0.9893, 0.9989, 0.9973,
        0.9908, 0.9870], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([4.7746, 4.5541, 4.5144, 2.8759, 5.0795, 5.2990, 5.2188, 5.6999, 5.4790,
        4.8166, 3.4558, 4.6567, 3.5953, 3.5202, 5.0792, 5.3760, 3.2424, 3.8396,
        3.0905, 4.0095], device='cuda:0')
signal_var = tensor([0.7531, 0.7184, 0.7121, 0.4536, 0.8012, 0.8359, 0.8232, 0.8991, 0.8643,
        0.7598, 0.5451, 0.7345, 0.5671, 0.5553, 0.8012, 0.8480, 0.5114, 0.6057,
        0.4875, 0.6325], device='cuda:0')
w_var = tensor([0.9955, 0.9983, 0.9788, 1.0119, 1.0089, 0.9992, 1.0229, 0.9920, 0.9897,
        0.9995, 1.0038, 0.9985, 0.9889, 1.0239, 0.9840, 1.0009, 0.9966, 1.0080,
        0.9862, 1.0206], device='cuda:0')
y_var = tensor([1.7973, 1.6998, 1.6849, 1.4652, 1.7897, 1.8367, 1.8555, 1.8970, 1.8422,
        1.7576, 1.5660, 1.7237, 1.5612, 1.5895, 1.7704, 1.8540, 1.5061, 1.6348,
        1.4734, 1.6504], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([0.9627, 0.9627, 0.9627, 0.9627, 0.9627, 0.9627, 0.9627, 0.9627, 0.9627,
        0.9627, 0.9627, 0.9627, 0.9627, 0.9627, 0.9627, 0.9627, 0.9627, 0.9627,
        0.9627, 0.9627], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 4])) = tensor([[0.1275, 0.1463, 0.1809, 0.1316],
        [0.0962, 0.2137, 0.1666, 0.1440],
        [0.1539, 0.2107, 0.2481, 0.0935],
        [0.2405, 0.1938, 0.1923, 0.1935],
        [0.1242, 0.1982, 0.1396, 0.1779],
        [0.2363, 0.2618, 0.3378, 0.3260],
        [0.1070, 0.0963, 0.1431, 0.0894],
        [0.1167, 0.1101, 0.0935, 0.1477],
        [0.1111, 0.1377, 0.1734, 0.1169],
        [0.2097, 0.0854, 0.2044, 0.1232],
        [0.1551, 0.1948, 0.1009, 0.2961],
        [0.1837, 0.0972, 0.1537, 0.0944],
        [0.1954, 0.1380, 0.0893, 0.0903],
        [0.1436, 0.2002, 0.0968, 0.1094],
        [0.1387, 0.1376, 0.1005, 0.2964],
        [0.2009, 0.0963, 0.2612, 0.0892],
        [0.1983, 0.1209, 0.1243, 0.1121],
        [0.1305, 0.2655, 0.1783, 0.1091],
        [0.1470, 0.1901, 0.0826, 0.1093],
        [0.1720, 0.1553, 0.1926, 0.2464]], device='cuda:0')
Var (shape: torch.Size([20, 4])) = tensor([[0.1468, 0.1685, 0.2084, 0.1515],
        [0.1108, 0.2461, 0.1918, 0.1658],
        [0.1773, 0.2427, 0.2858, 0.1077],
        [0.2770, 0.2232, 0.2216, 0.2229],
        [0.1431, 0.2283, 0.1607, 0.2049],
        [0.2721, 0.3015, 0.3891, 0.3755],
        [0.1233, 0.1110, 0.1649, 0.1029],
        [0.1344, 0.1268, 0.1077, 0.1701],
        [0.1280, 0.1586, 0.1998, 0.1347],
        [0.2415, 0.0984, 0.2354, 0.1419],
        [0.1786, 0.2244, 0.1163, 0.3411],
        [0.2116, 0.1120, 0.1771, 0.1087],
        [0.2250, 0.1589, 0.1029, 0.1041],
        [0.1654, 0.2306, 0.1115, 0.1260],
        [0.1598, 0.1585, 0.1158, 0.3415],
        [0.2314, 0.1109, 0.3008, 0.1027],
        [0.2285, 0.1393, 0.1432, 0.1291],
        [0.1503, 0.3058, 0.2054, 0.1256],
        [0.1694, 0.2190, 0.0952, 0.1259],
        [0.1981, 0.1788, 0.2218, 0.2839]], device='cuda:0')
***********
SINR = tensor([-1.4088, -1.3753, -1.7069, -2.9092, -1.7210, -4.3647, -0.0644, -0.3951,
        -0.9965, -1.1547, -1.8949, -0.6884, -0.4563, -0.8774, -1.4108, -1.0209,
        -1.0401, -1.6670, -0.6249, -2.5253], device='cuda:0')
Real_SINR = tensor([-1.5778, -1.3998, -2.5729, -3.2854, -2.0273, -4.5272, -0.1920, -0.0819,
        -1.4030, -2.0309, -2.5055, -1.3548, -0.8366, -1.3580, -2.1494, -1.7990,
        -0.8935, -2.1879, -0.7476, -2.8776], device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4196, 0.4215, 0.4030, 0.3385, 0.4022, 0.2680, 0.4963, 0.4773, 0.4429,
        0.4339, 0.3926, 0.4605, 0.4738, 0.4497, 0.4195, 0.4415, 0.4404, 0.4052,
        0.4641, 0.3586], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200,
        200, 200, 200, 200, 200, 200], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/t=200/
20 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = -1,  rho_ul = 0.19858205868107037-----------
G_variance = tensor([1.1287, 1.0737, 0.8285, 0.8922, 0.9258, 1.0023, 1.0364, 1.0737, 0.9107,
        0.9822, 1.0376, 1.0645, 0.9799, 1.0680, 1.2656, 0.9420, 1.3611, 1.0030,
        1.3222, 1.1207], device='cuda:0')
G_hat_variance = tensor([0.9690, 0.8928, 0.8078, 0.6581, 0.6979, 0.7659, 0.7291, 0.7674, 0.6036,
        0.6866, 0.7923, 0.8315, 0.7746, 0.8479, 1.0597, 0.8489, 1.3202, 0.7527,
        1.1302, 0.8342], device='cuda:0')
G_tilde_var = tensor([0.1918, 0.1952, 0.2263, 0.2334, 0.2069, 0.1858, 0.2474, 0.2490, 0.1891,
        0.2413, 0.1968, 0.1675, 0.2130, 0.1642, 0.2097, 0.1715, 0.1969, 0.1221,
        0.2572, 0.1909], device='cuda:0')
gamma = tensor([[[0.7989, 0.7989, 0.7989, 0.7989]]], device='cuda:0')
Z_mean = tensor([-0.1638-0.1385j,  0.0901+0.1703j,  0.0232+0.1216j, -0.0463-0.1515j,
        -0.0172+0.1120j,  0.0049-0.0316j, -0.1802-0.1077j,  0.1499+0.1113j,
         0.1282-0.0871j,  0.0466-0.1192j, -0.0147+0.0749j, -0.0330-0.0569j,
        -0.0839-0.1656j,  0.0881+0.0233j,  0.1151-0.2692j, -0.1041-0.0019j,
        -0.0639-0.1890j,  0.1654-0.0234j, -0.0073+0.1990j, -0.0609+0.1556j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.2130, 1.1176, 1.0112, 0.8238, 0.8736, 0.9587, 0.9126, 0.9606, 0.7556,
        0.8595, 0.9918, 1.0408, 0.9696, 1.0614, 1.3265, 1.0626, 1.6527, 0.9422,
        1.4148, 1.0442], device='cuda:0')
Real_SNR = tensor([-0.0530, -0.5952, -2.0068, -1.6915, -0.8246, -1.3046, -0.2381, -1.7381,
        -0.7841,  0.0700,  0.1482,  0.6227, -1.4763,  0.2769,  1.7775, -3.1511,
         0.9081, -0.4166, -1.0571, -0.3746], device='cuda:0')
q_var = tensor([1.0002, 0.9991, 0.9982, 1.0002, 0.9911, 0.9937, 0.9805, 0.9986, 1.0000,
        0.9896, 0.9995, 0.9908, 0.9946, 1.0002, 0.9971, 0.9893, 0.9989, 0.9973,
        0.9908, 0.9870], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([1.0002, 0.9991, 0.9982, 1.0002, 0.9911, 0.9937, 0.9805, 0.9986, 1.0000,
        0.9896, 0.9995, 0.9908, 0.9946, 1.0002, 0.9971, 0.9893, 0.9989, 0.9973,
        0.9908, 0.9870], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([4.9793, 4.3903, 3.1551, 3.4438, 4.1221, 3.7674, 4.8574, 3.3631, 4.2448,
        5.1534, 5.2361, 5.7485, 3.6375, 5.4272, 7.4498, 2.4704, 6.0246, 4.6434,
        3.8715, 4.5971], device='cuda:0')
signal_var = tensor([0.9888, 0.8718, 0.6266, 0.6839, 0.8186, 0.7481, 0.9646, 0.6679, 0.8429,
        1.0234, 1.0398, 1.1416, 0.7223, 1.0777, 1.4794, 0.4906, 1.1964, 0.9221,
        0.7688, 0.9129], device='cuda:0')
w_var = tensor([1.0009, 0.9999, 0.9946, 1.0096, 0.9897, 1.0103, 1.0190, 0.9965, 1.0097,
        1.0070, 1.0049, 0.9891, 1.0148, 1.0112, 0.9825, 1.0135, 0.9706, 1.0149,
        0.9807, 0.9952], device='cuda:0')
y_var = tensor([1.9790, 1.8387, 1.6250, 1.6760, 1.8263, 1.7667, 1.9735, 1.6649, 1.8397,
        2.0112, 2.0464, 2.1344, 1.7135, 2.0922, 2.4440, 1.5103, 2.1418, 1.9509,
        1.7395, 1.9085], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([0.8046, 0.8046, 0.8046, 0.8046, 0.8046, 0.8046, 0.8046, 0.8046, 0.8046,
        0.8046, 0.8046, 0.8046, 0.8046, 0.8046, 0.8046, 0.8046, 0.8046, 0.8046,
        0.8046, 0.8046], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 4])) = tensor([[0.0675, 0.1813, 0.1314, 0.0824],
        [0.1336, 0.1393, 0.2230, 0.1177],
        [0.2050, 0.2226, 0.0945, 0.1766],
        [0.3134, 0.4559, 0.2907, 0.1927],
        [0.1856, 0.1627, 0.2633, 0.2194],
        [0.1973, 0.1710, 0.1083, 0.1275],
        [0.1360, 0.1176, 0.2495, 0.3015],
        [0.1281, 0.1773, 0.0974, 0.1552],
        [0.2440, 0.1791, 0.5093, 0.2117],
        [0.2712, 0.1161, 0.1299, 0.1458],
        [0.2430, 0.0785, 0.2599, 0.1494],
        [0.1466, 0.1263, 0.1145, 0.2124],
        [0.1855, 0.1341, 0.1212, 0.1148],
        [0.0839, 0.1527, 0.1963, 0.1823],
        [0.1607, 0.3972, 0.1942, 0.0916],
        [0.2594, 0.2311, 0.2380, 0.1963],
        [0.0721, 0.0644, 0.1455, 0.0700],
        [0.1860, 0.2524, 0.1504, 0.1223],
        [0.1021, 0.1185, 0.0646, 0.1135],
        [0.1039, 0.2152, 0.1084, 0.1456]], device='cuda:0')
Var (shape: torch.Size([20, 4])) = tensor([[0.0783, 0.2103, 0.1524, 0.0956],
        [0.1549, 0.1615, 0.2587, 0.1365],
        [0.2377, 0.2582, 0.1096, 0.2048],
        [0.3634, 0.5287, 0.3371, 0.2235],
        [0.2153, 0.1887, 0.3054, 0.2545],
        [0.2288, 0.1983, 0.1256, 0.1478],
        [0.1578, 0.1364, 0.2894, 0.3497],
        [0.1486, 0.2056, 0.1130, 0.1800],
        [0.2830, 0.2077, 0.5907, 0.2455],
        [0.3145, 0.1346, 0.1507, 0.1690],
        [0.2818, 0.0910, 0.3014, 0.1733],
        [0.1700, 0.1465, 0.1327, 0.2463],
        [0.2152, 0.1556, 0.1406, 0.1331],
        [0.0973, 0.1771, 0.2277, 0.2114],
        [0.1863, 0.4606, 0.2253, 0.1062],
        [0.3009, 0.2680, 0.2760, 0.2277],
        [0.0837, 0.0747, 0.1688, 0.0812],
        [0.2157, 0.2927, 0.1745, 0.1419],
        [0.1184, 0.1374, 0.0750, 0.1316],
        [0.1206, 0.2496, 0.1257, 0.1689]], device='cuda:0')
***********
SINR = tensor([ 1.3670, -0.2434, -0.5755, -3.1947, -1.6740, -0.1890, -1.0093,  0.1331,
        -2.5202, -0.3690, -0.2840, -0.1604,  0.0831, -0.0294, -0.7135, -2.2353,
         2.3776, -0.8291,  1.6255,  0.1624], device='cuda:0')
Real_SINR = tensor([ 0.5680, -0.9327, -1.1612, -3.6411, -1.8652, -0.2133, -1.8250, -0.0708,
        -3.2812, -0.9047, -1.0373, -0.2306, -0.2432, -0.0180, -2.2191, -2.1918,
         1.5949, -0.8484,  1.3302, -0.0081], device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5780, 0.4860, 0.4669, 0.3240, 0.4048, 0.4891, 0.4422, 0.5077, 0.3589,
        0.4788, 0.4837, 0.4908, 0.5048, 0.4983, 0.4590, 0.3741, 0.6335, 0.4524,
        0.5925, 0.5093], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200,
        200, 200, 200, 200, 200, 200], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/t=200/
20 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 0,  rho_ul = 0.25-----------
G_variance = tensor([0.9716, 1.0604, 0.8002, 0.8711, 1.0461, 0.6492, 1.3168, 1.0370, 0.7065,
        1.0436, 0.8297, 0.9147, 1.0470, 0.9355, 1.1469, 0.8342, 1.0249, 1.2981,
        0.7325, 0.9463], device='cuda:0')
G_hat_variance = tensor([0.8309, 0.8765, 0.7371, 0.6533, 0.8077, 0.6311, 1.2790, 0.8812, 0.5864,
        0.8453, 0.7048, 0.7627, 0.8415, 0.7077, 0.8491, 0.7263, 0.7786, 1.0281,
        0.6303, 0.6977], device='cuda:0')
G_tilde_var = tensor([0.1748, 0.1706, 0.1936, 0.2163, 0.1187, 0.1907, 0.1422, 0.1787, 0.1382,
        0.1787, 0.1295, 0.1855, 0.1795, 0.1685, 0.1521, 0.1438, 0.1656, 0.1489,
        0.1480, 0.1750], device='cuda:0')
gamma = tensor([[[0.8333, 0.8333, 0.8333, 0.8333]]], device='cuda:0')
Z_mean = tensor([-0.1673-0.0481j,  0.1292+0.1284j,  0.1198+0.1159j, -0.2254+0.0006j,
         0.0504-0.2583j,  0.2003-0.0065j,  0.0068-0.1454j, -0.2612-0.1255j,
        -0.0224-0.0285j,  0.1988-0.0997j,  0.0664-0.0865j, -0.0152-0.0035j,
         0.0076+0.0409j, -0.1109-0.3012j, -0.0156+0.0155j, -0.0108-0.1351j,
         0.0282-0.0582j, -0.1030-0.0213j,  0.0479+0.0741j, -0.0312-0.1583j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.9971, 1.0519, 0.8845, 0.7840, 0.9692, 0.7574, 1.5348, 1.0574, 0.7037,
        1.0143, 0.8457, 0.9152, 1.0098, 0.8492, 1.0190, 0.8715, 0.9343, 1.2337,
        0.7563, 0.8373], device='cuda:0')
Real_SNR = tensor([ 0.1306,  0.1015, -0.8653, -0.9569, -0.0992, -2.4133,  0.7270,  1.2315,
        -1.4824,  0.9107, -0.5535,  0.4555,  1.1749, -0.6039,  0.0899, -1.7241,
         0.0708,  2.2900, -0.9673,  0.2931], device='cuda:0')
q_var = tensor([1.0002, 0.9991, 0.9982, 1.0002, 0.9911, 0.9937, 0.9805, 0.9986, 1.0000,
        0.9896, 0.9995, 0.9908, 0.9946, 1.0002, 0.9971, 0.9893, 0.9989, 0.9973,
        0.9908, 0.9870], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([1.0002, 0.9991, 0.9982, 1.0002, 0.9911, 0.9937, 0.9805, 0.9986, 1.0000,
        0.9896, 0.9995, 0.9908, 0.9946, 1.0002, 0.9971, 0.9893, 0.9989, 0.9973,
        0.9908, 0.9870], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([4.0380, 4.1369, 3.3273, 3.2296, 3.9689, 2.2984, 4.7692, 5.2979, 2.8479,
        4.9488, 3.5816, 4.4263, 5.1770, 3.4688, 4.1013, 2.7011, 4.0813, 6.8952,
        3.1741, 4.2778], device='cuda:0')
signal_var = tensor([1.0095, 1.0342, 0.8318, 0.8074, 0.9922, 0.5746, 1.1923, 1.3245, 0.7120,
        1.2372, 0.8954, 1.1066, 1.2943, 0.8672, 1.0253, 0.6753, 1.0203, 1.7238,
        0.7935, 1.0695], device='cuda:0')
w_var = tensor([0.9796, 1.0103, 1.0152, 1.0064, 1.0152, 1.0016, 1.0085, 0.9975, 1.0016,
        1.0031, 1.0171, 0.9964, 0.9875, 0.9966, 1.0043, 1.0043, 1.0038, 1.0174,
        0.9915, 0.9997], device='cuda:0')
y_var = tensor([1.9968, 2.0551, 1.8341, 1.8124, 2.0264, 1.5869, 2.2114, 2.3276, 1.7114,
        2.2526, 1.8945, 2.0840, 2.3006, 1.8915, 2.0272, 1.6831, 2.0459, 2.7273,
        1.7904, 2.0763], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([0.6667, 0.6667, 0.6667, 0.6667, 0.6667, 0.6667, 0.6667, 0.6667, 0.6667,
        0.6667, 0.6667, 0.6667, 0.6667, 0.6667, 0.6667, 0.6667, 0.6667, 0.6667,
        0.6667, 0.6667], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 4])) = tensor([[0.1797, 0.0942, 0.2490, 0.1210],
        [0.1023, 0.2126, 0.0808, 0.1184],
        [0.1655, 0.2268, 0.2187, 0.1943],
        [0.1580, 0.2672, 0.1830, 0.1721],
        [0.0881, 0.1826, 0.1480, 0.1249],
        [0.1814, 0.4288, 0.1307, 0.2004],
        [0.1026, 0.0916, 0.0837, 0.0857],
        [0.1876, 0.1312, 0.1048, 0.3012],
        [0.1503, 0.1506, 0.1913, 0.3163],
        [0.1278, 0.1242, 0.1589, 0.2596],
        [0.1880, 0.1743, 0.1641, 0.1318],
        [0.1880, 0.1028, 0.1616, 0.1184],
        [0.1163, 0.1146, 0.1508, 0.1338],
        [0.2211, 0.1890, 0.1089, 0.1914],
        [0.1255, 0.1704, 0.1054, 0.1612],
        [0.1858, 0.2078, 0.1711, 0.1863],
        [0.1711, 0.1509, 0.1381, 0.1100],
        [0.1020, 0.1234, 0.1718, 0.0993],
        [0.1700, 0.2769, 0.3296, 0.2789],
        [0.1271, 0.2132, 0.4313, 0.3441]], device='cuda:0')
Var (shape: torch.Size([20, 4])) = tensor([[0.2097, 0.1099, 0.2904, 0.1412],
        [0.1194, 0.2480, 0.0943, 0.1381],
        [0.1931, 0.2645, 0.2552, 0.2266],
        [0.1843, 0.3117, 0.2135, 0.2008],
        [0.1028, 0.2131, 0.1727, 0.1457],
        [0.2116, 0.5003, 0.1525, 0.2338],
        [0.1197, 0.1069, 0.0976, 0.0999],
        [0.2189, 0.1531, 0.1223, 0.3513],
        [0.1753, 0.1757, 0.2232, 0.3690],
        [0.1491, 0.1449, 0.1854, 0.3029],
        [0.2193, 0.2033, 0.1915, 0.1537],
        [0.2194, 0.1200, 0.1885, 0.1381],
        [0.1357, 0.1337, 0.1760, 0.1561],
        [0.2579, 0.2205, 0.1271, 0.2233],
        [0.1464, 0.1987, 0.1230, 0.1881],
        [0.2168, 0.2424, 0.1997, 0.2174],
        [0.1996, 0.1761, 0.1611, 0.1284],
        [0.1189, 0.1439, 0.2005, 0.1158],
        [0.1983, 0.3231, 0.3846, 0.3254],
        [0.1482, 0.2487, 0.5032, 0.4014]], device='cuda:0')
***********
SINR = tensor([ 1.0405,  1.9755, -0.4552, -0.2092,  1.4934, -0.3884,  2.9603,  0.6157,
        -0.1413,  0.6510,  0.4313,  1.2221,  1.4705,  0.3395,  1.2001, -0.1974,
         1.0918,  1.7872, -1.4308, -1.0019], device='cuda:0')
Real_SINR = tensor([ 0.4682,  1.5353, -0.7304, -0.7500,  1.3291, -1.5295,  3.0670,  0.1879,
        -0.5971,  0.1905,  0.6342,  1.0727,  1.7234, -0.2725,  1.0175,  0.0694,
         0.9501,  1.8840, -1.6886, -2.2748], device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5596, 0.6118, 0.4738, 0.4880, 0.5851, 0.4777, 0.6641, 0.5354, 0.4919,
        0.5374, 0.5248, 0.5699, 0.5838, 0.5195, 0.5686, 0.4886, 0.5625, 0.6015,
        0.4184, 0.4426], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200,
        200, 200, 200, 200, 200, 200], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/t=200/
20 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 1,  rho_ul = 0.3147313529485418-----------
G_variance = tensor([0.8761, 0.7705, 1.0663, 1.0542, 0.8756, 1.0342, 0.9499, 1.0328, 0.8281,
        1.0029, 1.1142, 0.7228, 1.0488, 1.3755, 1.1752, 1.0729, 1.0720, 0.8606,
        0.9755, 0.9000], device='cuda:0')
G_hat_variance = tensor([0.8114, 0.7537, 0.9394, 0.7508, 0.7930, 0.9646, 0.7624, 0.8717, 0.8117,
        0.7303, 0.8483, 0.6204, 0.8103, 1.1716, 1.0302, 0.9204, 0.8819, 0.8478,
        0.8703, 0.6346], device='cuda:0')
G_tilde_var = tensor([0.1300, 0.1398, 0.1459, 0.1569, 0.1089, 0.1140, 0.1895, 0.1409, 0.1009,
        0.1820, 0.1448, 0.1592, 0.1569, 0.1515, 0.1363, 0.1336, 0.1432, 0.1330,
        0.1296, 0.1511], device='cuda:0')
gamma = tensor([[[0.8629, 0.8629, 0.8629, 0.8629]]], device='cuda:0')
Z_mean = tensor([-0.2483+0.0556j, -0.2275-0.0826j, -0.0777+0.0958j,  0.0979+0.0533j,
        -0.0446+0.0437j, -0.1034+0.0024j,  0.0600-0.0476j,  0.1660+0.1504j,
         0.0769-0.3063j,  0.0295-0.0587j,  0.1362+0.0217j,  0.1801+0.0731j,
         0.0224+0.1139j,  0.0351+0.1006j, -0.0856-0.0241j,  0.0574+0.0878j,
        -0.1399+0.0637j,  0.0705+0.0492j, -0.1073+0.0880j, -0.0962+0.0514j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.9403, 0.8734, 1.0886, 0.8700, 0.9189, 1.1178, 0.8836, 1.0102, 0.9407,
        0.8463, 0.9831, 0.7190, 0.9390, 1.3578, 1.1938, 1.0666, 1.0220, 0.9825,
        1.0086, 0.7354], device='cuda:0')
Real_SNR = tensor([ 0.2513,  0.7959,  1.9080,  1.4576,  1.4053,  1.6422,  0.9593,  1.7757,
         0.4447,  1.3880,  2.5115, -0.1752,  0.5448,  1.6872,  2.3485,  3.0600,
         0.6157,  1.3683,  0.8684, -0.0536], device='cuda:0')
q_var = tensor([1.0002, 0.9991, 0.9982, 1.0002, 0.9911, 0.9937, 0.9805, 0.9986, 1.0000,
        0.9896, 0.9995, 0.9908, 0.9946, 1.0002, 0.9971, 0.9893, 0.9989, 0.9973,
        0.9908, 0.9870], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([1.0002, 0.9991, 0.9982, 1.0002, 0.9911, 0.9937, 0.9805, 0.9986, 1.0000,
        0.9896, 0.9995, 0.9908, 0.9946, 1.0002, 0.9971, 0.9893, 0.9989, 0.9973,
        0.9908, 0.9870], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([3.4440, 3.8548, 4.9046, 4.4286, 4.3654, 4.6869, 3.9677, 4.7847, 3.4615,
        4.4310, 5.6449, 3.0637, 3.6162, 4.6133, 5.4446, 6.2643, 3.7037, 4.2937,
        3.8814, 3.1404], device='cuda:0')
signal_var = tensor([1.0839, 1.2132, 1.5436, 1.3938, 1.3739, 1.4751, 1.2488, 1.5059, 1.0894,
        1.3946, 1.7766, 0.9642, 1.1381, 1.4520, 1.7136, 1.9716, 1.1657, 1.3514,
        1.2216, 0.9884], device='cuda:0')
w_var = tensor([1.0230, 1.0101, 0.9948, 0.9964, 0.9941, 1.0107, 1.0013, 1.0005, 0.9834,
        1.0131, 0.9964, 1.0039, 1.0039, 0.9846, 0.9978, 0.9746, 1.0116, 0.9862,
        1.0002, 1.0007], device='cuda:0')
y_var = tensor([2.0931, 2.2100, 2.5540, 2.4288, 2.3902, 2.4719, 2.2204, 2.4969, 2.0582,
        2.4427, 2.7439, 1.9893, 2.1494, 2.4540, 2.6890, 2.9772, 2.1344, 2.3189,
        2.2206, 2.0004], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([0.5483, 0.5483, 0.5483, 0.5483, 0.5483, 0.5483, 0.5483, 0.5483, 0.5483,
        0.5483, 0.5483, 0.5483, 0.5483, 0.5483, 0.5483, 0.5483, 0.5483, 0.5483,
        0.5483, 0.5483], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 4])) = tensor([[0.2213, 0.1907, 0.1409, 0.1940],
        [0.1332, 0.1396, 0.1264, 0.1301],
        [0.1226, 0.1291, 0.1108, 0.1766],
        [0.1911, 0.1303, 0.2658, 0.0994],
        [0.1756, 0.0881, 0.1600, 0.2230],
        [0.0873, 0.1619, 0.1092, 0.3840],
        [0.1678, 0.2601, 0.1434, 0.1248],
        [0.4275, 0.1511, 0.4921, 0.2854],
        [0.1957, 0.1046, 0.0948, 0.0924],
        [0.4553, 0.2897, 0.1073, 0.3246],
        [0.0837, 0.0927, 0.2122, 0.2615],
        [0.1497, 0.1683, 0.3173, 0.2131],
        [0.2833, 0.2057, 0.1273, 0.1071],
        [0.1934, 0.0892, 0.1543, 0.1163],
        [0.1068, 0.1507, 0.0821, 0.1409],
        [0.1273, 0.2329, 0.1350, 0.1457],
        [0.2583, 0.2354, 0.0852, 0.3249],
        [0.1738, 0.1666, 0.1581, 0.1981],
        [0.1268, 0.0979, 0.2327, 0.1162],
        [0.2178, 0.1825, 0.1166, 0.2004]], device='cuda:0')
Var (shape: torch.Size([20, 4])) = tensor([[0.2595, 0.2236, 0.1652, 0.2275],
        [0.1562, 0.1637, 0.1482, 0.1526],
        [0.1438, 0.1513, 0.1299, 0.2070],
        [0.2240, 0.1527, 0.3117, 0.1166],
        [0.2060, 0.1033, 0.1876, 0.2614],
        [0.1024, 0.1898, 0.1281, 0.4503],
        [0.1967, 0.3050, 0.1681, 0.1464],
        [0.5013, 0.1772, 0.5770, 0.3346],
        [0.2294, 0.1227, 0.1112, 0.1084],
        [0.5338, 0.3396, 0.1258, 0.3806],
        [0.0981, 0.1087, 0.2489, 0.3066],
        [0.1755, 0.1974, 0.3721, 0.2499],
        [0.3322, 0.2412, 0.1493, 0.1256],
        [0.2268, 0.1045, 0.1810, 0.1364],
        [0.1252, 0.1767, 0.0963, 0.1653],
        [0.1492, 0.2731, 0.1583, 0.1708],
        [0.3029, 0.2760, 0.0999, 0.3810],
        [0.2038, 0.1953, 0.1854, 0.2323],
        [0.1486, 0.1148, 0.2729, 0.1363],
        [0.2554, 0.2139, 0.1367, 0.2350]], device='cuda:0')
***********
SINR = tensor([ 1.0546,  2.4371,  2.4834,  1.8973,  2.0638,  2.3086,  1.5699, -0.7618,
         3.1946,  0.1915,  2.5784,  0.7370,  1.7067,  2.6047,  3.1015,  1.8466,
         1.2309,  1.2690,  2.5415,  1.3630], device='cuda:0')
Real_SINR = tensor([ 1.3353,  2.5829,  2.5027,  1.5738,  1.7420,  1.0922,  0.7204, -1.3716,
         3.2842, -2.0280,  0.8003,  0.5089,  1.1014,  2.6149,  2.8102,  1.8434,
         0.2355,  1.4522,  2.2290,  1.1895], device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5604, 0.6367, 0.6392, 0.6075, 0.6166, 0.6299, 0.5894, 0.4563, 0.6760,
        0.5110, 0.6442, 0.5423, 0.5970, 0.6456, 0.6713, 0.6047, 0.5704, 0.5725,
        0.6423, 0.5778], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200,
        200, 200, 200, 200, 200, 200], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/t=200/
20 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 2,  rho_ul = 0.3962232981152784-----------
G_variance = tensor([0.9407, 1.0387, 0.9281, 0.9724, 0.7407, 0.9716, 0.8277, 1.2634, 0.9283,
        1.2384, 1.1405, 1.2211, 0.9317, 0.9106, 0.9021, 0.8852, 1.1813, 0.8755,
        0.9198, 1.0940], device='cuda:0')
G_hat_variance = tensor([0.7852, 0.9054, 0.7473, 0.8696, 0.6167, 0.9187, 0.8415, 1.0450, 0.7391,
        1.1059, 0.9636, 1.1611, 0.8925, 0.8971, 0.9249, 0.8456, 0.9745, 0.7377,
        0.8067, 1.0492], device='cuda:0')
G_tilde_var = tensor([0.1608, 0.0938, 0.0811, 0.1212, 0.0926, 0.1194, 0.1241, 0.1460, 0.1233,
        0.1051, 0.0955, 0.1008, 0.0972, 0.0813, 0.1071, 0.1250, 0.1380, 0.1374,
        0.0963, 0.0949], device='cuda:0')
gamma = tensor([[[0.8879, 0.8879, 0.8879, 0.8879]]], device='cuda:0')
Z_mean = tensor([-0.0725+0.0061j, -0.1362-0.0277j, -0.0665+0.0216j, -0.0808-0.0616j,
        -0.1236+0.0553j,  0.0454+0.1256j, -0.0966-0.1444j,  0.2210-0.0211j,
        -0.0691-0.0207j, -0.0879+0.1408j,  0.0425-0.0884j, -0.0395-0.1939j,
         0.1124-0.1430j,  0.2721+0.0823j, -0.0605+0.0342j,  0.0281+0.1388j,
        -0.0817-0.0009j,  0.0902-0.0692j,  0.3191-0.0677j,  0.1173+0.0464j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.8843, 1.0197, 0.8416, 0.9793, 0.6945, 1.0346, 0.9477, 1.1768, 0.8323,
        1.2455, 1.0852, 1.3076, 1.0051, 1.0103, 1.0416, 0.9523, 1.0975, 0.8308,
        0.9085, 1.1816], device='cuda:0')
Real_SNR = tensor([1.0316, 1.6266, 1.9087, 2.2864, 0.7886, 1.8721, 1.2567, 2.5710, 1.4425,
        3.3322, 4.1958, 3.4126, 2.5633, 2.3835, 2.1576, 1.7750, 2.8491, 0.1311,
        3.3955, 2.4938], device='cuda:0')
q_var = tensor([1.0002, 0.9991, 0.9982, 1.0002, 0.9911, 0.9937, 0.9805, 0.9986, 1.0000,
        0.9896, 0.9995, 0.9908, 0.9946, 1.0002, 0.9971, 0.9893, 0.9989, 0.9973,
        0.9908, 0.9870], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([1.0002, 0.9991, 0.9982, 1.0002, 0.9911, 0.9937, 0.9805, 0.9986, 1.0000,
        0.9896, 0.9995, 0.9908, 0.9946, 1.0002, 0.9971, 0.9893, 0.9989, 0.9973,
        0.9908, 0.9870], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([3.1824, 3.6496, 3.9998, 4.2201, 3.0109, 3.7756, 3.3271, 4.6309, 3.5126,
        5.4606, 6.5993, 5.4913, 4.4778, 4.3682, 4.1045, 3.7954, 4.8551, 2.6292,
        5.5194, 4.4110], device='cuda:0')
signal_var = tensor([1.2609, 1.4460, 1.5848, 1.6721, 1.1930, 1.4960, 1.3183, 1.8349, 1.3918,
        2.1636, 2.6148, 2.1758, 1.7742, 1.7308, 1.6263, 1.5038, 1.9237, 1.0418,
        2.1869, 1.7477], device='cuda:0')
w_var = tensor([0.9943, 0.9943, 1.0212, 0.9877, 0.9949, 0.9721, 0.9871, 1.0151, 0.9984,
        1.0045, 0.9951, 0.9916, 0.9833, 0.9997, 0.9896, 0.9993, 0.9982, 1.0108,
        1.0007, 0.9842], device='cuda:0')
y_var = tensor([2.2391, 2.4566, 2.5859, 2.6868, 2.1753, 2.4484, 2.2924, 2.8450, 2.3408,
        3.1732, 3.6336, 3.2027, 2.7848, 2.7630, 2.6106, 2.4878, 2.9362, 2.0501,
        3.2292, 2.7797], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([0.4482, 0.4482, 0.4482, 0.4482, 0.4482, 0.4482, 0.4482, 0.4482, 0.4482,
        0.4482, 0.4482, 0.4482, 0.4482, 0.4482, 0.4482, 0.4482, 0.4482, 0.4482,
        0.4482, 0.4482], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 4])) = tensor([[0.1434, 0.2154, 0.1456, 0.1942],
        [0.1811, 0.1377, 0.1828, 0.1449],
        [0.1619, 0.2131, 0.2118, 0.1366],
        [0.1314, 0.1722, 0.1965, 0.2329],
        [0.3259, 0.2013, 0.1995, 0.1035],
        [0.1746, 0.0905, 0.1608, 0.1387],
        [0.1409, 0.1974, 0.1343, 0.1740],
        [0.2286, 0.1277, 0.1354, 0.1408],
        [0.1355, 0.1585, 0.1339, 0.2380],
        [0.1152, 0.1214, 0.1500, 0.0883],
        [0.3197, 0.0952, 0.2839, 0.1444],
        [0.1193, 0.0770, 0.1203, 0.0685],
        [0.2295, 0.0994, 0.1798, 0.1228],
        [0.1891, 0.1404, 0.1707, 0.1525],
        [0.1004, 0.1359, 0.1389, 0.2145],
        [0.1618, 0.1456, 0.2166, 0.2986],
        [0.1521, 0.0723, 0.1156, 0.2040],
        [0.1169, 0.1866, 0.0874, 0.4596],
        [0.0709, 0.1599, 0.1240, 0.1261],
        [0.3076, 0.1209, 0.0961, 0.1015]], device='cuda:0')
Var (shape: torch.Size([20, 4])) = tensor([[0.1689, 0.2536, 0.1714, 0.2287],
        [0.2133, 0.1621, 0.2153, 0.1707],
        [0.1906, 0.2509, 0.2494, 0.1609],
        [0.1548, 0.2027, 0.2314, 0.2743],
        [0.3838, 0.2371, 0.2349, 0.1219],
        [0.2056, 0.1066, 0.1893, 0.1633],
        [0.1659, 0.2325, 0.1581, 0.2049],
        [0.2692, 0.1504, 0.1594, 0.1658],
        [0.1596, 0.1866, 0.1577, 0.2802],
        [0.1356, 0.1429, 0.1767, 0.1040],
        [0.3765, 0.1121, 0.3344, 0.1700],
        [0.1405, 0.0907, 0.1417, 0.0806],
        [0.2703, 0.1171, 0.2117, 0.1446],
        [0.2227, 0.1653, 0.2010, 0.1795],
        [0.1182, 0.1600, 0.1636, 0.2525],
        [0.1905, 0.1715, 0.2550, 0.3517],
        [0.1791, 0.0851, 0.1361, 0.2402],
        [0.1377, 0.2197, 0.1029, 0.5413],
        [0.0835, 0.1883, 0.1460, 0.1485],
        [0.3623, 0.1423, 0.1132, 0.1195]], device='cuda:0')
***********
SINR = tensor([2.4680, 2.7393, 2.3333, 2.3119, 2.2946, 3.5331, 2.7743, 2.9961, 2.7740,
        4.1629, 2.5492, 5.1951, 3.2235, 2.6824, 3.3841, 1.9578, 4.0430, 3.1312,
        4.3376, 3.7546], device='cuda:0')
Real_SINR = tensor([1.9856, 2.8535, 2.3718, 2.1276, 1.8377, 3.3083, 2.5566, 2.8065, 2.2478,
        3.9398, 1.3501, 5.3625, 2.6652, 2.5538, 3.0775, 1.4411, 3.3314, 1.8164,
        3.8548, 2.9518], device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6384, 0.6527, 0.6312, 0.6300, 0.6291, 0.6929, 0.6545, 0.6659, 0.6545,
        0.7228, 0.6427, 0.7679, 0.6775, 0.6497, 0.6855, 0.6108, 0.7173, 0.6728,
        0.7308, 0.7036], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200,
        200, 200, 200, 200, 200, 200], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/t=200/
20 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 3,  rho_ul = 0.4988155787422199-----------
G_variance = tensor([1.0418, 1.0753, 1.1902, 1.4894, 1.0828, 1.0040, 1.2011, 1.1393, 1.0040,
        0.9447, 0.9248, 0.8841, 0.8197, 0.8433, 1.0993, 1.0002, 0.9288, 0.9516,
        0.7883, 1.0097], device='cuda:0')
G_hat_variance = tensor([0.9857, 1.0000, 0.9935, 1.2794, 0.8724, 0.8178, 1.0693, 1.0327, 0.9062,
        0.8722, 0.9341, 0.7902, 0.6831, 0.8216, 0.9323, 0.8510, 0.8408, 0.9252,
        0.7184, 1.0385], device='cuda:0')
G_tilde_var = tensor([0.0782, 0.1172, 0.0869, 0.1065, 0.0977, 0.0848, 0.1408, 0.0780, 0.0952,
        0.0943, 0.1115, 0.0772, 0.0977, 0.0743, 0.1087, 0.0854, 0.1105, 0.0792,
        0.0936, 0.0966], device='cuda:0')
gamma = tensor([[[0.9089, 0.9089, 0.9089, 0.9089]]], device='cuda:0')
Z_mean = tensor([-0.2792-0.1615j, -0.0905+0.1321j, -0.1409+0.2405j,  0.1326+0.0515j,
         0.0115+0.0189j, -0.0762+0.0131j,  0.0209-0.1855j,  0.3073+0.0988j,
         0.0367-0.0837j, -0.1100-0.0938j,  0.0808+0.1458j,  0.0830-0.0455j,
         0.0121-0.0670j, -0.0219+0.0151j,  0.2179-0.0186j,  0.0681-0.0426j,
         0.0225+0.1787j, -0.1339-0.1968j, -0.1552-0.0147j, -0.0893+0.0048j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.0845, 1.1002, 1.0931, 1.4077, 0.9598, 0.8998, 1.1764, 1.1362, 0.9971,
        0.9596, 1.0277, 0.8694, 0.7516, 0.9040, 1.0258, 0.9363, 0.9251, 1.0179,
        0.7904, 1.1426], device='cuda:0')
Real_SNR = tensor([3.1136, 3.5885, 3.7989, 5.8774, 2.8591, 3.2962, 4.5298, 4.2347, 2.6449,
        2.2314, 2.7039, 3.9934, 3.0245, 2.7805, 3.3182, 1.0817, 3.1230, 3.9391,
        2.0919, 3.6571], device='cuda:0')
q_var = tensor([1.0002, 0.9991, 0.9982, 1.0002, 0.9911, 0.9937, 0.9805, 0.9986, 1.0000,
        0.9896, 0.9995, 0.9908, 0.9946, 1.0002, 0.9971, 0.9893, 0.9989, 0.9973,
        0.9908, 0.9870], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([1.0002, 0.9991, 0.9982, 1.0002, 0.9911, 0.9937, 0.9805, 0.9986, 1.0000,
        0.9896, 0.9995, 0.9908, 0.9946, 1.0002, 0.9971, 0.9893, 0.9989, 0.9973,
        0.9908, 0.9870], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([4.1543, 4.6348, 4.7408, 7.7979, 3.8849, 4.2631, 5.6308, 5.3615, 3.6206,
        3.3498, 3.7052, 5.0689, 4.0635, 3.8325, 4.3599, 2.5858, 4.0815, 5.0469,
        3.2858, 4.7399], device='cuda:0')
signal_var = tensor([2.0722, 2.3119, 2.3648, 3.8897, 1.9378, 2.1265, 2.8087, 2.6744, 1.8060,
        1.6709, 1.8482, 2.5284, 2.0270, 1.9117, 2.1748, 1.2899, 2.0359, 2.5175,
        1.6390, 2.3643], device='cuda:0')
w_var = tensor([1.0118, 1.0119, 0.9861, 1.0050, 1.0033, 0.9955, 0.9898, 1.0087, 0.9823,
        0.9996, 0.9916, 1.0081, 1.0102, 1.0078, 1.0130, 1.0055, 0.9919, 1.0164,
        1.0125, 1.0186], device='cuda:0')
y_var = tensor([3.1432, 3.3552, 3.2962, 4.9767, 2.9535, 3.1394, 3.8529, 3.6801, 2.7794,
        2.6715, 2.8051, 3.5205, 3.0113, 2.9146, 3.1633, 2.2939, 3.0159, 3.4538,
        2.6795, 3.3993], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([0.3644, 0.3644, 0.3644, 0.3644, 0.3644, 0.3644, 0.3644, 0.3644, 0.3644,
        0.3644, 0.3644, 0.3644, 0.3644, 0.3644, 0.3644, 0.3644, 0.3644, 0.3644,
        0.3644, 0.3644], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 4])) = tensor([[0.1297, 0.1464, 0.1545, 0.1267],
        [0.1424, 0.1168, 0.1151, 0.0935],
        [0.0958, 0.1197, 0.1092, 0.1355],
        [0.0799, 0.2273, 0.1641, 0.1128],
        [0.1851, 0.1333, 0.1746, 0.1743],
        [0.2372, 0.1107, 0.2604, 0.2531],
        [0.1022, 0.0833, 0.1462, 0.0962],
        [0.1136, 0.1700, 0.0760, 0.1477],
        [0.3739, 0.1678, 0.1720, 0.1809],
        [0.2267, 0.2011, 0.1168, 0.0792],
        [0.1386, 0.1159, 0.1037, 0.1222],
        [0.1198, 0.2174, 0.3084, 0.2510],
        [0.4380, 0.4366, 0.1243, 0.1555],
        [0.2203, 0.0919, 0.1577, 0.1814],
        [0.1815, 0.0985, 0.1137, 0.1160],
        [0.2897, 0.1290, 0.1734, 0.2563],
        [0.1204, 0.1990, 0.1552, 0.1512],
        [0.1028, 0.1262, 0.2185, 0.2101],
        [0.2370, 0.2625, 0.1872, 0.2218],
        [0.1066, 0.0718, 0.1382, 0.1172]], device='cuda:0')
Var (shape: torch.Size([20, 4])) = tensor([[0.1533, 0.1730, 0.1826, 0.1497],
        [0.1683, 0.1380, 0.1361, 0.1104],
        [0.1132, 0.1414, 0.1290, 0.1601],
        [0.0944, 0.2687, 0.1939, 0.1333],
        [0.2187, 0.1575, 0.2063, 0.2060],
        [0.2803, 0.1308, 0.3078, 0.2991],
        [0.1208, 0.0984, 0.1728, 0.1137],
        [0.1343, 0.2009, 0.0898, 0.1745],
        [0.4418, 0.1984, 0.2033, 0.2138],
        [0.2679, 0.2377, 0.1380, 0.0937],
        [0.1638, 0.1369, 0.1226, 0.1444],
        [0.1415, 0.2570, 0.3645, 0.2966],
        [0.5177, 0.5160, 0.1469, 0.1838],
        [0.2603, 0.1087, 0.1864, 0.2144],
        [0.2145, 0.1164, 0.1344, 0.1370],
        [0.3424, 0.1524, 0.2049, 0.3029],
        [0.1423, 0.2352, 0.1834, 0.1787],
        [0.1214, 0.1491, 0.2583, 0.2483],
        [0.2801, 0.3102, 0.2212, 0.2621],
        [0.1259, 0.0849, 0.1633, 0.1385]], device='cuda:0')
***********
SINR = tensor([4.4285, 5.2556, 5.3009, 4.8532, 3.6875, 3.0489, 5.7315, 5.2103, 2.8230,
        4.6708, 5.0912, 2.8668, 2.6170, 4.1753, 5.0145, 3.0147, 4.0324, 4.1309,
        2.3423, 5.7374], device='cuda:0')
Real_SINR = tensor([4.4800, 4.7800, 5.5965, 4.3133, 3.5702, 2.5854, 5.5810, 4.8787, 2.3512,
        3.9913, 5.4112, 2.0281, 0.5555, 4.1358, 4.9130, 2.4361, 3.3376, 3.9429,
        1.8992, 5.1278], device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7349, 0.7703, 0.7722, 0.7535, 0.7004, 0.6686, 0.7891, 0.7685, 0.6570,
        0.7456, 0.7636, 0.6593, 0.6462, 0.7234, 0.7604, 0.6669, 0.7168, 0.7214,
        0.6317, 0.7894], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200,
        200, 200, 200, 200, 200, 200], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/t=200/
20 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 4,  rho_ul = 0.627971607877395-----------
G_variance = tensor([1.1596, 0.9011, 0.5487, 0.8287, 1.4863, 1.2262, 0.9594, 0.7300, 1.0174,
        0.8458, 0.9773, 0.8170, 1.0040, 0.9488, 0.9581, 1.0220, 1.0289, 0.8797,
        0.9282, 0.8285], device='cuda:0')
G_hat_variance = tensor([1.0156, 0.8954, 0.4724, 0.7595, 1.3769, 1.0480, 0.7527, 0.7463, 1.0594,
        0.7557, 0.8574, 0.8282, 0.9561, 0.8769, 0.7934, 0.9785, 0.8804, 0.9360,
        0.8819, 0.8044], device='cuda:0')
G_tilde_var = tensor([0.0748, 0.0810, 0.0928, 0.0639, 0.0592, 0.0960, 0.0855, 0.0713, 0.0769,
        0.0913, 0.0750, 0.0604, 0.0712, 0.0644, 0.0926, 0.0825, 0.0829, 0.0664,
        0.0688, 0.0780], device='cuda:0')
gamma = tensor([[[0.9263, 0.9263, 0.9263, 0.9263]]], device='cuda:0')
Z_mean = tensor([-2.5102e-05+0.0856j, -1.7374e-02-0.0418j, -1.0669e-01+0.0384j,
         1.0723e-01+0.1318j,  1.8517e-01+0.0155j, -1.2547e-02+0.1914j,
        -1.1394e-02-0.0084j, -9.6709e-02+0.1050j,  1.2090e-01-0.1900j,
        -1.9890e-01-0.1536j, -5.6971e-02-0.0073j, -8.5886e-02+0.0793j,
         1.1109e-02-0.2018j, -2.2971e-01-0.0175j,  4.5154e-02+0.1758j,
        -9.6639e-02+0.1489j,  7.9911e-02+0.3140j,  5.2314e-02-0.1647j,
        -8.7269e-02+0.0799j, -1.1935e-02-0.0230j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.0965, 0.9667, 0.5101, 0.8200, 1.4865, 1.1314, 0.8126, 0.8057, 1.1438,
        0.8158, 0.9257, 0.8942, 1.0323, 0.9467, 0.8566, 1.0564, 0.9505, 1.0105,
        0.9521, 0.8684], device='cuda:0')
Real_SNR = tensor([3.7439, 2.8088, 0.6951, 2.7568, 7.0470, 4.9175, 3.3159, 1.6670, 4.6410,
        3.0076, 3.8460, 2.1569, 4.7461, 3.5486, 4.8371, 5.7202, 4.9789, 2.6681,
        4.3715, 2.0529], device='cuda:0')
q_var = tensor([1.0002, 0.9991, 0.9982, 1.0002, 0.9911, 0.9937, 0.9805, 0.9986, 1.0000,
        0.9896, 0.9995, 0.9908, 0.9946, 1.0002, 0.9971, 0.9893, 0.9989, 0.9973,
        0.9908, 0.9870], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([1.0002, 0.9991, 0.9982, 1.0002, 0.9911, 0.9937, 0.9805, 0.9986, 1.0000,
        0.9896, 0.9995, 0.9908, 0.9946, 1.0002, 0.9971, 0.9893, 0.9989, 0.9973,
        0.9908, 0.9870], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([3.8181, 3.0057, 1.9164, 2.9704, 7.9087, 4.9038, 3.4041, 2.2999, 4.6572,
        3.2134, 3.8287, 2.5430, 4.7913, 3.5616, 4.8396, 5.9981, 4.9229, 2.9796,
        4.3334, 2.5607], device='cuda:0')
signal_var = tensor([2.3977, 1.8875, 1.2034, 1.8653, 4.9665, 3.0795, 2.1377, 1.4443, 2.9246,
        2.0179, 2.4043, 1.5970, 3.0088, 2.2366, 3.0391, 3.7666, 3.0914, 1.8711,
        2.7213, 1.6081], device='cuda:0')
w_var = tensor([1.0125, 0.9886, 1.0254, 0.9887, 0.9803, 0.9925, 0.9962, 0.9839, 1.0045,
        1.0096, 0.9917, 0.9719, 1.0088, 0.9879, 0.9978, 1.0091, 0.9823, 1.0122,
        0.9945, 1.0023], device='cuda:0')
y_var = tensor([3.4551, 2.8995, 2.2487, 2.8262, 5.9316, 4.1260, 3.1343, 2.4445, 3.8413,
        3.0386, 3.3964, 2.6223, 3.9990, 3.1724, 4.0347, 4.7345, 4.0929, 2.8486,
        3.7616, 2.5844], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([0.2950, 0.2950, 0.2950, 0.2950, 0.2950, 0.2950, 0.2950, 0.2950, 0.2950,
        0.2950, 0.2950, 0.2950, 0.2950, 0.2950, 0.2950, 0.2950, 0.2950, 0.2950,
        0.2950, 0.2950], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 4])) = tensor([[0.2393, 0.1408, 0.3545, 0.1840],
        [0.2127, 0.1434, 0.1746, 0.3733],
        [0.4478, 0.5038, 0.3527, 0.1776],
        [0.1517, 0.1959, 0.1554, 0.1832],
        [0.0672, 0.0686, 0.0713, 0.0880],
        [0.1812, 0.0801, 0.1347, 0.0646],
        [0.1247, 0.2612, 0.1643, 0.1109],
        [0.3075, 0.1943, 0.1050, 0.2702],
        [0.0881, 0.1784, 0.2956, 0.3053],
        [0.2139, 0.2426, 0.1640, 0.1513],
        [0.1008, 0.1511, 0.1772, 0.1521],
        [0.2782, 0.1528, 0.0907, 0.3756],
        [0.0890, 0.1163, 0.1985, 0.1204],
        [0.1539, 0.2339, 0.0986, 0.3254],
        [0.2068, 0.1673, 0.1398, 0.1730],
        [0.1356, 0.1822, 0.3149, 0.0945],
        [0.1094, 0.1227, 0.1688, 0.0916],
        [0.1908, 0.1069, 0.1844, 0.1396],
        [0.1325, 0.3815, 0.1739, 0.1412],
        [0.2412, 0.3692, 0.2082, 0.1719]], device='cuda:0')
Var (shape: torch.Size([20, 4])) = tensor([[0.2837, 0.1669, 0.4202, 0.2181],
        [0.2521, 0.1700, 0.2069, 0.4424],
        [0.5308, 0.5972, 0.4181, 0.2105],
        [0.1799, 0.2322, 0.1841, 0.2171],
        [0.0797, 0.0814, 0.0845, 0.1043],
        [0.2148, 0.0950, 0.1597, 0.0766],
        [0.1479, 0.3096, 0.1947, 0.1314],
        [0.3645, 0.2303, 0.1244, 0.3202],
        [0.1044, 0.2114, 0.3503, 0.3618],
        [0.2535, 0.2876, 0.1944, 0.1794],
        [0.1195, 0.1791, 0.2100, 0.1803],
        [0.3298, 0.1811, 0.1075, 0.4452],
        [0.1055, 0.1379, 0.2353, 0.1427],
        [0.1825, 0.2772, 0.1169, 0.3857],
        [0.2451, 0.1982, 0.1657, 0.2051],
        [0.1607, 0.2159, 0.3733, 0.1120],
        [0.1297, 0.1454, 0.2001, 0.1085],
        [0.2262, 0.1267, 0.2185, 0.1655],
        [0.1570, 0.4522, 0.2061, 0.1674],
        [0.2859, 0.4376, 0.2467, 0.2037]], device='cuda:0')
***********
SINR = tensor([3.7962, 3.9158, 1.9207, 4.6153, 8.2775, 7.0041, 5.1937, 4.2376, 4.6209,
        4.2131, 5.4756, 4.6583, 6.0967, 4.6873, 4.6437, 5.1409, 6.2195, 5.2304,
        4.5055, 3.3122], device='cuda:0')
Real_SINR = tensor([3.5411, 3.3090, 1.1271, 4.7025, 8.4669, 5.9545, 4.6879, 2.9273, 3.2778,
        3.3036, 5.8308, 3.9266, 5.8749, 3.9872, 3.9813, 4.3114, 6.2127, 4.8921,
        4.0908, 3.1121], device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7056, 0.7113, 0.6088, 0.7432, 0.8706, 0.8338, 0.7678, 0.7263, 0.7435,
        0.7251, 0.7792, 0.7451, 0.8028, 0.7464, 0.7445, 0.7656, 0.8072, 0.7693,
        0.7384, 0.6819], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200,
        200, 200, 200, 200, 200, 200], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/t=200/
20 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 5,  rho_ul = 0.7905694150420949-----------
G_variance = tensor([0.9677, 1.0090, 0.8710, 1.2011, 1.0105, 1.1133, 1.0934, 0.8131, 1.1400,
        0.9462, 1.0070, 0.8494, 0.9391, 1.0537, 0.8471, 0.5534, 0.9683, 0.9408,
        1.0461, 1.2340], device='cuda:0')
G_hat_variance = tensor([0.8731, 0.9890, 0.8764, 1.1762, 0.9446, 1.0866, 1.0233, 0.7788, 1.0485,
        0.8873, 0.8936, 0.7444, 0.8966, 1.0324, 0.8266, 0.5711, 0.9643, 0.9510,
        0.9495, 1.1018], device='cuda:0')
G_tilde_var = tensor([0.0611, 0.0636, 0.0612, 0.0461, 0.0661, 0.0647, 0.0599, 0.0524, 0.0672,
        0.0668, 0.0767, 0.0539, 0.0655, 0.0501, 0.0586, 0.0581, 0.0500, 0.0446,
        0.0648, 0.0549], device='cuda:0')
gamma = tensor([[[0.9405, 0.9405, 0.9405, 0.9405]]], device='cuda:0')
Z_mean = tensor([-0.0409+0.0889j,  0.0425+0.0610j, -0.0218+0.0483j, -0.1231+0.1171j,
        -0.0513-0.1204j, -0.0843+0.0667j, -0.0928-0.1492j,  0.0182+0.0483j,
         0.0977-0.0998j, -0.0409+0.1497j, -0.0836+0.2147j, -0.1207+0.2474j,
        -0.1256-0.2029j, -0.0463+0.1601j, -0.1721+0.0169j,  0.0296-0.2025j,
        -0.0904+0.0240j, -0.0241+0.0939j, -0.0969-0.0184j, -0.0037-0.0964j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.9283, 1.0515, 0.9318, 1.2506, 1.0043, 1.1553, 1.0880, 0.8280, 1.1148,
        0.9434, 0.9501, 0.7915, 0.9533, 1.0977, 0.8789, 0.6072, 1.0253, 1.0112,
        1.0096, 1.1715], device='cuda:0')
Real_SNR = tensor([4.6307, 4.6132, 4.6049, 6.4537, 5.2211, 5.6075, 6.0331, 2.8263, 6.0656,
        5.6340, 7.7318, 4.5749, 4.6990, 6.6141, 3.7741, 3.8697, 5.8289, 5.3692,
        4.8282, 5.8671], device='cuda:0')
q_var = tensor([1.0002, 0.9991, 0.9982, 1.0002, 0.9911, 0.9937, 0.9805, 0.9986, 1.0000,
        0.9896, 0.9995, 0.9908, 0.9946, 1.0002, 0.9971, 0.9893, 0.9989, 0.9973,
        0.9908, 0.9870], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([1.0002, 0.9991, 0.9982, 1.0002, 0.9911, 0.9937, 0.9805, 0.9986, 1.0000,
        0.9896, 0.9995, 0.9908, 0.9946, 1.0002, 0.9971, 0.9893, 0.9989, 0.9973,
        0.9908, 0.9870], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([3.7020, 3.6399, 3.7231, 5.5746, 4.2703, 4.5681, 5.1866, 2.4251, 5.0862,
        4.6135, 7.5804, 3.6122, 3.7077, 5.7363, 2.9360, 3.0929, 4.6625, 4.3588,
        3.8282, 4.9252], device='cuda:0')
signal_var = tensor([2.9267, 2.8776, 2.9434, 4.4071, 3.3760, 3.6114, 4.1003, 1.9172, 4.0210,
        3.6473, 5.9929, 2.8557, 2.9312, 4.5350, 2.3211, 2.4452, 3.6860, 3.4460,
        3.0265, 3.8937], device='cuda:0')
w_var = tensor([1.0076, 0.9947, 1.0194, 0.9972, 1.0146, 0.9929, 1.0221, 1.0001, 0.9949,
        0.9967, 1.0103, 0.9959, 0.9934, 0.9889, 0.9734, 1.0031, 0.9631, 1.0009,
        0.9957, 1.0084], device='cuda:0')
y_var = tensor([3.9933, 3.8857, 3.8893, 5.3850, 4.3674, 4.5620, 5.1226, 2.9337, 5.0249,
        4.6743, 7.0006, 3.8485, 3.9006, 5.5463, 3.3010, 3.4876, 4.7246, 4.4590,
        4.0189, 4.9564], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([0.2379, 0.2379, 0.2379, 0.2379, 0.2379, 0.2379, 0.2379, 0.2379, 0.2379,
        0.2379, 0.2379, 0.2379, 0.2379, 0.2379, 0.2379, 0.2379, 0.2379, 0.2379,
        0.2379, 0.2379], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 4])) = tensor([[0.2099, 0.1525, 0.3614, 0.2335],
        [0.1446, 0.0976, 0.1676, 0.1396],
        [0.1619, 0.1955, 0.0784, 0.1259],
        [0.1846, 0.1097, 0.0716, 0.0934],
        [0.2842, 0.1338, 0.1413, 0.1521],
        [0.1598, 0.1031, 0.1535, 0.0631],
        [0.0976, 0.1062, 0.1626, 0.1391],
        [0.2936, 0.1090, 0.1370, 0.2204],
        [0.0734, 0.1146, 0.1561, 0.1561],
        [0.1917, 0.1352, 0.1761, 0.0871],
        [0.1587, 0.1649, 0.1988, 0.2008],
        [0.2168, 0.1298, 0.1350, 0.2669],
        [0.1409, 0.2289, 0.1440, 0.1218],
        [0.1492, 0.1478, 0.2617, 0.0850],
        [0.1067, 0.1789, 0.1303, 0.3084],
        [0.2517, 0.2346, 0.1548, 0.2681],
        [0.0785, 0.1405, 0.0944, 0.2194],
        [0.1756, 0.0843, 0.2389, 0.1093],
        [0.1773, 0.1582, 0.0892, 0.1551],
        [0.1119, 0.1007, 0.0774, 0.1553]], device='cuda:0')
Var (shape: torch.Size([20, 4])) = tensor([[0.2494, 0.1812, 0.4294, 0.2775],
        [0.1718, 0.1160, 0.1991, 0.1658],
        [0.1924, 0.2323, 0.0932, 0.1495],
        [0.2194, 0.1303, 0.0851, 0.1109],
        [0.3377, 0.1590, 0.1679, 0.1807],
        [0.1899, 0.1225, 0.1823, 0.0750],
        [0.1159, 0.1262, 0.1931, 0.1653],
        [0.3489, 0.1295, 0.1627, 0.2618],
        [0.0872, 0.1362, 0.1854, 0.1855],
        [0.2278, 0.1606, 0.2092, 0.1035],
        [0.1886, 0.1959, 0.2361, 0.2385],
        [0.2576, 0.1543, 0.1604, 0.3171],
        [0.1674, 0.2719, 0.1711, 0.1447],
        [0.1773, 0.1756, 0.3109, 0.1010],
        [0.1268, 0.2126, 0.1549, 0.3664],
        [0.2990, 0.2787, 0.1840, 0.3185],
        [0.0932, 0.1669, 0.1121, 0.2607],
        [0.2086, 0.1002, 0.2839, 0.1299],
        [0.2107, 0.1879, 0.1060, 0.1843],
        [0.1329, 0.1196, 0.0920, 0.1845]], device='cuda:0')
***********
SINR = tensor([4.5850, 6.7571, 6.9934, 7.8781, 5.8608, 7.7778, 7.1290, 5.8212, 7.4040,
        6.6815, 5.4420, 5.6491, 6.1964, 6.5758, 6.0727, 4.5980, 7.3861, 6.8410,
        6.6591, 7.7673], device='cuda:0')
Real_SINR = tensor([4.3021, 6.7357, 6.5856, 7.4512, 5.3583, 7.3870, 7.0053, 5.1509, 7.3280,
        6.1992, 4.4951, 5.4051, 5.8614, 5.7983, 5.6548, 4.7760, 7.1383, 6.5549,
        6.4840, 7.4767], device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7419, 0.8258, 0.8335, 0.8598, 0.7940, 0.8570, 0.8377, 0.7926, 0.8462,
        0.8232, 0.7778, 0.7860, 0.8064, 0.8197, 0.8019, 0.7424, 0.8456, 0.8285,
        0.8225, 0.8567], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200,
        200, 200, 200, 200, 200, 200], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/t=200/
20 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 6,  rho_ul = 0.9952679263837431-----------
G_variance = tensor([0.9590, 1.0441, 0.9930, 0.9790, 0.7230, 0.8603, 0.8837, 1.2324, 0.8239,
        0.7840, 1.0755, 1.1772, 1.0067, 0.9322, 0.9267, 0.9573, 0.7905, 1.0292,
        1.0253, 0.8522], device='cuda:0')
G_hat_variance = tensor([0.9955, 0.9648, 0.9827, 0.8926, 0.7312, 0.8296, 0.8835, 1.1735, 0.8511,
        0.7235, 1.0826, 1.1282, 0.9800, 0.8366, 0.8942, 0.8454, 0.7893, 0.9069,
        0.9909, 0.8810], device='cuda:0')
G_tilde_var = tensor([0.0417, 0.0497, 0.0507, 0.0373, 0.0445, 0.0498, 0.0469, 0.0518, 0.0360,
        0.0593, 0.0556, 0.0426, 0.0402, 0.0721, 0.0409, 0.0480, 0.0393, 0.0469,
        0.0501, 0.0554], device='cuda:0')
gamma = tensor([[[0.9522, 0.9522, 0.9522, 0.9522]]], device='cuda:0')
Z_mean = tensor([ 0.0933-0.2016j, -0.2950+0.0134j, -0.0671+0.0206j,  0.0993-0.1003j,
         0.1070-0.0281j,  0.0021+0.1420j,  0.1177-0.0910j, -0.0240-0.0795j,
         0.1317+0.1816j, -0.0359-0.0155j,  0.1384-0.0013j, -0.1087+0.1966j,
         0.0241-0.1043j, -0.0192+0.1401j, -0.0644+0.0617j, -0.1031+0.0603j,
         0.0200-0.1100j,  0.2626+0.0393j,  0.0884-0.0996j, -0.0507+0.2397j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.0455, 1.0133, 1.0321, 0.9375, 0.7679, 0.8713, 0.9279, 1.2324, 0.8939,
        0.7598, 1.1369, 1.1849, 1.0292, 0.8787, 0.9392, 0.8879, 0.8290, 0.9525,
        1.0407, 0.9253], device='cuda:0')
Real_SNR = tensor([5.3810, 6.8320, 6.0172, 6.1438, 5.7171, 5.3797, 5.1132, 7.6437, 4.9223,
        5.2035, 5.3978, 6.1854, 6.1631, 6.9039, 5.1140, 5.4600, 5.4026, 7.3061,
        6.9092, 5.5196], device='cuda:0')
q_var = tensor([1.0002, 0.9991, 0.9982, 1.0002, 0.9911, 0.9937, 0.9805, 0.9986, 1.0000,
        0.9896, 0.9995, 0.9908, 0.9946, 1.0002, 0.9971, 0.9893, 0.9989, 0.9973,
        0.9908, 0.9870], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([1.0002, 0.9991, 0.9982, 1.0002, 0.9911, 0.9937, 0.9805, 0.9986, 1.0000,
        0.9896, 0.9995, 0.9908, 0.9946, 1.0002, 0.9971, 0.9893, 0.9989, 0.9973,
        0.9908, 0.9870], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([3.4635, 4.9238, 4.0447, 4.1042, 3.6889, 3.5395, 3.3439, 5.7854, 3.0866,
        3.3047, 3.4509, 4.1139, 4.1342, 4.8280, 3.2807, 3.5943, 3.5401, 5.4851,
        4.9528, 3.5843], device='cuda:0')
signal_var = tensor([3.4471, 4.9005, 4.0255, 4.0848, 3.6714, 3.5228, 3.3281, 5.7581, 3.0720,
        3.2891, 3.4346, 4.0944, 4.1147, 4.8051, 3.2651, 3.5773, 3.5233, 5.4591,
        4.9294, 3.5673], device='cuda:0')
w_var = tensor([0.9985, 1.0163, 1.0072, 0.9926, 0.9843, 1.0207, 1.0253, 0.9906, 0.9890,
        0.9925, 0.9910, 0.9855, 0.9955, 0.9802, 1.0058, 1.0176, 1.0155, 1.0151,
        1.0043, 1.0009], device='cuda:0')
y_var = tensor([4.4058, 5.9006, 4.9934, 5.0685, 4.6421, 4.5294, 4.3387, 6.8446, 4.0763,
        4.2597, 4.4432, 5.0825, 5.0962, 5.7867, 4.2777, 4.5628, 4.5677, 6.5031,
        5.9248, 4.5856], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([0.1913, 0.1913, 0.1913, 0.1913, 0.1913, 0.1913, 0.1913, 0.1913, 0.1913,
        0.1913, 0.1913, 0.1913, 0.1913, 0.1913, 0.1913, 0.1913, 0.1913, 0.1913,
        0.1913, 0.1913], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 4])) = tensor([[0.1475, 0.0999, 0.1163, 0.1487],
        [0.1190, 0.1250, 0.1319, 0.1311],
        [0.1420, 0.1190, 0.1141, 0.1032],
        [0.1211, 0.1493, 0.1266, 0.1237],
        [0.1321, 0.2782, 0.1422, 0.4179],
        [0.1353, 0.3419, 0.1390, 0.1035],
        [0.1666, 0.1574, 0.1047, 0.1169],
        [0.3276, 0.0870, 0.2149, 0.0937],
        [0.1863, 0.1521, 0.0774, 0.1846],
        [0.1194, 0.1738, 0.1496, 0.1527],
        [0.1690, 0.0863, 0.1420, 0.1318],
        [0.1198, 0.1164, 0.1943, 0.0824],
        [0.1641, 0.1441, 0.0707, 0.1595],
        [0.0977, 0.2284, 0.1596, 0.1473],
        [0.1456, 0.1298, 0.1503, 0.1742],
        [0.1961, 0.1057, 0.1303, 0.1589],
        [0.1094, 0.5395, 0.2114, 0.1544],
        [0.1478, 0.1556, 0.1722, 0.2677],
        [0.1568, 0.1962, 0.2680, 0.1844],
        [0.1273, 0.0899, 0.1852, 0.1519]], device='cuda:0')
Var (shape: torch.Size([20, 4])) = tensor([[0.1755, 0.1190, 0.1384, 0.1770],
        [0.1417, 0.1488, 0.1570, 0.1561],
        [0.1691, 0.1417, 0.1359, 0.1228],
        [0.1441, 0.1777, 0.1508, 0.1473],
        [0.1573, 0.3312, 0.1693, 0.4975],
        [0.1611, 0.4070, 0.1654, 0.1232],
        [0.1984, 0.1873, 0.1247, 0.1392],
        [0.3900, 0.1035, 0.2558, 0.1116],
        [0.2218, 0.1811, 0.0921, 0.2197],
        [0.1421, 0.2068, 0.1780, 0.1817],
        [0.2011, 0.1027, 0.1690, 0.1569],
        [0.1426, 0.1385, 0.2313, 0.0980],
        [0.1953, 0.1715, 0.0842, 0.1899],
        [0.1164, 0.2718, 0.1900, 0.1754],
        [0.1734, 0.1545, 0.1789, 0.2074],
        [0.2335, 0.1258, 0.1552, 0.1891],
        [0.1302, 0.6423, 0.2516, 0.1838],
        [0.1759, 0.1852, 0.2049, 0.3187],
        [0.1867, 0.2336, 0.3190, 0.2195],
        [0.1515, 0.1070, 0.2204, 0.1809]], device='cuda:0')
***********
SINR = tensor([8.0556, 7.9875, 8.2899, 7.8942, 6.1250, 7.3305, 7.8259, 7.7416, 7.8009,
        7.3617, 8.0590, 8.3331, 8.2322, 7.4082, 7.2971, 7.5413, 6.4528, 6.5563,
        6.1336, 7.8970], device='cuda:0')
Real_SINR = tensor([7.7681, 7.7503, 8.3143, 8.0503, 5.1952, 5.9519, 7.7174, 6.2507, 7.6747,
        7.1992, 8.0655, 8.0125, 7.7452, 6.5458, 6.4885, 7.4583, 4.9446, 5.8092,
        6.0549, 7.7418], device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8647, 0.8629, 0.8709, 0.8603, 0.8038, 0.8439, 0.8584, 0.8560, 0.8577,
        0.8449, 0.8648, 0.8720, 0.8694, 0.8463, 0.8429, 0.8502, 0.8155, 0.8190,
        0.8041, 0.8604], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200,
        200, 200, 200, 200, 200, 200], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/t=200/
20 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 7,  rho_ul = 1.2529680840681805-----------
G_variance = tensor([1.0892, 1.1509, 1.0909, 0.6991, 1.0196, 0.9859, 1.0775, 1.0660, 1.0108,
        0.6342, 0.6964, 0.8681, 0.9539, 0.7191, 0.8440, 1.4782, 1.0755, 1.1646,
        1.4206, 1.3132], device='cuda:0')
G_hat_variance = tensor([1.0212, 1.1388, 1.0386, 0.7182, 0.9452, 1.0120, 1.0909, 1.0579, 1.0146,
        0.6740, 0.6692, 0.9090, 0.9517, 0.6912, 0.8048, 1.4221, 0.9966, 1.1026,
        1.3490, 1.2206], device='cuda:0')
G_tilde_var = tensor([0.0418, 0.0297, 0.0414, 0.0373, 0.0388, 0.0360, 0.0417, 0.0275, 0.0473,
        0.0353, 0.0338, 0.0429, 0.0425, 0.0318, 0.0352, 0.0424, 0.0303, 0.0288,
        0.0343, 0.0402], device='cuda:0')
gamma = tensor([[[0.9616, 0.9616, 0.9616, 0.9616]]], device='cuda:0')
Z_mean = tensor([-0.0716-0.0267j,  0.0385-0.0285j, -0.1785+0.0814j, -0.2402+0.0355j,
        -0.1066+0.0643j,  0.1963+0.0732j, -0.0967+0.0245j,  0.2615+0.1224j,
        -0.2102+0.0029j,  0.1156-0.0833j, -0.0076-0.0689j, -0.1522-0.1200j,
        -0.1832-0.0702j,  0.0675-0.0160j, -0.0995-0.0886j,  0.1131+0.0981j,
         0.0354+0.0180j,  0.0417+0.1084j, -0.1390+0.0382j,  0.1566+0.0016j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.0620, 1.1843, 1.0800, 0.7469, 0.9829, 1.0523, 1.1345, 1.1001, 1.0551,
        0.7009, 0.6959, 0.9453, 0.9896, 0.7188, 0.8370, 1.4788, 1.0363, 1.1466,
        1.4029, 1.2693], device='cuda:0')
Real_SNR = tensor([7.6414, 7.5582, 7.5944, 5.3459, 7.0335, 7.0794, 7.7727, 7.0703, 7.7887,
        5.0465, 4.6172, 5.3581, 7.2000, 4.8525, 6.3301, 9.1760, 7.8190, 9.6882,
        8.2403, 8.3944], device='cuda:0')
q_var = tensor([1.0002, 0.9991, 0.9982, 1.0002, 0.9911, 0.9937, 0.9805, 0.9986, 1.0000,
        0.9896, 0.9995, 0.9908, 0.9946, 1.0002, 0.9971, 0.9893, 0.9989, 0.9973,
        0.9908, 0.9870], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([1.0002, 0.9991, 0.9982, 1.0002, 0.9911, 0.9937, 0.9805, 0.9986, 1.0000,
        0.9896, 0.9995, 0.9908, 0.9946, 1.0002, 0.9971, 0.9893, 0.9989, 0.9973,
        0.9908, 0.9870], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([4.5079, 4.4849, 4.5519, 2.7206, 4.0489, 4.1248, 4.7444, 4.0545, 4.8642,
        2.5992, 2.3873, 2.7291, 4.1635, 2.4313, 3.3226, 6.6304, 4.8556, 7.4322,
        5.2042, 5.5005], device='cuda:0')
signal_var = tensor([5.6483, 5.6195, 5.7033, 3.4088, 5.0731, 5.1682, 5.9446, 5.0802, 6.0946,
        3.2567, 2.9912, 3.4194, 5.2167, 3.0464, 4.1631, 8.3077, 6.0839, 9.3123,
        6.5207, 6.8919], device='cuda:0')
w_var = tensor([0.9722, 0.9860, 0.9924, 0.9954, 1.0044, 1.0125, 0.9928, 0.9974, 1.0141,
        1.0189, 1.0331, 0.9957, 0.9940, 0.9966, 0.9692, 1.0043, 1.0053, 1.0005,
        0.9778, 0.9975], device='cuda:0')
y_var = tensor([ 6.5651,  6.5905,  6.5827,  4.4435,  6.0887,  6.2198,  6.9831,  6.1195,
         7.1050,  4.2526,  4.0849,  4.4316,  6.1749,  4.0818,  5.1289,  9.3974,
         7.0544, 10.3477,  7.5086,  7.9209], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([0.1535, 0.1535, 0.1535, 0.1535, 0.1535, 0.1535, 0.1535, 0.1535, 0.1535,
        0.1535, 0.1535, 0.1535, 0.1535, 0.1535, 0.1535, 0.1535, 0.1535, 0.1535,
        0.1535, 0.1535], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 4])) = tensor([[0.2370, 0.0995, 0.1162, 0.1297],
        [0.2500, 0.0885, 0.1783, 0.1774],
        [0.1213, 0.0938, 0.1077, 0.2232],
        [0.2188, 0.1712, 0.1750, 0.1377],
        [0.1141, 0.1074, 0.1294, 0.1541],
        [0.1749, 0.0968, 0.0935, 0.1833],
        [0.1400, 0.1208, 0.1129, 0.1642],
        [0.1489, 0.1121, 0.1077, 0.0600],
        [0.1090, 0.1920, 0.1499, 0.1831],
        [0.2794, 0.2840, 0.3324, 0.2094],
        [0.2351, 0.2463, 0.1242, 0.1564],
        [0.1815, 0.1594, 0.0825, 0.1074],
        [0.1123, 0.2247, 0.1886, 0.1172],
        [0.2019, 0.4035, 0.2054, 0.1287],
        [0.1142, 0.1186, 0.1609, 0.1239],
        [0.1269, 0.0747, 0.1666, 0.0719],
        [0.1138, 0.2198, 0.2316, 0.1315],
        [0.0781, 0.2250, 0.1483, 0.2062],
        [0.1390, 0.0756, 0.0636, 0.0675],
        [0.1071, 0.0926, 0.1380, 0.1245]], device='cuda:0')
Var (shape: torch.Size([20, 4])) = tensor([[0.2826, 0.1186, 0.1385, 0.1547],
        [0.2981, 0.1055, 0.2126, 0.2115],
        [0.1446, 0.1119, 0.1284, 0.2661],
        [0.2609, 0.2041, 0.2086, 0.1642],
        [0.1360, 0.1281, 0.1543, 0.1837],
        [0.2086, 0.1154, 0.1114, 0.2186],
        [0.1669, 0.1440, 0.1347, 0.1958],
        [0.1776, 0.1337, 0.1285, 0.0715],
        [0.1299, 0.2289, 0.1787, 0.2183],
        [0.3332, 0.3387, 0.3963, 0.2497],
        [0.2804, 0.2937, 0.1481, 0.1865],
        [0.2164, 0.1900, 0.0983, 0.1281],
        [0.1339, 0.2680, 0.2249, 0.1397],
        [0.2407, 0.4812, 0.2449, 0.1535],
        [0.1361, 0.1414, 0.1918, 0.1477],
        [0.1514, 0.0891, 0.1986, 0.0858],
        [0.1357, 0.2621, 0.2761, 0.1568],
        [0.0931, 0.2683, 0.1768, 0.2459],
        [0.1657, 0.0902, 0.0758, 0.0805],
        [0.1277, 0.1105, 0.1645, 0.1484]], device='cuda:0')
***********
SINR = tensor([ 8.8798,  8.2649,  9.1661,  7.7147,  9.1159,  9.1040,  8.8489, 10.2150,
         8.2607,  5.7518,  7.5958,  9.2385,  8.3685,  7.0498,  9.0052, 10.1699,
         8.0487,  8.6256, 11.0963,  9.5164], device='cuda:0')
Real_SINR = tensor([ 8.5892,  8.2382,  8.7198,  7.6059,  9.1401,  8.5833,  8.5740, 10.1407,
         7.6518,  4.5334,  6.9544,  9.0374,  7.9792,  6.2923,  8.9694, 10.0430,
         7.9917,  8.2537, 11.2017,  9.4261], device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8854, 0.8702, 0.8919, 0.8552, 0.8908, 0.8905, 0.8847, 0.9131, 0.8701,
        0.7899, 0.8518, 0.8935, 0.8729, 0.8352, 0.8883, 0.9123, 0.8645, 0.8793,
        0.9279, 0.8995], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200,
        200, 200, 200, 200, 200, 200], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/t=200/
20 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 8,  rho_ul = 1.5773933612004833-----------
G_variance = tensor([1.1032, 0.8326, 0.7697, 0.9324, 1.0234, 0.9191, 0.8971, 0.8722, 0.9805,
        1.2696, 1.2515, 0.9195, 1.0119, 0.9503, 1.0612, 0.7272, 0.9296, 0.7228,
        1.1279, 1.1450], device='cuda:0')
G_hat_variance = tensor([1.0979, 0.7956, 0.7610, 0.9115, 1.0547, 0.8988, 0.8679, 0.8471, 0.9296,
        1.2054, 1.2747, 0.8367, 0.9829, 0.9410, 1.0223, 0.6739, 0.8949, 0.7693,
        1.0498, 1.1064], device='cuda:0')
G_tilde_var = tensor([0.0268, 0.0323, 0.0235, 0.0292, 0.0302, 0.0391, 0.0313, 0.0284, 0.0264,
        0.0291, 0.0328, 0.0345, 0.0398, 0.0240, 0.0215, 0.0283, 0.0239, 0.0280,
        0.0257, 0.0284], device='cuda:0')
gamma = tensor([[[0.9693, 0.9693, 0.9693, 0.9693]]], device='cuda:0')
Z_mean = tensor([ 0.2033-0.0264j, -0.1791+0.0210j,  0.0802-0.0325j, -0.1119+0.1440j,
        -0.0888-0.0565j, -0.0312+0.0756j, -0.0504-0.0085j, -0.1281+0.0330j,
        -0.1196+0.1416j,  0.0607+0.0413j,  0.0230-0.0929j, -0.1448+0.1263j,
        -0.1819-0.0941j,  0.0244+0.0165j, -0.0303-0.0336j,  0.1000+0.0446j,
         0.1578+0.0739j,  0.0075-0.0666j,  0.1121+0.1852j, -0.0553+0.0017j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.1327, 0.8208, 0.7851, 0.9404, 1.0882, 0.9272, 0.8954, 0.8740, 0.9590,
        1.2436, 1.3151, 0.8632, 1.0141, 0.9708, 1.0547, 0.6953, 0.9233, 0.7937,
        1.0831, 1.1415], device='cuda:0')
Real_SNR = tensor([8.2509, 7.7174, 7.2993, 9.1436, 9.5739, 7.3999, 7.4609, 7.5317, 8.3363,
        9.5979, 9.8243, 7.6521, 8.6583, 7.8511, 7.5293, 6.0149, 7.8258, 5.9328,
        8.4180, 8.3477], device='cuda:0')
q_var = tensor([1.0002, 0.9991, 0.9982, 1.0002, 0.9911, 0.9937, 0.9805, 0.9986, 1.0000,
        0.9896, 0.9995, 0.9908, 0.9946, 1.0002, 0.9971, 0.9893, 0.9989, 0.9973,
        0.9908, 0.9870], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([1.0002, 0.9991, 0.9982, 1.0002, 0.9911, 0.9937, 0.9805, 0.9986, 1.0000,
        0.9896, 0.9995, 0.9908, 0.9946, 1.0002, 0.9971, 0.9893, 0.9989, 0.9973,
        0.9908, 0.9870], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([4.2540, 3.7050, 3.4572, 5.1166, 5.9515, 3.4790, 3.5158, 3.6316, 4.4559,
        5.8571, 5.9977, 3.7099, 4.5487, 3.8812, 3.5870, 2.5417, 3.8788, 2.5024,
        4.4201, 4.3294], device='cuda:0')
signal_var = tensor([6.7102, 5.8443, 5.4534, 8.0709, 9.3878, 5.4877, 5.5458, 5.7284, 7.0288,
        9.2389, 9.4608, 5.8520, 7.1750, 6.1221, 5.6581, 4.0093, 6.1184, 3.9473,
        6.9722, 6.8292], device='cuda:0')
w_var = tensor([1.0038, 0.9885, 1.0156, 0.9830, 1.0355, 0.9986, 0.9951, 1.0113, 1.0310,
        1.0135, 0.9851, 1.0048, 0.9772, 1.0041, 0.9994, 1.0036, 1.0094, 1.0070,
        1.0036, 0.9991], device='cuda:0')
y_var = tensor([ 7.6475,  6.8921,  6.5719,  9.0539, 10.4325,  6.5015,  6.5340,  6.7593,
         8.0884, 10.3223, 10.5217,  6.8607,  8.1036,  7.1905,  6.5616,  5.0274,
         7.1405,  4.9699,  7.9369,  7.8715], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([0.1229, 0.1229, 0.1229, 0.1229, 0.1229, 0.1229, 0.1229, 0.1229, 0.1229,
        0.1229, 0.1229, 0.1229, 0.1229, 0.1229, 0.1229, 0.1229, 0.1229, 0.1229,
        0.1229, 0.1229], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 4])) = tensor([[0.0933, 0.1222, 0.1300, 0.1191],
        [0.1232, 0.1690, 0.1985, 0.1493],
        [0.1694, 0.1730, 0.1562, 0.1294],
        [0.1811, 0.1300, 0.1657, 0.2747],
        [0.2445, 0.2377, 0.1885, 0.1456],
        [0.1149, 0.6802, 0.1220, 0.2450],
        [0.1620, 0.2280, 0.1235, 0.1689],
        [0.1689, 0.3519, 0.1284, 0.1832],
        [0.1297, 0.1572, 0.1220, 0.1323],
        [0.0853, 0.1012, 0.2197, 0.0999],
        [0.0796, 0.0842, 0.1245, 0.0955],
        [0.3630, 0.1416, 0.0939, 0.2825],
        [0.0872, 0.1938, 0.1203, 0.3743],
        [0.1394, 0.1965, 0.1145, 0.1497],
        [0.2083, 0.2233, 0.1081, 0.1631],
        [0.2936, 0.1376, 0.1678, 0.2172],
        [0.1553, 0.1538, 0.1283, 0.1190],
        [0.2303, 0.1667, 0.2080, 0.1307],
        [0.1384, 0.0925, 0.1026, 0.1635],
        [0.0822, 0.1955, 0.1495, 0.1131]], device='cuda:0')
Var (shape: torch.Size([20, 4])) = tensor([[0.1114, 0.1459, 0.1552, 0.1421],
        [0.1471, 0.2017, 0.2370, 0.1782],
        [0.2023, 0.2065, 0.1865, 0.1545],
        [0.2162, 0.1552, 0.1978, 0.3280],
        [0.2919, 0.2837, 0.2251, 0.1738],
        [0.1372, 0.8120, 0.1457, 0.2925],
        [0.1934, 0.2722, 0.1474, 0.2017],
        [0.2017, 0.4201, 0.1533, 0.2188],
        [0.1548, 0.1877, 0.1456, 0.1580],
        [0.1018, 0.1208, 0.2623, 0.1193],
        [0.0950, 0.1005, 0.1486, 0.1140],
        [0.4333, 0.1691, 0.1120, 0.3373],
        [0.1041, 0.2314, 0.1436, 0.4468],
        [0.1664, 0.2346, 0.1367, 0.1787],
        [0.2486, 0.2666, 0.1290, 0.1947],
        [0.3505, 0.1643, 0.2003, 0.2593],
        [0.1854, 0.1836, 0.1531, 0.1420],
        [0.2750, 0.1990, 0.2483, 0.1561],
        [0.1652, 0.1104, 0.1225, 0.1951],
        [0.0982, 0.2334, 0.1785, 0.1351]], device='cuda:0')
***********
SINR = tensor([10.4924,  9.1652,  9.1721,  8.6498,  8.1646,  8.5659,  8.9596,  8.4797,
         9.7999, 10.6370, 11.3836,  8.8578,  9.4648,  9.4748,  8.9745,  8.3249,
         9.6995,  8.6327, 10.3566, 10.2128], device='cuda:0')
Real_SINR = tensor([10.3540,  9.2142,  9.0505,  8.2735,  7.8349,  6.3313,  8.8317,  7.9942,
         9.7209,  9.5928, 10.9130,  8.0102,  7.4518,  9.4200,  8.4846,  8.2349,
         9.9308,  8.2466,  9.7829,  9.5326], device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9180, 0.8919, 0.8921, 0.8799, 0.8676, 0.8779, 0.8873, 0.8757, 0.9052,
        0.9205, 0.9322, 0.8849, 0.8984, 0.8986, 0.8876, 0.8718, 0.9032, 0.8795,
        0.9157, 0.9131], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200,
        200, 200, 200, 200, 200, 200], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/t=200/
20 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 9,  rho_ul = 1.985820586810704-----------
G_variance = tensor([0.8396, 0.7361, 1.0867, 1.0914, 1.2700, 1.2327, 0.7701, 1.1031, 0.7765,
        0.9633, 1.0345, 0.9722, 0.8754, 1.1992, 0.9921, 1.1200, 0.9587, 1.1795,
        0.7222, 0.9607], device='cuda:0')
G_hat_variance = tensor([0.7896, 0.7598, 1.0609, 1.0722, 1.1931, 1.1967, 0.7723, 1.0522, 0.7758,
        0.9101, 1.0061, 0.9523, 0.7712, 1.1723, 0.8910, 1.0845, 0.8961, 1.1737,
        0.7175, 0.9439], device='cuda:0')
G_tilde_var = tensor([0.0203, 0.0228, 0.0270, 0.0187, 0.0238, 0.0173, 0.0238, 0.0194, 0.0214,
        0.0183, 0.0228, 0.0236, 0.0321, 0.0229, 0.0259, 0.0234, 0.0196, 0.0197,
        0.0271, 0.0227], device='cuda:0')
gamma = tensor([[[0.9754, 0.9754, 0.9754, 0.9754]]], device='cuda:0')
Z_mean = tensor([ 0.0476+0.0122j,  0.1010+0.2191j, -0.0942+0.0953j, -0.0584-0.0516j,
         0.2646-0.0939j, -0.1040-0.1137j, -0.0876+0.0139j, -0.0839-0.0732j,
        -0.0637-0.1671j,  0.1624-0.2199j,  0.0118+0.2636j, -0.0873+0.0679j,
         0.1071+0.0625j, -0.2280+0.1084j,  0.0904-0.1613j, -0.0047-0.0139j,
        -0.0233+0.0569j, -0.0860+0.1148j,  0.0441-0.1073j, -0.0680+0.0683j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.8095, 0.7790, 1.0876, 1.0992, 1.2231, 1.2268, 0.7917, 1.0787, 0.7954,
        0.9330, 1.0315, 0.9762, 0.7906, 1.2018, 0.9134, 1.1118, 0.9187, 1.2033,
        0.7356, 0.9677], device='cuda:0')
Real_SNR = tensor([ 8.0616,  8.0169,  8.6352, 10.1997,  9.6850, 10.9378,  7.0574,  8.5116,
         7.7042,  8.6184,  8.9789,  9.1600,  9.7621, 10.6155, 10.0355,  9.6211,
         9.3759, 11.1595,  7.8116,  8.6341], device='cuda:0')
q_var = tensor([1.0002, 0.9991, 0.9982, 1.0002, 0.9911, 0.9937, 0.9805, 0.9986, 1.0000,
        0.9896, 0.9995, 0.9908, 0.9946, 1.0002, 0.9971, 0.9893, 0.9989, 0.9973,
        0.9908, 0.9870], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([1.0002, 0.9991, 0.9982, 1.0002, 0.9911, 0.9937, 0.9805, 0.9986, 1.0000,
        0.9896, 0.9995, 0.9908, 0.9946, 1.0002, 0.9971, 0.9893, 0.9989, 0.9973,
        0.9908, 0.9870], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([3.3375, 3.2522, 3.6426, 5.2636, 4.7262, 6.1759, 2.5896, 3.5886, 3.0347,
        3.6064, 4.0513, 4.1630, 4.7173, 5.7727, 5.1149, 4.4614, 4.3018, 6.3869,
        3.0599, 3.7129], device='cuda:0')
signal_var = tensor([ 6.6277,  6.4583,  7.2335, 10.4525,  9.3855, 12.2642,  5.1425,  7.1264,
         6.0264,  7.1617,  8.0451,  8.2670,  9.3678, 11.4636, 10.1574,  8.8596,
         8.5426, 12.6831,  6.0765,  7.3731], device='cuda:0')
w_var = tensor([1.0356, 1.0196, 0.9904, 0.9983, 1.0091, 0.9882, 1.0126, 1.0040, 1.0224,
        0.9844, 1.0177, 1.0031, 0.9895, 0.9949, 1.0075, 0.9667, 0.9863, 0.9711,
        1.0058, 1.0098], device='cuda:0')
y_var = tensor([ 7.6987,  7.5384,  8.2875, 11.4767, 10.3847, 13.2499,  6.2420,  8.1211,
         7.1024,  8.1551,  9.1007,  9.1945, 10.4467, 12.4201, 11.0889,  9.9040,
         9.6402, 13.5595,  7.1029,  8.3642], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([0.0982, 0.0982, 0.0982, 0.0982, 0.0982, 0.0982, 0.0982, 0.0982, 0.0982,
        0.0982, 0.0982, 0.0982, 0.0982, 0.0982, 0.0982, 0.0982, 0.0982, 0.0982,
        0.0982, 0.0982], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 4])) = tensor([[0.1403, 0.5600, 0.3399, 0.1190],
        [0.1910, 0.1912, 0.1095, 0.2626],
        [0.1509, 0.0896, 0.1180, 0.1927],
        [0.2145, 0.1207, 0.1473, 0.2049],
        [0.1622, 0.0813, 0.0763, 0.1357],
        [0.0759, 0.0909, 0.1261, 0.1116],
        [0.1609, 0.2911, 0.1058, 0.2534],
        [0.1824, 0.4260, 0.0747, 0.1312],
        [0.1630, 0.2048, 0.1854, 0.2110],
        [0.1714, 0.1058, 0.1184, 0.1371],
        [0.2071, 0.1171, 0.1064, 0.1370],
        [0.0917, 0.1678, 0.0941, 0.1630],
        [0.1998, 0.3280, 0.1533, 0.2730],
        [0.1025, 0.1662, 0.0654, 0.1320],
        [0.1100, 0.1050, 0.2555, 0.2262],
        [0.1511, 0.1368, 0.1728, 0.1014],
        [0.2420, 0.1352, 0.2830, 0.2134],
        [0.0829, 0.1223, 0.1685, 0.2080],
        [0.1275, 0.3794, 0.2904, 0.2131],
        [0.1791, 0.0998, 0.1753, 0.2607]], device='cuda:0')
Var (shape: torch.Size([20, 4])) = tensor([[0.1676, 0.6692, 0.4062, 0.1422],
        [0.2282, 0.2285, 0.1309, 0.3139],
        [0.1803, 0.1071, 0.1410, 0.2302],
        [0.2564, 0.1442, 0.1760, 0.2449],
        [0.1938, 0.0971, 0.0912, 0.1622],
        [0.0907, 0.1086, 0.1507, 0.1334],
        [0.1922, 0.3478, 0.1264, 0.3029],
        [0.2180, 0.5091, 0.0892, 0.1568],
        [0.1948, 0.2447, 0.2215, 0.2521],
        [0.2048, 0.1265, 0.1415, 0.1639],
        [0.2475, 0.1400, 0.1271, 0.1638],
        [0.1096, 0.2005, 0.1125, 0.1949],
        [0.2388, 0.3920, 0.1832, 0.3263],
        [0.1225, 0.1986, 0.0782, 0.1578],
        [0.1315, 0.1255, 0.3054, 0.2704],
        [0.1806, 0.1635, 0.2065, 0.1212],
        [0.2892, 0.1615, 0.3382, 0.2550],
        [0.0990, 0.1462, 0.2014, 0.2486],
        [0.1523, 0.4534, 0.3470, 0.2546],
        [0.2141, 0.1193, 0.2095, 0.3116]], device='cuda:0')
***********
SINR = tensor([ 9.1437,  9.7700, 11.0526,  9.9896, 11.9813, 12.2117,  9.7045, 10.6770,
         9.3305, 10.9933, 10.8577, 11.3434,  8.6864, 11.9458, 10.3817, 10.7856,
         9.0326, 10.9888,  8.7764, 10.0803], device='cuda:0')
Real_SINR = tensor([ 7.7607,  9.4311, 10.5663,  9.8895, 11.4120, 12.3767,  8.9850,  9.2550,
         9.1539, 11.4435, 10.3586, 11.3368,  7.4954, 11.6219,  9.7237, 10.9969,
         8.4477, 10.4348,  8.1815,  9.7689], device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8914, 0.9046, 0.9272, 0.9089, 0.9404, 0.9433, 0.9033, 0.9212, 0.8955,
        0.9263, 0.9241, 0.9316, 0.8808, 0.9399, 0.9161, 0.9230, 0.8889, 0.9262,
        0.8830, 0.9106], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200,
        200, 200, 200, 200, 200, 200], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/t=200/
20 images are saved in outputs/MIMOdiffusion/nonoisenosample/
