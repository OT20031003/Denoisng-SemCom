Loading model from models/ldm/text2img-large/model.ckpt
autoencoder.py
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
ldm.modules/diffusionmodules/util.py ; make_schedule = linear
ldm/modules/diffusionmodules/model.py, Enocoder; in_channels = 3, ch_mult = [1, 2, 4, 4]
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
making attention of type 'vanilla' with 512 in_channels
ldm/models/autoencoder.py, AutoencoderKL init, created
Working with z of shape (1, 4, 32, 32) = 4096 dimensions.
making attention of type 'vanilla' with 512 in_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
remove_png complete
img shape = torch.Size([20, 3, 256, 256])
20 images are saved in ./sentimg/
Encoder, forward@@@@@@@@@@@@@@@
autoencoder.py, h = torch.Size([20, 8, 32, 32])
autoencoder.py , moments = torch.Size([20, 8, 32, 32])
encode start = 
z_variance before normalization = tensor([0.6331, 0.7854, 0.6502, 0.7924, 0.5607, 0.5562, 1.0437, 0.4510, 0.6230,
        0.6187, 0.5298, 0.5912, 0.5910, 0.6297, 0.6507, 0.9634, 0.4686, 0.9956,
        0.5815, 0.6080], device='cuda:0')
Variance (Real, all elements): 0.4190022349357605
Variance (Imag, all elements): 0.28684020042419434
--------SNR = -5,  rho_ul = 0.31622776601683794-----------
G_variance = tensor([0.9681, 0.8958, 1.3374, 0.8863, 1.0526, 1.0563, 0.9759, 1.0143, 0.8949,
        1.1036, 1.0882, 0.9516, 1.0702, 1.0534, 0.9776, 1.1064, 1.0368, 1.0872,
        0.9376, 1.0616], device='cuda:0')
G_hat_variance = tensor([0.2358, 0.2172, 0.3088, 0.2426, 0.2446, 0.1880, 0.2260, 0.2866, 0.2117,
        0.2153, 0.2357, 0.2562, 0.2749, 0.2619, 0.2660, 0.2433, 0.2567, 0.2447,
        0.2374, 0.2373], device='cuda:0')
G_tilde_var = tensor([0.7955, 0.6829, 0.9514, 0.6498, 0.6450, 0.7493, 0.7572, 0.7877, 0.7424,
        0.7983, 0.7678, 0.6945, 0.8778, 0.7381, 0.7696, 0.7302, 0.7560, 0.8183,
        0.7681, 0.9202], device='cuda:0')
gamma = tensor([[[0.2403]]], device='cuda:0')
Z_mean = tensor([ 0.1770+0.0166j,  0.1286-0.0258j,  0.0078+0.0497j,  0.0110+0.0824j,
         0.0372-0.1089j,  0.1644+0.1402j, -0.0069+0.0158j, -0.0169-0.0560j,
        -0.0994+0.1283j,  0.0377+0.0237j, -0.1191+0.0091j, -0.0512+0.1146j,
         0.0428+0.0893j,  0.0228-0.0285j, -0.0325+0.1607j,  0.0218-0.1020j,
         0.0784-0.0161j,  0.0500-0.0080j, -0.0685+0.0218j, -0.0435+0.0756j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.9814, 0.9041, 1.2853, 1.0098, 1.0183, 0.7826, 0.9408, 1.1931, 0.8810,
        0.8962, 0.9810, 1.0663, 1.1442, 1.0901, 1.1072, 1.0127, 1.0685, 1.0183,
        0.9880, 0.9877], device='cuda:0')
Real_SNR = tensor([-4.6879, -4.8061, -2.3621, -5.1402, -4.4531, -4.1300, -4.8617, -4.4586,
        -5.1664, -4.1407, -4.1362, -4.5876, -4.2216, -4.3649, -4.2757, -4.3676,
        -4.5565, -3.9244, -4.7450, -4.4396], device='cuda:0')
q_var = tensor([0.7198, 0.4265, 0.5737, 0.6398, 0.7661, 0.7163, 0.6677, 0.8443, 0.7045,
        0.7006, 0.8890, 0.6916, 0.7820, 0.7259, 0.5843, 0.5859, 0.8244, 0.4483,
        0.7216, 0.7546], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.7198, 0.4265, 0.5737, 0.6398, 0.7661, 0.7163, 0.6677, 0.8443, 0.7045,
        0.7006, 0.8890, 0.6916, 0.7820, 0.7259, 0.5843, 0.5859, 0.8244, 0.4483,
        0.7216, 0.7546], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([1.0741, 1.0459, 1.8375, 0.9640, 1.1386, 1.2195, 1.0341, 1.1371, 0.9638,
        1.2160, 1.2197, 1.1020, 1.1962, 1.1586, 1.1797, 1.1541, 1.1062, 1.2858,
        1.0594, 1.1343], device='cuda:0')
signal_var = tensor([0.3396, 0.3307, 0.5811, 0.3048, 0.3600, 0.3856, 0.3270, 0.3596, 0.3048,
        0.3845, 0.3857, 0.3485, 0.3783, 0.3664, 0.3730, 0.3650, 0.3498, 0.4066,
        0.3350, 0.3587], device='cuda:0')
w_var = tensor([0.9996, 1.0002, 1.0010, 0.9956, 1.0039, 0.9981, 1.0017, 1.0038, 1.0014,
        0.9977, 0.9997, 1.0022, 0.9999, 1.0010, 0.9985, 0.9977, 0.9988, 1.0037,
        0.9990, 0.9970], device='cuda:0')
y_var = tensor([1.3403, 1.3313, 1.5785, 1.3012, 1.3629, 1.3832, 1.3272, 1.3657, 1.3038,
        1.3808, 1.3825, 1.3548, 1.3818, 1.3657, 1.3684, 1.3623, 1.3468, 1.4093,
        1.3342, 1.3607], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([0.7597, 0.7597, 0.7597, 0.7597, 0.7597, 0.7597, 0.7597, 0.7597, 0.7597,
        0.7597, 0.7597, 0.7597, 0.7597, 0.7597, 0.7597, 0.7597, 0.7597, 0.7597,
        0.7597, 0.7597], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 1])) = tensor([[0.0157],
        [0.0172],
        [0.0123],
        [0.0156],
        [0.0154],
        [0.0191],
        [0.0169],
        [0.0133],
        [0.0175],
        [0.0177],
        [0.0159],
        [0.0147],
        [0.0138],
        [0.0145],
        [0.0140],
        [0.0155],
        [0.0148],
        [0.0155],
        [0.0160],
        [0.0159]], device='cuda:0')
inv_Z_H_Z_k.mean (expected to be = 0.01587301584782061) = 0.015562975779175758
Var (shape: torch.Size([20, 1])) = tensor([[0.0194],
        [0.0214],
        [0.0153],
        [0.0194],
        [0.0191],
        [0.0237],
        [0.0209],
        [0.0165],
        [0.0217],
        [0.0219],
        [0.0198],
        [0.0182],
        [0.0171],
        [0.0180],
        [0.0174],
        [0.0192],
        [0.0183],
        [0.0193],
        [0.0198],
        [0.0198]], device='cuda:0')
***********
SINR = tensor([5.9234, 5.5101, 6.9638, 5.9376, 6.0006, 5.0561, 5.6015, 6.6442, 5.4444,
        5.3988, 5.8455, 6.2085, 6.4876, 6.2452, 6.4130, 5.9668, 6.1793, 5.9549,
        5.8357, 5.8452], device='cuda:0')
Real_SINR = tensor([4.8899, 1.8475, 4.9674, 4.8209, 4.2285, 2.8630, 3.7122, 6.3438, 4.6720,
        4.1412, 5.4367, 5.0955, 5.6075, 5.2406, 4.9168, 3.5516, 6.1612, 3.3525,
        5.0618, 4.7216], device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7964, 0.7805, 0.8325, 0.7969, 0.7993, 0.7621, 0.7841, 0.8220, 0.7779,
        0.7761, 0.7935, 0.8068, 0.8167, 0.8081, 0.8141, 0.7980, 0.8058, 0.7976,
        0.7931, 0.7935], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([172, 183, 147, 172, 170, 195, 181, 155, 185, 186, 174, 165, 158, 164,
        160, 171, 166, 171, 174, 174], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/M=64/K=1/dynamic/
20 images are saved in outputs/MIMOdiffusion/M=64/K=1/nonoisenosample/
--------SNR = -4,  rho_ul = 0.3981071705534972-----------
G_variance = tensor([0.9858, 1.0462, 1.0561, 1.0970, 1.1926, 1.2742, 1.2475, 1.2438, 0.8711,
        1.0607, 0.9514, 0.9698, 1.0747, 1.1094, 0.8443, 0.9594, 1.0325, 0.9483,
        1.0116, 0.9389], device='cuda:0')
G_hat_variance = tensor([0.2870, 0.3385, 0.2601, 0.2655, 0.3035, 0.3340, 0.3541, 0.3070, 0.2782,
        0.3448, 0.3158, 0.2906, 0.3094, 0.3238, 0.2646, 0.2810, 0.3176, 0.2678,
        0.2961, 0.2278], device='cuda:0')
G_tilde_var = tensor([0.7034, 0.7909, 0.7416, 0.7865, 0.8040, 0.8299, 0.7046, 0.8594, 0.7028,
        0.8500, 0.7806, 0.7271, 0.7174, 0.7190, 0.6854, 0.5969, 0.6108, 0.7606,
        0.7067, 0.7829], device='cuda:0')
gamma = tensor([[[0.2847]]], device='cuda:0')
Z_mean = tensor([ 0.0195+0.0745j, -0.0308+0.0218j, -0.0632-0.0660j,  0.0592-0.0491j,
        -0.0469-0.0065j, -0.0869+0.0738j,  0.0213-0.0176j,  0.1168-0.0851j,
        -0.1092+0.1572j, -0.1590-0.0096j, -0.0354+0.1052j,  0.0361+0.0626j,
        -0.0563+0.0310j, -0.0857+0.0144j, -0.0110+0.0423j,  0.0158+0.0082j,
         0.0226+0.0487j, -0.0647-0.0034j, -0.0726+0.0388j,  0.1352+0.0086j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.0078, 1.1888, 0.9134, 0.9323, 1.0658, 1.1729, 1.2434, 1.0782, 0.9770,
        1.2107, 1.1091, 1.0206, 1.0866, 1.1373, 0.9293, 0.9870, 1.1154, 0.9404,
        1.0397, 0.8000], device='cuda:0')
Real_SNR = tensor([-3.6712, -3.1552, -2.3531, -3.2575, -2.9094, -2.4753, -2.7840, -2.5855,
        -4.2661, -3.2887, -3.6394, -3.7070, -3.2632, -3.1572, -4.0065, -3.9959,
        -3.6037, -3.5522, -3.4572, -3.9933], device='cuda:0')
q_var = tensor([0.7198, 0.4265, 0.5737, 0.6398, 0.7661, 0.7163, 0.6677, 0.8443, 0.7045,
        0.7006, 0.8890, 0.6916, 0.7820, 0.7259, 0.5843, 0.5859, 0.8244, 0.4483,
        0.7216, 0.7546], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.7198, 0.4265, 0.5737, 0.6398, 0.7661, 0.7163, 0.6677, 0.8443, 0.7045,
        0.7006, 0.8890, 0.6916, 0.7820, 0.7259, 0.5843, 0.5859, 0.8244, 0.4483,
        0.7216, 0.7546], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([1.0770, 1.2132, 1.4594, 1.1877, 1.2818, 1.4188, 1.3240, 1.3834, 0.9376,
        1.1798, 1.0858, 1.0675, 1.1851, 1.2164, 1.0021, 0.9944, 1.1001, 1.1153,
        1.1398, 1.0012], device='cuda:0')
signal_var = tensor([0.4288, 0.4830, 0.5810, 0.4728, 0.5103, 0.5648, 0.5271, 0.5507, 0.3733,
        0.4697, 0.4323, 0.4250, 0.4718, 0.4843, 0.3990, 0.3959, 0.4380, 0.4440,
        0.4538, 0.3986], device='cuda:0')
w_var = tensor([0.9985, 0.9987, 0.9988, 1.0011, 0.9971, 0.9987, 1.0007, 0.9988, 0.9968,
        1.0016, 0.9993, 0.9979, 1.0002, 1.0019, 1.0036, 0.9935, 1.0042, 1.0061,
        1.0059, 0.9997], device='cuda:0')
y_var = tensor([1.4234, 1.4806, 1.5802, 1.4737, 1.5029, 1.5652, 1.5276, 1.5422, 1.3702,
        1.4720, 1.4338, 1.4277, 1.4672, 1.4841, 1.4033, 1.3928, 1.4418, 1.4509,
        1.4596, 1.3990], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([0.7153, 0.7153, 0.7153, 0.7153, 0.7153, 0.7153, 0.7153, 0.7153, 0.7153,
        0.7153, 0.7153, 0.7153, 0.7153, 0.7153, 0.7153, 0.7153, 0.7153, 0.7153,
        0.7153, 0.7153], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 1])) = tensor([[0.0157],
        [0.0133],
        [0.0172],
        [0.0169],
        [0.0149],
        [0.0134],
        [0.0128],
        [0.0144],
        [0.0157],
        [0.0128],
        [0.0142],
        [0.0155],
        [0.0146],
        [0.0139],
        [0.0170],
        [0.0161],
        [0.0142],
        [0.0168],
        [0.0152],
        [0.0194]], device='cuda:0')
inv_Z_H_Z_k.mean (expected to be = 0.01587301584782061) = 0.015188409946858883
Var (shape: torch.Size([20, 1])) = tensor([[0.0201],
        [0.0171],
        [0.0221],
        [0.0217],
        [0.0191],
        [0.0172],
        [0.0164],
        [0.0185],
        [0.0201],
        [0.0165],
        [0.0182],
        [0.0199],
        [0.0187],
        [0.0178],
        [0.0219],
        [0.0207],
        [0.0182],
        [0.0216],
        [0.0195],
        [0.0249]], device='cuda:0')
***********
SINR = tensor([7.5096, 8.2064, 7.0964, 7.1734, 7.7357, 8.1911, 8.3988, 7.8614, 7.5111,
        8.3718, 7.9483, 7.5607, 7.8273, 8.0377, 7.1403, 7.3944, 7.9356, 7.2025,
        7.6476, 6.5806], device='cuda:0')
Real_SINR = tensor([7.2313, 4.3676, 5.2334, 5.1261, 6.8203, 6.9460, 6.2983, 7.3698, 5.8099,
        6.7425, 7.6231, 6.8963, 7.5845, 6.4153, 5.1017, 5.6237, 7.2759, 4.4440,
        7.3454, 5.5451], device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8493, 0.8687, 0.8367, 0.8391, 0.8558, 0.8683, 0.8737, 0.8594, 0.8493,
        0.8730, 0.8618, 0.8508, 0.8584, 0.8642, 0.8381, 0.8459, 0.8614, 0.8400,
        0.8533, 0.8198], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([135, 120, 144, 142, 130, 121, 117, 128, 135, 117, 126, 134, 128, 124,
        143, 138, 126, 142, 132, 156], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/M=64/K=1/dynamic/
20 images are saved in outputs/MIMOdiffusion/M=64/K=1/nonoisenosample/
--------SNR = -3,  rho_ul = 0.5011872336272722-----------
G_variance = tensor([1.0651, 0.9197, 0.8283, 1.1009, 1.1387, 1.1598, 0.9027, 0.9684, 0.9974,
        1.0108, 1.1527, 0.9790, 0.9339, 1.0657, 0.9560, 1.0373, 1.0165, 1.0685,
        0.8690, 1.0383], device='cuda:0')
G_hat_variance = tensor([0.3122, 0.2806, 0.3612, 0.3991, 0.4208, 0.3485, 0.3776, 0.3201, 0.3709,
        0.3557, 0.4013, 0.3222, 0.3166, 0.3887, 0.2978, 0.2818, 0.3655, 0.3590,
        0.2678, 0.2704], device='cuda:0')
G_tilde_var = tensor([0.7355, 0.6131, 0.5269, 0.6995, 0.6500, 0.8755, 0.5895, 0.6122, 0.6001,
        0.6018, 0.6402, 0.6625, 0.6668, 0.5950, 0.6873, 0.7314, 0.6528, 0.7167,
        0.6720, 0.7471], device='cuda:0')
gamma = tensor([[[0.3339]]], device='cuda:0')
Z_mean = tensor([ 0.2841-0.1081j,  0.0008+0.1024j,  0.0659-0.1161j,  0.0070+0.0048j,
        -0.1757-0.1790j, -0.0805+0.0304j,  0.0341-0.0346j,  0.0148-0.0824j,
        -0.1086+0.0307j,  0.1357-0.0019j,  0.1306-0.0177j, -0.0256+0.0160j,
        -0.0076-0.0552j,  0.0970-0.0376j, -0.0365+0.0407j, -0.0127+0.0671j,
         0.1483-0.0193j, -0.0102+0.0345j,  0.0559+0.0292j, -0.0617-0.0409j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.9351, 0.8405, 1.0820, 1.1955, 1.2603, 1.0440, 1.1311, 0.9587, 1.1109,
        1.0655, 1.2021, 0.9652, 0.9482, 1.1642, 0.8918, 0.8441, 1.0949, 1.0752,
        0.8021, 0.8099], device='cuda:0')
Real_SNR = tensor([-2.2290, -2.7198, -2.3972, -2.2519, -1.9751, -1.9042, -3.1986, -2.6577,
        -2.5127, -2.4463, -1.9937, -2.6885, -2.8582, -2.3112, -2.4091, -2.6772,
        -2.6241, -1.9876, -3.0656, -2.5004], device='cuda:0')
q_var = tensor([0.7198, 0.4265, 0.5737, 0.6398, 0.7661, 0.7163, 0.6677, 0.8443, 0.7045,
        0.7006, 0.8890, 0.6916, 0.7820, 0.7259, 0.5843, 0.5859, 0.8244, 0.4483,
        0.7216, 0.7546], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.7198, 0.4265, 0.5737, 0.6398, 0.7661, 0.7163, 0.6677, 0.8443, 0.7045,
        0.7006, 0.8890, 0.6916, 0.7820, 0.7259, 0.5843, 0.5859, 0.8244, 0.4483,
        0.7216, 0.7546], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([1.1970, 1.0662, 1.1501, 1.1873, 1.2674, 1.2878, 0.9567, 1.0752, 1.1218,
        1.1388, 1.2593, 1.0786, 1.0345, 1.1670, 1.1398, 1.0775, 1.0912, 1.2560,
        0.9895, 1.1190], device='cuda:0')
signal_var = tensor([0.5999, 0.5344, 0.5764, 0.5950, 0.6352, 0.6454, 0.4795, 0.5389, 0.5622,
        0.5707, 0.6311, 0.5406, 0.5185, 0.5849, 0.5713, 0.5400, 0.5469, 0.6295,
        0.4959, 0.5608], device='cuda:0')
w_var = tensor([1.0023, 0.9996, 1.0011, 0.9994, 1.0010, 1.0006, 1.0015, 0.9938, 1.0027,
        1.0025, 0.9988, 1.0040, 1.0012, 0.9959, 0.9948, 1.0003, 1.0008, 0.9948,
        1.0046, 0.9974], device='cuda:0')
y_var = tensor([1.6088, 1.5318, 1.5766, 1.5979, 1.6340, 1.6449, 1.4779, 1.5310, 1.5645,
        1.5714, 1.6307, 1.5427, 1.5235, 1.5836, 1.5603, 1.5388, 1.5460, 1.6243,
        1.5000, 1.5584], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([0.6661, 0.6661, 0.6661, 0.6661, 0.6661, 0.6661, 0.6661, 0.6661, 0.6661,
        0.6661, 0.6661, 0.6661, 0.6661, 0.6661, 0.6661, 0.6661, 0.6661, 0.6661,
        0.6661, 0.6661], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 1])) = tensor([[0.0154],
        [0.0186],
        [0.0144],
        [0.0133],
        [0.0120],
        [0.0151],
        [0.0140],
        [0.0164],
        [0.0141],
        [0.0146],
        [0.0130],
        [0.0164],
        [0.0167],
        [0.0135],
        [0.0177],
        [0.0187],
        [0.0142],
        [0.0147],
        [0.0197],
        [0.0195]], device='cuda:0')
inv_Z_H_Z_k.mean (expected to be = 0.01587301584782061) = 0.015611874870955944
Var (shape: torch.Size([20, 1])) = tensor([[0.0206],
        [0.0249],
        [0.0192],
        [0.0177],
        [0.0160],
        [0.0201],
        [0.0187],
        [0.0219],
        [0.0188],
        [0.0195],
        [0.0174],
        [0.0219],
        [0.0223],
        [0.0180],
        [0.0237],
        [0.0249],
        [0.0189],
        [0.0197],
        [0.0263],
        [0.0260]], device='cuda:0')
***********
SINR = tensor([ 9.1019,  8.2783,  9.3923,  9.7538, 10.1974,  9.1961,  9.5222,  8.8271,
         9.4851,  9.3290,  9.8407,  8.8284,  8.7614,  9.6790,  8.4956,  8.2664,
         9.4608,  9.2983,  8.0420,  8.0918], device='cuda:0')
Real_SINR = tensor([7.9871, 5.7643, 8.0133, 8.9784, 9.9754, 8.8815, 8.3653, 8.4188, 8.9771,
        8.5160, 9.6003, 8.3749, 7.6381, 8.9912, 7.3206, 6.7241, 9.5716, 6.5896,
        7.2329, 7.9227], device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8905, 0.8706, 0.8968, 0.9043, 0.9128, 0.8926, 0.8996, 0.8842, 0.8988,
        0.8955, 0.9060, 0.8842, 0.8826, 0.9028, 0.8761, 0.8703, 0.8983, 0.8948,
        0.8643, 0.8657], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([103, 119,  98,  92,  85, 102,  96, 109,  97,  99,  91, 108, 110,  94,
        115, 119,  97, 100, 124, 123], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/M=64/K=1/dynamic/
20 images are saved in outputs/MIMOdiffusion/M=64/K=1/nonoisenosample/
--------SNR = -2,  rho_ul = 0.6309573444801932-----------
G_variance = tensor([1.0460, 0.8712, 1.1956, 1.0383, 0.9831, 1.0394, 0.8464, 1.1418, 0.9741,
        0.9934, 1.0874, 0.8248, 0.9975, 1.0918, 1.1092, 1.1613, 0.9161, 0.9779,
        0.9591, 0.8821], device='cuda:0')
G_hat_variance = tensor([0.3144, 0.3457, 0.3903, 0.3212, 0.4569, 0.3494, 0.3227, 0.4570, 0.3933,
        0.4393, 0.3636, 0.3739, 0.4198, 0.3736, 0.3554, 0.4598, 0.3962, 0.4201,
        0.3434, 0.3719], device='cuda:0')
G_tilde_var = tensor([0.6441, 0.5063, 0.8517, 0.6224, 0.5352, 0.7226, 0.5236, 0.4803, 0.5323,
        0.4917, 0.5630, 0.5554, 0.6899, 0.5825, 0.5772, 0.7061, 0.4903, 0.5846,
        0.6810, 0.5283], device='cuda:0')
gamma = tensor([[[0.3869]]], device='cuda:0')
Z_mean = tensor([-0.0381-0.0214j,  0.0654-0.0449j,  0.1176+0.0103j,  0.0672-0.0612j,
         0.0609-0.0964j,  0.0035-0.0287j, -0.0540+0.0344j, -0.0173-0.0051j,
        -0.0640-0.0750j, -0.0325+0.0439j, -0.0447+0.0943j, -0.1089+0.0415j,
         0.0877+0.0470j, -0.0642-0.0202j,  0.0671-0.0828j,  0.0081+0.1042j,
         0.0050-0.1171j,  0.0020+0.1186j,  0.0633+0.0832j,  0.0478-0.0524j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.8127, 0.8937, 1.0089, 0.8303, 1.1810, 0.9032, 0.8342, 1.1814, 1.0166,
        1.1356, 0.9400, 0.9665, 1.0852, 0.9658, 0.9188, 1.1884, 1.0242, 1.0859,
        0.8876, 0.9614], device='cuda:0')
Real_SNR = tensor([-1.4004, -1.9641,  0.1262, -1.4972, -1.7648, -1.4033, -2.4825, -0.9776,
        -1.7667, -1.4758, -1.2632, -2.3994, -1.5969, -1.2150, -0.8157, -1.1361,
        -1.9519, -1.3682, -1.6660, -2.3112], device='cuda:0')
q_var = tensor([0.7198, 0.4265, 0.5737, 0.6398, 0.7661, 0.7163, 0.6677, 0.8443, 0.7045,
        0.7006, 0.8890, 0.6916, 0.7820, 0.7259, 0.5843, 0.5859, 0.8244, 0.4483,
        0.7216, 0.7546], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.7198, 0.4265, 0.5737, 0.6398, 0.7661, 0.7163, 0.6677, 0.8443, 0.7045,
        0.7006, 0.8890, 0.6916, 0.7820, 0.7259, 0.5843, 0.5859, 0.8244, 0.4483,
        0.7216, 0.7546], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([1.1491, 1.0103, 1.6402, 1.1193, 1.0584, 1.1476, 0.8945, 1.2710, 1.0525,
        1.1291, 1.1852, 0.9090, 1.1011, 1.2008, 1.3132, 1.2136, 1.0093, 1.1563,
        1.0811, 0.9350], device='cuda:0')
signal_var = tensor([0.7250, 0.6374, 1.0349, 0.7062, 0.6678, 0.7241, 0.5644, 0.8020, 0.6641,
        0.7124, 0.7478, 0.5736, 0.6948, 0.7576, 0.8286, 0.7657, 0.6369, 0.7296,
        0.6821, 0.5900], device='cuda:0')
w_var = tensor([1.0009, 1.0020, 1.0052, 0.9970, 1.0026, 1.0003, 0.9996, 1.0044, 0.9974,
        1.0008, 1.0003, 0.9966, 1.0035, 1.0022, 0.9998, 0.9947, 0.9982, 0.9998,
        1.0011, 1.0045], device='cuda:0')
y_var = tensor([1.7250, 1.6406, 2.0351, 1.7030, 1.6697, 1.7218, 1.5642, 1.8050, 1.6665,
        1.7174, 1.7468, 1.5743, 1.7016, 1.7618, 1.8250, 1.7559, 1.6365, 1.7306,
        1.6792, 1.5977], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([0.6131, 0.6131, 0.6131, 0.6131, 0.6131, 0.6131, 0.6131, 0.6131, 0.6131,
        0.6131, 0.6131, 0.6131, 0.6131, 0.6131, 0.6131, 0.6131, 0.6131, 0.6131,
        0.6131, 0.6131], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 1])) = tensor([[0.0195],
        [0.0176],
        [0.0155],
        [0.0189],
        [0.0133],
        [0.0176],
        [0.0189],
        [0.0134],
        [0.0155],
        [0.0139],
        [0.0167],
        [0.0162],
        [0.0145],
        [0.0164],
        [0.0171],
        [0.0132],
        [0.0153],
        [0.0144],
        [0.0177],
        [0.0164]], device='cuda:0')
inv_Z_H_Z_k.mean (expected to be = 0.01587301584782061) = 0.016100486740469933
Var (shape: torch.Size([20, 1])) = tensor([[0.0270],
        [0.0245],
        [0.0215],
        [0.0262],
        [0.0184],
        [0.0243],
        [0.0263],
        [0.0186],
        [0.0214],
        [0.0193],
        [0.0231],
        [0.0225],
        [0.0201],
        [0.0227],
        [0.0237],
        [0.0184],
        [0.0212],
        [0.0200],
        [0.0245],
        [0.0228]], device='cuda:0')
***********
SINR = tensor([ 9.5581,  9.9915, 10.5476,  9.6849, 11.2196, 10.0107,  9.6832, 11.1737,
        10.5621, 11.0125, 10.2305, 10.3620, 10.8437, 10.3180, 10.1348, 11.2388,
        10.6114, 10.8633,  9.9846, 10.3007], device='cuda:0')
Real_SINR = tensor([ 7.4517,  7.0320,  9.3973,  7.0582, 10.8454,  9.8104,  8.0142,  9.4367,
         8.5466, 10.4737,  8.8163,  9.1728, 10.0910,  8.7328,  7.4275,  9.4741,
         8.8069,  8.4281,  9.6626, 10.1618], device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9003, 0.9089, 0.9190, 0.9029, 0.9298, 0.9093, 0.9029, 0.9291, 0.9192,
        0.9266, 0.9134, 0.9157, 0.9239, 0.9150, 0.9116, 0.9301, 0.9201, 0.9242,
        0.9088, 0.9147], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([96, 88, 80, 93, 70, 88, 93, 71, 80, 73, 85, 83, 76, 83, 86, 70, 79, 75,
        89, 84], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/M=64/K=1/dynamic/
20 images are saved in outputs/MIMOdiffusion/M=64/K=1/nonoisenosample/
--------SNR = -1,  rho_ul = 0.7943282347242815-----------
G_variance = tensor([0.9121, 1.0423, 1.0650, 0.9020, 0.9106, 1.0880, 0.9480, 0.8109, 1.1217,
        1.1471, 1.0025, 0.9577, 0.8242, 0.9279, 1.0250, 0.8954, 0.9614, 1.0145,
        1.0064, 1.1767], device='cuda:0')
G_hat_variance = tensor([0.4051, 0.4091, 0.5192, 0.3612, 0.4408, 0.4462, 0.4021, 0.4681, 0.3832,
        0.5565, 0.4448, 0.3956, 0.4188, 0.4190, 0.4826, 0.4297, 0.4185, 0.4443,
        0.4014, 0.6409], device='cuda:0')
G_tilde_var = tensor([0.5133, 0.5440, 0.5646, 0.6218, 0.5251, 0.4824, 0.4853, 0.5933, 0.6785,
        0.5414, 0.6447, 0.5599, 0.4543, 0.5113, 0.5541, 0.4765, 0.5102, 0.5033,
        0.5824, 0.3906], device='cuda:0')
gamma = tensor([[[0.4427]]], device='cuda:0')
Z_mean = tensor([ 0.0242+0.0327j,  0.0459-0.0172j, -0.0252+0.0157j, -0.0557+0.0871j,
         0.0449-0.0820j,  0.0628+0.0890j,  0.0374+0.1799j,  0.1131-0.0021j,
         0.0992-0.0400j,  0.0127-0.0424j, -0.0830-0.0527j, -0.2084+0.1211j,
         0.0146-0.0426j,  0.0085+0.1258j,  0.0641+0.0992j, -0.1264-0.0675j,
         0.0399+0.0231j, -0.0506+0.1401j, -0.0035-0.0700j, -0.0066+0.0156j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.9152, 0.9240, 1.1729, 0.8160, 0.9958, 1.0080, 0.9083, 1.0575, 0.8656,
        1.2570, 1.0049, 0.8937, 0.9460, 0.9465, 1.0901, 0.9708, 0.9454, 1.0036,
        0.9068, 1.4478], device='cuda:0')
Real_SNR = tensor([-0.9327, -0.2046,  0.6402, -1.0754, -1.0342, -0.2036, -1.0032, -1.4614,
        -0.1660,  0.0170, -0.5551, -0.7920, -1.4255, -0.8953, -0.1250, -1.2274,
        -0.8784, -0.1933, -0.4719, -0.0414], device='cuda:0')
q_var = tensor([0.7198, 0.4265, 0.5737, 0.6398, 0.7661, 0.7163, 0.6677, 0.8443, 0.7045,
        0.7006, 0.8890, 0.6916, 0.7820, 0.7259, 0.5843, 0.5859, 0.8244, 0.4483,
        0.7216, 0.7546], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.7198, 0.4265, 0.5737, 0.6398, 0.7661, 0.7163, 0.6677, 0.8443, 0.7045,
        0.7006, 0.8890, 0.6916, 0.7820, 0.7259, 0.5843, 0.5859, 0.8244, 0.4483,
        0.7216, 0.7546], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([1.0151, 1.2082, 1.4650, 0.9785, 0.9902, 1.2082, 0.9982, 0.9052, 1.2090,
        1.2642, 1.1051, 1.0533, 0.9128, 1.0262, 1.2223, 0.9499, 1.0247, 1.2011,
        1.1289, 1.2458], device='cuda:0')
signal_var = tensor([0.8063, 0.9597, 1.1637, 0.7773, 0.7866, 0.9597, 0.7929, 0.7190, 0.9603,
        1.0042, 0.8778, 0.8367, 0.7250, 0.8151, 0.9709, 0.7545, 0.8140, 0.9541,
        0.8967, 0.9896], device='cuda:0')
w_var = tensor([0.9995, 1.0060, 1.0042, 0.9956, 0.9981, 1.0058, 0.9989, 1.0066, 0.9977,
        1.0002, 0.9975, 1.0040, 1.0067, 1.0017, 0.9992, 1.0010, 0.9965, 0.9975,
        0.9997, 0.9990], device='cuda:0')
y_var = tensor([1.8077, 1.9710, 2.1728, 1.7742, 1.7815, 1.9625, 1.7913, 1.7200, 1.9538,
        2.0036, 1.8790, 1.8398, 1.7320, 1.8185, 1.9643, 1.7604, 1.8086, 1.9530,
        1.8983, 1.9914], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573,
        0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573,
        0.5573, 0.5573], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 1])) = tensor([[0.0173],
        [0.0171],
        [0.0135],
        [0.0192],
        [0.0158],
        [0.0156],
        [0.0168],
        [0.0148],
        [0.0181],
        [0.0126],
        [0.0156],
        [0.0167],
        [0.0167],
        [0.0165],
        [0.0144],
        [0.0160],
        [0.0168],
        [0.0155],
        [0.0174],
        [0.0110]], device='cuda:0')
inv_Z_H_Z_k.mean (expected to be = 0.01587301584782061) = 0.0158701129257679
Var (shape: torch.Size([20, 1])) = tensor([[0.0250],
        [0.0247],
        [0.0195],
        [0.0277],
        [0.0228],
        [0.0225],
        [0.0243],
        [0.0214],
        [0.0261],
        [0.0182],
        [0.0226],
        [0.0240],
        [0.0242],
        [0.0238],
        [0.0207],
        [0.0231],
        [0.0242],
        [0.0223],
        [0.0251],
        [0.0158]], device='cuda:0')
***********
SINR = tensor([11.4856, 11.5309, 12.5586, 11.0368, 11.8829, 11.9488, 11.6061, 12.1585,
        11.2938, 12.8631, 11.9259, 11.6522, 11.6310, 11.6974, 12.2935, 11.8261,
        11.6289, 11.9747, 11.4616, 13.4705], device='cuda:0')
Real_SINR = tensor([11.6132,  7.7621, 11.5694,  9.0799, 11.5828,  9.8902, 10.1926,  9.0346,
        10.9236, 12.7171, 12.2504, 10.8367, 11.9239,  9.9766, 10.3867, 10.7710,
        12.2175,  9.3705, 11.5008, 12.6566], device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9337, 0.9343, 0.9474, 0.9270, 0.9391, 0.9400, 0.9354, 0.9427, 0.9309,
        0.9508, 0.9397, 0.9360, 0.9357, 0.9366, 0.9443, 0.9384, 0.9357, 0.9403,
        0.9333, 0.9570], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([67, 66, 54, 73, 62, 61, 65, 59, 70, 51, 62, 65, 65, 64, 57, 63, 65, 61,
        67, 45], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/M=64/K=1/dynamic/
20 images are saved in outputs/MIMOdiffusion/M=64/K=1/nonoisenosample/
--------SNR = 0,  rho_ul = 1.0-----------
G_variance = tensor([1.0132, 1.1328, 1.1866, 0.8969, 1.0578, 0.9983, 0.8538, 1.0656, 0.8404,
        0.8284, 1.1366, 1.1971, 1.0598, 1.1127, 1.1392, 1.1149, 1.0522, 0.8152,
        1.0239, 1.1566], device='cuda:0')
G_hat_variance = tensor([0.4807, 0.4869, 0.4956, 0.4819, 0.4770, 0.5480, 0.4232, 0.5792, 0.4357,
        0.4833, 0.5231, 0.5436, 0.5873, 0.5919, 0.4535, 0.5004, 0.4469, 0.4227,
        0.5584, 0.5659], device='cuda:0')
G_tilde_var = tensor([0.4920, 0.5165, 0.5228, 0.4705, 0.5203, 0.4693, 0.5124, 0.5200, 0.4657,
        0.4125, 0.5635, 0.6243, 0.4850, 0.5506, 0.5774, 0.4980, 0.5451, 0.4371,
        0.4721, 0.5982], device='cuda:0')
gamma = tensor([[[0.5000]]], device='cuda:0')
Z_mean = tensor([-0.0656+0.1015j, -0.0220-0.1414j, -0.0389+0.0528j,  0.0262+0.0536j,
         0.0240-0.0404j, -0.0556-0.0020j, -0.1555-0.0367j,  0.0589+0.0201j,
         0.0336+0.0291j, -0.0954+0.0513j,  0.0370+0.0459j, -0.0372+0.0422j,
         0.0170-0.0647j,  0.0196+0.0158j, -0.0598-0.0575j, -0.0393-0.0450j,
        -0.0174-0.0778j,  0.1352-0.0797j,  0.0722+0.0509j,  0.1134+0.0280j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.9614, 0.9737, 0.9911, 0.9638, 0.9539, 1.0961, 0.8464, 1.1584, 0.8714,
        0.9666, 1.0462, 1.0872, 1.1746, 1.1839, 0.9070, 1.0009, 0.8939, 0.8455,
        1.1168, 1.1318], device='cuda:0')
Real_SNR = tensor([ 0.4354,  1.1949,  2.1035, -0.1346,  0.5569,  0.4204, -0.3508,  0.7183,
        -0.3922, -0.3931,  0.9377,  1.1886,  0.6721,  0.8584,  1.3019,  0.6405,
         0.5326, -0.1467,  0.6126,  0.9953], device='cuda:0')
q_var = tensor([0.7198, 0.4265, 0.5737, 0.6398, 0.7661, 0.7163, 0.6677, 0.8443, 0.7045,
        0.7006, 0.8890, 0.6916, 0.7820, 0.7259, 0.5843, 0.5859, 0.8244, 0.4483,
        0.7216, 0.7546], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.7198, 0.4265, 0.5737, 0.6398, 0.7661, 0.7163, 0.6677, 0.8443, 0.7045,
        0.7006, 0.8890, 0.6916, 0.7820, 0.7259, 0.5843, 0.5859, 0.8244, 0.4483,
        0.7216, 0.7546], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([1.1073, 1.3157, 1.6266, 0.9698, 1.1360, 1.0978, 0.9204, 1.1826, 0.9142,
        0.9136, 1.2396, 1.3107, 1.1682, 1.2207, 1.3518, 1.1632, 1.1247, 0.9678,
        1.1497, 1.2556], device='cuda:0')
signal_var = tensor([1.1073, 1.3157, 1.6266, 0.9698, 1.1360, 1.0978, 0.9204, 1.1826, 0.9142,
        0.9136, 1.2396, 1.3107, 1.1682, 1.2207, 1.3518, 1.1632, 1.1247, 0.9678,
        1.1497, 1.2556], device='cuda:0')
w_var = tensor([1.0016, 0.9992, 1.0021, 1.0004, 0.9992, 0.9965, 0.9978, 1.0024, 1.0006,
        1.0001, 0.9989, 0.9969, 1.0007, 1.0017, 1.0017, 1.0037, 0.9949, 1.0011,
        0.9984, 0.9984], device='cuda:0')
y_var = tensor([2.1097, 2.3101, 2.6306, 1.9702, 2.1396, 2.0955, 1.9252, 2.1870, 1.9144,
        1.9139, 2.2396, 2.3047, 2.1740, 2.2235, 2.3545, 2.1720, 2.1185, 1.9729,
        2.1442, 2.2509], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000,
        0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000,
        0.5000, 0.5000], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 1])) = tensor([[0.0163],
        [0.0160],
        [0.0159],
        [0.0164],
        [0.0166],
        [0.0144],
        [0.0182],
        [0.0137],
        [0.0182],
        [0.0162],
        [0.0151],
        [0.0146],
        [0.0135],
        [0.0134],
        [0.0174],
        [0.0158],
        [0.0176],
        [0.0182],
        [0.0141],
        [0.0139]], device='cuda:0')
inv_Z_H_Z_k.mean (expected to be = 0.01587301584782061) = 0.015770236030220985
Var (shape: torch.Size([20, 1])) = tensor([[0.0244],
        [0.0239],
        [0.0239],
        [0.0246],
        [0.0249],
        [0.0217],
        [0.0273],
        [0.0205],
        [0.0273],
        [0.0243],
        [0.0227],
        [0.0218],
        [0.0202],
        [0.0201],
        [0.0261],
        [0.0237],
        [0.0264],
        [0.0274],
        [0.0212],
        [0.0208]], device='cuda:0')
***********
SINR = tensor([13.1179, 13.1984, 13.2025, 13.0784, 13.0275, 13.6329, 12.6288, 13.8753,
        12.6344, 13.1278, 13.4328, 13.5980, 13.9380, 13.9576, 12.8315, 13.2416,
        12.7661, 12.6199, 13.7326, 13.8127], device='cuda:0')
Real_SINR = tensor([13.0275, 10.3160, 10.7041, 12.6767, 12.8686, 14.0796, 11.8535, 10.6750,
        11.9729, 12.6969, 12.6482, 12.9139, 14.5274, 13.6857, 10.8756, 11.5584,
        10.1791, 10.0879, 11.7091, 13.3226], device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9535, 0.9543, 0.9543, 0.9531, 0.9526, 0.9585, 0.9482, 0.9606, 0.9483,
        0.9536, 0.9566, 0.9582, 0.9612, 0.9614, 0.9505, 0.9547, 0.9498, 0.9481,
        0.9594, 0.9601], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([49, 48, 48, 49, 50, 44, 54, 42, 54, 49, 46, 44, 41, 41, 52, 47, 52, 54,
        43, 42], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/M=64/K=1/dynamic/
20 images are saved in outputs/MIMOdiffusion/M=64/K=1/nonoisenosample/
--------SNR = 1,  rho_ul = 1.2589254117941673-----------
G_variance = tensor([0.7496, 1.2274, 0.6354, 1.0033, 1.2544, 1.1163, 0.8642, 0.8893, 0.8484,
        0.8193, 0.9223, 0.9642, 0.9519, 1.2637, 1.0953, 0.9979, 1.1101, 1.0998,
        1.0694, 0.7118], device='cuda:0')
G_hat_variance = tensor([0.5467, 0.6689, 0.4253, 0.4920, 0.5725, 0.5829, 0.5406, 0.4416, 0.5468,
        0.4122, 0.5096, 0.5913, 0.5687, 0.7092, 0.5210, 0.5976, 0.5524, 0.6229,
        0.6215, 0.5306], device='cuda:0')
G_tilde_var = tensor([0.4281, 0.4723, 0.2914, 0.5306, 0.5045, 0.4616, 0.4391, 0.3632, 0.4285,
        0.3579, 0.4441, 0.5003, 0.4322, 0.5037, 0.5070, 0.4348, 0.5211, 0.4240,
        0.4927, 0.3651], device='cuda:0')
gamma = tensor([[[0.5573]]], device='cuda:0')
Z_mean = tensor([-0.0095+0.0680j, -0.1317+0.0027j, -0.1088+0.0740j,  0.0893-0.0389j,
         0.0673-0.0323j, -0.0075-0.1183j, -0.0126+0.0016j,  0.0587+0.0463j,
         0.1139+0.0942j, -0.0916-0.0575j, -0.0086+0.0984j,  0.1173-0.0066j,
         0.1690-0.0445j, -0.0596-0.0327j, -0.0798-0.1384j, -0.0922-0.0892j,
        -0.0081+0.0092j,  0.0888-0.0106j, -0.1168-0.0124j,  0.0379+0.1183j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.9809, 1.2003, 0.7632, 0.8828, 1.0272, 1.0459, 0.9700, 0.7924, 0.9811,
        0.7397, 0.9143, 1.0610, 1.0204, 1.2725, 0.9348, 1.0723, 0.9911, 1.1176,
        1.1151, 0.9521], device='cuda:0')
Real_SNR = tensor([ 0.2157,  2.5927,  0.4191,  1.3586,  2.3011,  1.8931,  0.6093,  0.9363,
         0.6123,  0.5235,  1.1124,  1.2966,  1.3109,  2.3932,  2.1615,  1.1623,
         1.7364,  2.1241,  1.8191, -0.1959], device='cuda:0')
q_var = tensor([0.7198, 0.4265, 0.5737, 0.6398, 0.7661, 0.7163, 0.6677, 0.8443, 0.7045,
        0.7006, 0.8890, 0.6916, 0.7820, 0.7259, 0.5843, 0.5859, 0.8244, 0.4483,
        0.7216, 0.7546], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.7198, 0.4265, 0.5737, 0.6398, 0.7661, 0.7163, 0.6677, 0.8443, 0.7045,
        0.7006, 0.8890, 0.6916, 0.7820, 0.7259, 0.5843, 0.5859, 0.8244, 0.4483,
        0.7216, 0.7546], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([0.8386, 1.4475, 0.8782, 1.0813, 1.3451, 1.2287, 0.9146, 0.9850, 0.9122,
        0.9016, 1.0246, 1.0668, 1.0739, 1.3795, 1.3036, 1.0383, 1.1829, 1.2897,
        1.2081, 0.7581], device='cuda:0')
signal_var = tensor([1.0558, 1.8224, 1.1055, 1.3613, 1.6934, 1.5468, 1.1515, 1.2401, 1.1483,
        1.1351, 1.2899, 1.3430, 1.3519, 1.7367, 1.6411, 1.3072, 1.4892, 1.6237,
        1.5210, 0.9544], device='cuda:0')
w_var = tensor([1.0046, 1.0031, 1.0038, 0.9956, 0.9969, 1.0003, 1.0007, 0.9996, 0.9973,
        1.0062, 0.9984, 0.9964, 0.9997, 1.0010, 0.9977, 1.0002, 0.9984, 0.9956,
        1.0005, 0.9984], device='cuda:0')
y_var = tensor([2.0602, 2.8237, 2.1044, 2.3527, 2.6867, 2.5415, 2.1524, 2.2412, 2.1493,
        2.1359, 2.2936, 2.3413, 2.3485, 2.7401, 2.6380, 2.3165, 2.4840, 2.6209,
        2.5179, 1.9503], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([0.4427, 0.4427, 0.4427, 0.4427, 0.4427, 0.4427, 0.4427, 0.4427, 0.4427,
        0.4427, 0.4427, 0.4427, 0.4427, 0.4427, 0.4427, 0.4427, 0.4427, 0.4427,
        0.4427, 0.4427], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 1])) = tensor([[0.0161],
        [0.0130],
        [0.0203],
        [0.0178],
        [0.0154],
        [0.0150],
        [0.0164],
        [0.0199],
        [0.0158],
        [0.0211],
        [0.0172],
        [0.0148],
        [0.0151],
        [0.0124],
        [0.0165],
        [0.0146],
        [0.0160],
        [0.0141],
        [0.0141],
        [0.0164]], device='cuda:0')
inv_Z_H_Z_k.mean (expected to be = 0.01587301584782061) = 0.016095930710434914
Var (shape: torch.Size([20, 1])) = tensor([[0.0251],
        [0.0203],
        [0.0317],
        [0.0277],
        [0.0239],
        [0.0233],
        [0.0255],
        [0.0310],
        [0.0246],
        [0.0329],
        [0.0267],
        [0.0230],
        [0.0235],
        [0.0194],
        [0.0257],
        [0.0227],
        [0.0249],
        [0.0220],
        [0.0219],
        [0.0255]], device='cuda:0')
***********
SINR = tensor([14.4682, 15.3867, 13.4558, 14.0366, 14.6709, 14.7845, 14.3992, 13.5509,
        14.5448, 13.2903, 14.1886, 14.8449, 14.7484, 15.5934, 14.3564, 14.9008,
        14.4925, 15.0450, 15.0579, 14.3883], device='cuda:0')
Real_SINR = tensor([11.2002, 12.9457, 12.2993, 12.5758, 12.5340, 14.8816, 10.7301, 13.6517,
        12.3772, 11.9588, 14.5659, 13.3027, 14.4652, 15.9534, 13.4186, 13.2214,
        13.7684, 13.1287, 14.7118, 10.8015], device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9655, 0.9719, 0.9568, 0.9620, 0.9670, 0.9678, 0.9650, 0.9577, 0.9661,
        0.9552, 0.9633, 0.9683, 0.9676, 0.9732, 0.9646, 0.9687, 0.9657, 0.9697,
        0.9697, 0.9649], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([37, 30, 45, 40, 35, 35, 37, 45, 36, 47, 39, 34, 35, 29, 38, 34, 37, 33,
        33, 38], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/M=64/K=1/dynamic/
20 images are saved in outputs/MIMOdiffusion/M=64/K=1/nonoisenosample/
--------SNR = 2,  rho_ul = 1.5848931924611136-----------
G_variance = tensor([1.0127, 0.8660, 1.1275, 1.0361, 1.0107, 1.0361, 0.9506, 1.0553, 1.0176,
        1.1897, 1.0944, 0.9930, 0.9970, 0.9931, 0.8903, 1.2122, 0.8564, 0.9497,
        0.9043, 0.8548], device='cuda:0')
G_hat_variance = tensor([0.7531, 0.4839, 0.7014, 0.6694, 0.7153, 0.5619, 0.5921, 0.7134, 0.6888,
        0.7405, 0.6494, 0.6355, 0.6631, 0.6374, 0.6302, 0.6669, 0.4966, 0.5524,
        0.6006, 0.5707], device='cuda:0')
G_tilde_var = tensor([0.2846, 0.3853, 0.3833, 0.3409, 0.4187, 0.4362, 0.3384, 0.3523, 0.3629,
        0.3677, 0.3503, 0.4012, 0.3623, 0.3522, 0.3656, 0.4052, 0.4265, 0.3666,
        0.4052, 0.3403], device='cuda:0')
gamma = tensor([[[0.6131]]], device='cuda:0')
Z_mean = tensor([ 0.1377-0.0741j,  0.0775+0.1222j, -0.0996-0.0431j,  0.1569-0.0914j,
        -0.1186-0.0472j,  0.0836+0.0413j,  0.0561+0.0934j,  0.0661+0.0386j,
         0.0845-0.0552j, -0.0830-0.0785j,  0.0397+0.0870j,  0.0082-0.1746j,
        -0.0124+0.0642j,  0.0398-0.0405j, -0.0510-0.0374j, -0.1699-0.0765j,
        -0.0704-0.2438j, -0.0499-0.0612j, -0.1468-0.0473j, -0.0694+0.1913j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.2283, 0.7892, 1.1439, 1.0917, 1.1666, 0.9164, 0.9657, 1.1636, 1.1235,
        1.2077, 1.0592, 1.0364, 1.0815, 1.0396, 1.0278, 1.0877, 0.8100, 0.9009,
        0.9795, 0.9308], device='cuda:0')
Real_SNR = tensor([2.4451, 2.0196, 3.9027, 2.5511, 2.3891, 2.5881, 2.0992, 2.7422, 2.4326,
        3.1621, 2.7502, 2.4205, 2.4202, 2.3571, 2.2285, 3.0094, 1.6612, 2.4829,
        2.1014, 1.6130], device='cuda:0')
q_var = tensor([0.7198, 0.4265, 0.5737, 0.6398, 0.7661, 0.7163, 0.6677, 0.8443, 0.7045,
        0.7006, 0.8890, 0.6916, 0.7820, 0.7259, 0.5843, 0.5859, 0.8244, 0.4483,
        0.7216, 0.7546], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.7198, 0.4265, 0.5737, 0.6398, 0.7661, 0.7163, 0.6677, 0.8443, 0.7045,
        0.7006, 0.8890, 0.6916, 0.7820, 0.7259, 0.5843, 0.5859, 0.8244, 0.4483,
        0.7216, 0.7546], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([1.1075, 1.0071, 1.5498, 1.1393, 1.0859, 1.1449, 1.0193, 1.1820, 1.1014,
        1.3090, 1.1903, 1.0977, 1.1023, 1.0896, 1.0549, 1.2629, 0.9245, 1.1163,
        1.0218, 0.9112], device='cuda:0')
signal_var = tensor([1.7552, 1.5961, 2.4562, 1.8056, 1.7211, 1.8146, 1.6155, 1.8733, 1.7455,
        2.0747, 1.8865, 1.7398, 1.7471, 1.7269, 1.6719, 2.0016, 1.4653, 1.7692,
        1.6194, 1.4442], device='cuda:0')
w_var = tensor([0.9996, 1.0025, 1.0000, 1.0035, 0.9929, 0.9999, 0.9963, 0.9963, 0.9969,
        1.0017, 1.0015, 0.9964, 1.0007, 1.0036, 1.0008, 1.0010, 0.9995, 0.9988,
        0.9982, 0.9962], device='cuda:0')
y_var = tensor([2.7635, 2.6023, 3.4515, 2.8055, 2.7133, 2.8051, 2.6103, 2.8683, 2.7459,
        3.0801, 2.8913, 2.7365, 2.7494, 2.7258, 2.6737, 3.0058, 2.4644, 2.7602,
        2.6111, 2.4409], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([0.3869, 0.3869, 0.3869, 0.3869, 0.3869, 0.3869, 0.3869, 0.3869, 0.3869,
        0.3869, 0.3869, 0.3869, 0.3869, 0.3869, 0.3869, 0.3869, 0.3869, 0.3869,
        0.3869, 0.3869], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 1])) = tensor([[0.0127],
        [0.0196],
        [0.0137],
        [0.0141],
        [0.0134],
        [0.0172],
        [0.0162],
        [0.0136],
        [0.0140],
        [0.0130],
        [0.0149],
        [0.0149],
        [0.0146],
        [0.0152],
        [0.0154],
        [0.0141],
        [0.0181],
        [0.0175],
        [0.0158],
        [0.0163]], device='cuda:0')
inv_Z_H_Z_k.mean (expected to be = 0.01587301584782061) = 0.015215459279716015
Var (shape: torch.Size([20, 1])) = tensor([[0.0204],
        [0.0316],
        [0.0222],
        [0.0228],
        [0.0216],
        [0.0277],
        [0.0262],
        [0.0219],
        [0.0226],
        [0.0210],
        [0.0240],
        [0.0240],
        [0.0236],
        [0.0246],
        [0.0248],
        [0.0228],
        [0.0292],
        [0.0282],
        [0.0255],
        [0.0263]], device='cuda:0')
***********
SINR = tensor([16.7723, 14.8795, 16.4214, 16.3045, 16.5227, 15.4549, 15.6947, 16.4725,
        16.3377, 16.6594, 16.0800, 16.0757, 16.1500, 15.9745, 15.9286, 16.2959,
        15.2144, 15.3695, 15.8081, 15.6728], device='cuda:0')
Real_SINR = tensor([17.1729, 13.2535, 15.5095, 13.4614, 14.7829, 15.5897, 14.6889, 17.6985,
        16.4221, 16.2415, 16.7583, 16.2417, 14.4339, 15.2762, 14.3707, 14.6202,
        15.0454, 12.5920, 14.1261, 15.1760], device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9794, 0.9685, 0.9777, 0.9771, 0.9782, 0.9723, 0.9738, 0.9780, 0.9773,
        0.9789, 0.9759, 0.9759, 0.9763, 0.9754, 0.9751, 0.9771, 0.9708, 0.9718,
        0.9744, 0.9736], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([23, 34, 24, 25, 24, 30, 28, 24, 25, 23, 26, 26, 26, 27, 27, 25, 32, 31,
        28, 29], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/M=64/K=1/dynamic/
20 images are saved in outputs/MIMOdiffusion/M=64/K=1/nonoisenosample/
--------SNR = 3,  rho_ul = 1.9952623149688795-----------
G_variance = tensor([1.1346, 0.8733, 1.0362, 0.8738, 0.9439, 1.2383, 0.9728, 0.9534, 0.8458,
        0.8314, 0.6997, 0.7847, 0.9348, 0.9647, 0.9119, 0.9433, 0.8823, 0.6350,
        0.8507, 0.8642], device='cuda:0')
G_hat_variance = tensor([0.7513, 0.6720, 0.7330, 0.6546, 0.6255, 0.6590, 0.5926, 0.5976, 0.5483,
        0.6581, 0.5305, 0.5348, 0.6244, 0.6412, 0.6761, 0.6016, 0.5900, 0.4228,
        0.5025, 0.6502], device='cuda:0')
G_tilde_var = tensor([0.3329, 0.3275, 0.2679, 0.3136, 0.3849, 0.3969, 0.2755, 0.3754, 0.3615,
        0.3658, 0.2820, 0.2864, 0.2694, 0.2794, 0.2779, 0.3182, 0.3229, 0.2748,
        0.3442, 0.3139], device='cuda:0')
gamma = tensor([[[0.6661]]], device='cuda:0')
Z_mean = tensor([ 0.0043-0.1061j, -0.0501+0.0089j, -0.0905+0.0524j,  0.0269+0.2086j,
        -0.0175+0.0110j, -0.0176+0.0423j, -0.0797+0.1065j, -0.0323-0.1381j,
        -0.0600-0.1389j, -0.0029-0.0732j,  0.0549-0.1649j, -0.0490+0.0527j,
        -0.1374+0.0198j,  0.0039-0.0624j, -0.1680-0.0193j, -0.0105-0.0123j,
         0.1179-0.0177j,  0.0372+0.1275j, -0.0486-0.1145j, -0.0808+0.1009j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.1279, 1.0087, 1.1004, 0.9827, 0.9391, 0.9892, 0.8895, 0.8971, 0.8231,
        0.9879, 0.7964, 0.8029, 0.9374, 0.9625, 1.0150, 0.9032, 0.8856, 0.6347,
        0.7543, 0.9761], device='cuda:0')
Real_SNR = tensor([4.0176, 3.1070, 4.5531, 2.9252, 3.0478, 4.4024, 3.2081, 3.3045, 2.7155,
        2.6645, 1.9004, 2.3358, 3.1355, 3.2483, 3.4285, 2.9219, 2.7460, 1.8393,
        2.7918, 2.6845], device='cuda:0')
q_var = tensor([0.7198, 0.4265, 0.5737, 0.6398, 0.7661, 0.7163, 0.6677, 0.8443, 0.7045,
        0.7006, 0.8890, 0.6916, 0.7820, 0.7259, 0.5843, 0.5859, 0.8244, 0.4483,
        0.7216, 0.7546], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.7198, 0.4265, 0.5737, 0.6398, 0.7661, 0.7163, 0.6677, 0.8443, 0.7045,
        0.7006, 0.8890, 0.6916, 0.7820, 0.7259, 0.5843, 0.5859, 0.8244, 0.4483,
        0.7216, 0.7546], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([1.2605, 1.0236, 1.4272, 0.9831, 1.0127, 1.3787, 1.0513, 1.0717, 0.9358,
        0.9235, 0.7775, 0.8600, 1.0343, 1.0594, 1.1041, 0.9793, 0.9473, 0.7676,
        0.9565, 0.9336], device='cuda:0')
signal_var = tensor([2.5151, 2.0424, 2.8477, 1.9614, 2.0207, 2.7508, 2.0976, 2.1383, 1.8672,
        1.8426, 1.5513, 1.7160, 2.0637, 2.1137, 2.2030, 1.9540, 1.8901, 1.5316,
        1.9085, 1.8628], device='cuda:0')
w_var = tensor([0.9972, 0.9987, 0.9981, 1.0001, 1.0016, 0.9982, 1.0021, 0.9991, 0.9992,
        0.9976, 1.0015, 1.0022, 1.0025, 1.0005, 1.0004, 0.9971, 1.0043, 1.0028,
        1.0035, 1.0040], device='cuda:0')
y_var = tensor([3.5073, 3.0455, 3.8447, 2.9604, 3.0277, 3.7599, 3.1028, 3.1440, 2.8652,
        2.8403, 2.5594, 2.7135, 3.0661, 3.1143, 3.2057, 2.9522, 2.8875, 2.5373,
        2.9061, 2.8720], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([0.3339, 0.3339, 0.3339, 0.3339, 0.3339, 0.3339, 0.3339, 0.3339, 0.3339,
        0.3339, 0.3339, 0.3339, 0.3339, 0.3339, 0.3339, 0.3339, 0.3339, 0.3339,
        0.3339, 0.3339], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 1])) = tensor([[0.0139],
        [0.0157],
        [0.0143],
        [0.0154],
        [0.0169],
        [0.0160],
        [0.0175],
        [0.0173],
        [0.0188],
        [0.0160],
        [0.0192],
        [0.0196],
        [0.0166],
        [0.0164],
        [0.0152],
        [0.0176],
        [0.0176],
        [0.0243],
        [0.0206],
        [0.0160]], device='cuda:0')
inv_Z_H_Z_k.mean (expected to be = 0.01587301584782061) = 0.017247775569558144
Var (shape: torch.Size([20, 1])) = tensor([[0.0232],
        [0.0261],
        [0.0238],
        [0.0257],
        [0.0281],
        [0.0267],
        [0.0291],
        [0.0288],
        [0.0312],
        [0.0266],
        [0.0320],
        [0.0327],
        [0.0276],
        [0.0274],
        [0.0253],
        [0.0293],
        [0.0294],
        [0.0405],
        [0.0343],
        [0.0266]], device='cuda:0')
***********
SINR = tensor([17.5786, 17.0611, 17.4709, 17.1305, 16.7409, 16.9742, 16.5905, 16.6383,
        16.2875, 16.9830, 16.1875, 16.0868, 16.8208, 16.8639, 17.1991, 16.5709,
        16.5547, 15.1582, 15.8771, 16.9817], device='cuda:0')
Real_SINR = tensor([17.5230, 14.2927, 17.1181, 16.5516, 15.6379, 13.8642, 14.0385, 17.8172,
        16.6077, 13.9578, 15.4186, 16.4474, 17.0767, 16.2549, 16.4288, 16.4362,
        17.2494, 13.0709, 16.7155, 15.1666], device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9828, 0.9807, 0.9824, 0.9810, 0.9793, 0.9803, 0.9785, 0.9788, 0.9770,
        0.9804, 0.9765, 0.9760, 0.9796, 0.9798, 0.9813, 0.9784, 0.9784, 0.9704,
        0.9748, 0.9804], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([19, 21, 19, 21, 23, 22, 23, 23, 25, 22, 26, 26, 22, 22, 21, 24, 24, 32,
        27, 22], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/M=64/K=1/dynamic/
20 images are saved in outputs/MIMOdiffusion/M=64/K=1/nonoisenosample/
--------SNR = 4,  rho_ul = 2.51188643150958-----------
G_variance = tensor([1.0935, 0.7119, 0.9980, 1.0572, 0.8520, 0.8817, 1.2030, 0.8715, 0.9509,
        0.9205, 0.7962, 1.1516, 0.9621, 1.1284, 0.7822, 1.0319, 1.0078, 0.8830,
        1.1018, 0.9648], device='cuda:0')
G_hat_variance = tensor([0.7053, 0.6266, 0.7743, 0.7619, 0.6901, 0.6504, 0.8358, 0.6925, 0.7097,
        0.7148, 0.6095, 0.8609, 0.7315, 0.8603, 0.5712, 0.7186, 0.6421, 0.5864,
        0.7807, 0.8932], device='cuda:0')
G_tilde_var = tensor([0.3463, 0.2456, 0.2394, 0.2323, 0.3235, 0.3310, 0.2437, 0.2393, 0.2455,
        0.2687, 0.2103, 0.2665, 0.2479, 0.2701, 0.3188, 0.2980, 0.3271, 0.2871,
        0.2599, 0.2569], device='cuda:0')
gamma = tensor([[[0.7153]]], device='cuda:0')
Z_mean = tensor([ 0.0008+0.0244j, -0.0373+0.0951j,  0.0822-0.0012j,  0.1123+0.0159j,
        -0.0040-0.0254j, -0.0708+0.0849j,  0.0055-0.0278j, -0.2185+0.0506j,
         0.0615-0.0112j,  0.0443+0.0629j,  0.0320+0.1232j,  0.0756+0.1339j,
         0.1647-0.0149j, -0.1630-0.1246j, -0.1972+0.0069j,  0.0506+0.0356j,
        -0.0262+0.1233j,  0.0965-0.0270j,  0.0985+0.2086j,  0.0309-0.0017j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.9861, 0.8761, 1.0825, 1.0652, 0.9649, 0.9093, 1.1685, 0.9682, 0.9922,
        0.9994, 0.8521, 1.2036, 1.0227, 1.2027, 0.7985, 1.0047, 0.8977, 0.8199,
        1.0916, 1.2487], device='cuda:0')
Real_SNR = tensor([4.7841, 3.2224, 5.3486, 4.6070, 3.6038, 3.8867, 5.0330, 3.8912, 4.1284,
        4.0495, 3.4558, 5.0296, 4.2908, 4.9418, 3.8822, 4.2988, 4.4223, 4.1469,
        4.9913, 4.1197], device='cuda:0')
q_var = tensor([0.7198, 0.4265, 0.5737, 0.6398, 0.7661, 0.7163, 0.6677, 0.8443, 0.7045,
        0.7006, 0.8890, 0.6916, 0.7820, 0.7259, 0.5843, 0.5859, 0.8244, 0.4483,
        0.7216, 0.7546], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.7198, 0.4265, 0.5737, 0.6398, 0.7661, 0.7163, 0.6677, 0.8443, 0.7045,
        0.7006, 0.8890, 0.6916, 0.7820, 0.7259, 0.5843, 0.5859, 0.8244, 0.4483,
        0.7216, 0.7546], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([1.1961, 0.8271, 1.3682, 1.1424, 0.9153, 0.9747, 1.2682, 0.9740, 1.0252,
        1.0143, 0.8794, 1.2697, 1.0696, 1.2497, 0.9732, 1.0710, 1.0995, 1.0355,
        1.2583, 1.0254], device='cuda:0')
signal_var = tensor([3.0046, 2.0776, 3.4367, 2.8697, 2.2992, 2.4483, 3.1855, 2.4467, 2.5752,
        2.5479, 2.2090, 3.1894, 2.6868, 3.1392, 2.4446, 2.6902, 2.7617, 2.6010,
        3.1606, 2.5758], device='cuda:0')
w_var = tensor([0.9986, 0.9893, 1.0029, 0.9934, 1.0028, 1.0005, 0.9997, 0.9988, 0.9953,
        1.0028, 0.9968, 1.0017, 1.0004, 1.0061, 1.0000, 0.9998, 0.9976, 1.0011,
        1.0015, 0.9975], device='cuda:0')
y_var = tensor([4.0094, 3.0691, 4.4459, 3.8521, 3.2976, 3.4566, 4.1882, 3.4419, 3.5713,
        3.5420, 3.2058, 4.1942, 3.6877, 4.1472, 3.4443, 3.7015, 3.7687, 3.6061,
        4.1694, 3.5731], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([0.2847, 0.2847, 0.2847, 0.2847, 0.2847, 0.2847, 0.2847, 0.2847, 0.2847,
        0.2847, 0.2847, 0.2847, 0.2847, 0.2847, 0.2847, 0.2847, 0.2847, 0.2847,
        0.2847, 0.2847], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 1])) = tensor([[0.0161],
        [0.0179],
        [0.0146],
        [0.0147],
        [0.0164],
        [0.0172],
        [0.0136],
        [0.0156],
        [0.0159],
        [0.0158],
        [0.0183],
        [0.0129],
        [0.0151],
        [0.0127],
        [0.0189],
        [0.0157],
        [0.0174],
        [0.0191],
        [0.0139],
        [0.0127]], device='cuda:0')
inv_Z_H_Z_k.mean (expected to be = 0.01587301584782061) = 0.01572982594370842
Var (shape: torch.Size([20, 1])) = tensor([[0.0276],
        [0.0307],
        [0.0250],
        [0.0253],
        [0.0282],
        [0.0295],
        [0.0233],
        [0.0267],
        [0.0273],
        [0.0271],
        [0.0313],
        [0.0222],
        [0.0259],
        [0.0219],
        [0.0325],
        [0.0270],
        [0.0298],
        [0.0328],
        [0.0238],
        [0.0218]], device='cuda:0')
***********
SINR = tensor([18.1364, 17.6724, 18.5664, 18.5219, 18.0424, 17.8405, 18.8740, 18.2779,
        18.1781, 18.2182, 17.5827, 19.0855, 18.4085, 19.1481, 17.4277, 18.2317,
        17.8033, 17.3860, 18.7851, 19.1628], device='cuda:0')
Real_SINR = tensor([14.8312, 13.4500, 17.9549, 18.4174, 15.3953, 16.9614, 17.1784, 16.8072,
        18.7684, 13.9485, 19.0138, 19.1982, 19.0279, 18.2169, 16.3912, 18.3336,
        15.2272, 16.0735, 19.0400, 16.8320], device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9849, 0.9832, 0.9863, 0.9861, 0.9845, 0.9838, 0.9872, 0.9854, 0.9850,
        0.9852, 0.9829, 0.9878, 0.9858, 0.9880, 0.9822, 0.9852, 0.9837, 0.9821,
        0.9869, 0.9880], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([17, 18, 15, 15, 17, 18, 14, 16, 16, 16, 19, 13, 16, 13, 20, 16, 18, 20,
        14, 13], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/M=64/K=1/dynamic/
20 images are saved in outputs/MIMOdiffusion/M=64/K=1/nonoisenosample/
--------SNR = 5,  rho_ul = 3.1622776601683795-----------
G_variance = tensor([1.0667, 0.8559, 1.1413, 1.1375, 0.9072, 1.0860, 1.2558, 1.3292, 1.1617,
        1.1829, 0.8860, 1.0104, 0.8884, 0.9139, 1.0168, 0.9881, 1.0953, 1.2364,
        1.0407, 0.8531], device='cuda:0')
G_hat_variance = tensor([0.8115, 0.7526, 0.7614, 0.9859, 0.7421, 0.9758, 0.9252, 0.9157, 0.7507,
        0.7989, 0.7533, 0.8501, 0.6375, 0.6279, 0.7359, 0.6957, 0.7716, 0.9650,
        0.7876, 0.6381], device='cuda:0')
G_tilde_var = tensor([0.2075, 0.2056, 0.2749, 0.2171, 0.2013, 0.2104, 0.2349, 0.2508, 0.2413,
        0.2198, 0.2328, 0.1876, 0.2272, 0.2499, 0.2435, 0.2695, 0.2753, 0.2909,
        0.2608, 0.2180], device='cuda:0')
gamma = tensor([[[0.7597]]], device='cuda:0')
Z_mean = tensor([ 0.0675+0.1342j, -0.0065+0.0469j,  0.0130+0.1107j, -0.1379-0.0841j,
         0.0099+0.0050j,  0.0031-0.0264j,  0.0479-0.1121j, -0.0260-0.1854j,
        -0.0441-0.2132j, -0.0781-0.0424j,  0.0747+0.0609j,  0.0023+0.0907j,
        -0.0244-0.1203j, -0.1061+0.1248j, -0.0622-0.1249j, -0.0835-0.1138j,
         0.1387+0.1435j,  0.0843-0.0564j,  0.0175+0.1109j,  0.0521-0.0363j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.0681, 0.9906, 1.0022, 1.2976, 0.9768, 1.2844, 1.2178, 1.2053, 0.9881,
        1.0516, 0.9915, 1.1190, 0.8391, 0.8265, 0.9686, 0.9157, 1.0156, 1.2701,
        1.0367, 0.8398], device='cuda:0')
Real_SNR = tensor([5.7105, 4.9694, 6.9315, 5.8853, 4.8774, 5.7663, 6.2421, 6.7628, 6.0169,
        6.1327, 4.8555, 5.4753, 4.9298, 5.0712, 5.8140, 5.1615, 5.7741, 6.6125,
        5.6514, 4.5863], device='cuda:0')
q_var = tensor([0.7198, 0.4265, 0.5737, 0.6398, 0.7661, 0.7163, 0.6677, 0.8443, 0.7045,
        0.7006, 0.8890, 0.6916, 0.7820, 0.7259, 0.5843, 0.5859, 0.8244, 0.4483,
        0.7216, 0.7546], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.7198, 0.4265, 0.5737, 0.6398, 0.7661, 0.7163, 0.6677, 0.8443, 0.7045,
        0.7006, 0.8890, 0.6916, 0.7820, 0.7259, 0.5843, 0.5859, 0.8244, 0.4483,
        0.7216, 0.7546], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([1.1746, 0.9939, 1.5678, 1.2289, 0.9731, 1.1981, 1.3246, 1.4987, 1.2604,
        1.3031, 0.9697, 1.1185, 0.9821, 1.0185, 1.2099, 1.0380, 1.2021, 1.4510,
        1.1661, 0.9079], device='cuda:0')
signal_var = tensor([3.7144, 3.1429, 4.9578, 3.8861, 3.0772, 3.7888, 4.1889, 4.7393, 3.9857,
        4.1209, 3.0663, 3.5370, 3.1056, 3.2209, 3.8261, 3.2826, 3.8014, 4.5885,
        3.6874, 2.8709], device='cuda:0')
w_var = tensor([0.9973, 1.0009, 1.0049, 1.0023, 1.0010, 1.0043, 0.9951, 0.9987, 0.9973,
        1.0040, 1.0025, 1.0025, 0.9981, 1.0020, 1.0031, 1.0001, 1.0058, 1.0010,
        1.0036, 0.9986], device='cuda:0')
y_var = tensor([4.7219, 4.1405, 5.9584, 4.8770, 4.0791, 4.7953, 5.1794, 5.7559, 4.9716,
        5.1284, 4.0590, 4.5328, 4.1193, 4.2108, 4.8228, 4.2744, 4.7916, 5.5875,
        4.6899, 3.8713], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([0.2403, 0.2403, 0.2403, 0.2403, 0.2403, 0.2403, 0.2403, 0.2403, 0.2403,
        0.2403, 0.2403, 0.2403, 0.2403, 0.2403, 0.2403, 0.2403, 0.2403, 0.2403,
        0.2403, 0.2403], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 1])) = tensor([[0.0145],
        [0.0160],
        [0.0156],
        [0.0120],
        [0.0162],
        [0.0124],
        [0.0129],
        [0.0128],
        [0.0153],
        [0.0150],
        [0.0159],
        [0.0141],
        [0.0186],
        [0.0186],
        [0.0161],
        [0.0170],
        [0.0150],
        [0.0124],
        [0.0151],
        [0.0188]], device='cuda:0')
inv_Z_H_Z_k.mean (expected to be = 0.01587301584782061) = 0.015210750512778759
Var (shape: torch.Size([20, 1])) = tensor([[0.0256],
        [0.0281],
        [0.0275],
        [0.0211],
        [0.0286],
        [0.0217],
        [0.0227],
        [0.0225],
        [0.0270],
        [0.0264],
        [0.0279],
        [0.0248],
        [0.0327],
        [0.0327],
        [0.0283],
        [0.0298],
        [0.0265],
        [0.0218],
        [0.0266],
        [0.0331]], device='cuda:0')
***********
SINR = tensor([19.7242, 19.3145, 19.4094, 20.5649, 19.2443, 20.4351, 20.2550, 20.2828,
        19.5001, 19.5971, 19.3497, 19.8661, 18.6623, 18.6587, 19.2948, 19.0580,
        19.5824, 20.4195, 19.5553, 18.6086], device='cuda:0')
Real_SINR = tensor([20.3933, 16.2361, 18.0471, 19.9865, 19.7641, 20.0736, 19.5796, 17.6533,
        17.4592, 16.1951, 16.8296, 19.0810, 19.8882, 16.9133, 19.2152, 18.9015,
        20.0760, 18.2723, 20.0580, 19.7428], device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9895, 0.9884, 0.9887, 0.9913, 0.9882, 0.9910, 0.9907, 0.9907, 0.9889,
        0.9891, 0.9885, 0.9898, 0.9866, 0.9866, 0.9884, 0.9877, 0.9891, 0.9910,
        0.9890, 0.9864], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([12, 13, 12, 10, 13, 10, 10, 10, 12, 12, 13, 11, 15, 15, 13, 14, 12, 10,
        12, 15], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/M=64/K=1/dynamic/
20 images are saved in outputs/MIMOdiffusion/M=64/K=1/nonoisenosample/
--------SNR = 6,  rho_ul = 3.9810717055349722-----------
G_variance = tensor([0.9115, 0.7586, 1.0310, 0.9409, 0.9954, 1.0858, 0.8738, 0.9764, 0.8985,
        1.1191, 0.9583, 0.9971, 1.0801, 1.1101, 0.8091, 0.9929, 0.9110, 1.0077,
        0.9094, 0.9755], device='cuda:0')
G_hat_variance = tensor([0.6087, 0.5875, 0.8613, 0.7745, 0.7998, 0.9635, 0.7291, 0.7282, 0.6925,
        0.8779, 0.8327, 0.8758, 0.8989, 0.8773, 0.7172, 0.8500, 0.6785, 0.7105,
        0.7686, 0.6992], device='cuda:0')
G_tilde_var = tensor([0.2024, 0.1935, 0.2040, 0.2193, 0.1965, 0.1699, 0.2419, 0.1542, 0.1648,
        0.1782, 0.1772, 0.2020, 0.2250, 0.2184, 0.1855, 0.1928, 0.2136, 0.1982,
        0.2378, 0.2083], device='cuda:0')
gamma = tensor([[[0.7992]]], device='cuda:0')
Z_mean = tensor([-0.0798+0.1058j,  0.0384-0.0553j, -0.0883-0.0902j, -0.0493+0.0344j,
         0.1418-0.0227j, -0.0555+0.0860j,  0.2188+0.1022j,  0.0994+0.0412j,
        -0.0574-0.0686j,  0.0538+0.0372j,  0.0174-0.0162j, -0.0524-0.0162j,
        -0.0263+0.1244j, -0.0830-0.0044j, -0.0377+0.0816j, -0.0154+0.0197j,
        -0.0481+0.0236j, -0.1522+0.0695j,  0.0114-0.0446j, -0.0378-0.1230j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.7615, 0.7351, 1.0776, 0.9690, 1.0007, 1.2056, 0.9122, 0.9111, 0.8664,
        1.0984, 1.0418, 1.0958, 1.1246, 1.0976, 0.8973, 1.0635, 0.8489, 0.8889,
        0.9616, 0.8749], device='cuda:0')
Real_SNR = tensor([6.0445, 5.4588, 7.5449, 6.0586, 6.3640, 6.8108, 5.9850, 6.3679, 5.8922,
        6.9175, 6.1978, 6.3773, 6.8365, 6.8567, 5.8794, 6.1049, 5.8978, 6.7549,
        6.1266, 6.1388], device='cuda:0')
q_var = tensor([0.7198, 0.4265, 0.5737, 0.6398, 0.7661, 0.7163, 0.6677, 0.8443, 0.7045,
        0.7006, 0.8890, 0.6916, 0.7820, 0.7259, 0.5843, 0.5859, 0.8244, 0.4483,
        0.7216, 0.7546], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.7198, 0.4265, 0.5737, 0.6398, 0.7661, 0.7163, 0.6677, 0.8443, 0.7045,
        0.7006, 0.8890, 0.6916, 0.7820, 0.7259, 0.5843, 0.5859, 0.8244, 0.4483,
        0.7216, 0.7546], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([1.0034, 0.8810, 1.4265, 1.0168, 1.0835, 1.2001, 0.9962, 1.0899, 0.9738,
        1.2329, 1.0421, 1.0934, 1.2064, 1.2157, 0.9703, 1.0280, 0.9771, 1.1845,
        1.0236, 1.0377], device='cuda:0')
signal_var = tensor([3.9947, 3.5074, 5.6792, 4.0480, 4.3135, 4.7777, 3.9661, 4.3392, 3.8769,
        4.9084, 4.1485, 4.3527, 4.8027, 4.8400, 3.8627, 4.0924, 3.8900, 4.7156,
        4.0750, 4.1313], device='cuda:0')
w_var = tensor([0.9932, 0.9979, 0.9995, 1.0032, 0.9964, 0.9957, 0.9997, 1.0014, 0.9983,
        0.9981, 0.9957, 1.0024, 0.9950, 0.9981, 0.9976, 1.0034, 1.0004, 0.9955,
        0.9942, 1.0051], device='cuda:0')
y_var = tensor([4.9925, 4.5029, 6.6985, 5.0544, 5.3091, 5.7811, 4.9523, 5.3547, 4.8933,
        5.9033, 5.1435, 5.3569, 5.7864, 5.8352, 4.8624, 5.0900, 4.8937, 5.7107,
        5.0678, 5.1291], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([0.2008, 0.2008, 0.2008, 0.2008, 0.2008, 0.2008, 0.2008, 0.2008, 0.2008,
        0.2008, 0.2008, 0.2008, 0.2008, 0.2008, 0.2008, 0.2008, 0.2008, 0.2008,
        0.2008, 0.2008], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 1])) = tensor([[0.0204],
        [0.0215],
        [0.0145],
        [0.0163],
        [0.0155],
        [0.0131],
        [0.0163],
        [0.0172],
        [0.0181],
        [0.0144],
        [0.0152],
        [0.0144],
        [0.0139],
        [0.0144],
        [0.0175],
        [0.0149],
        [0.0186],
        [0.0173],
        [0.0165],
        [0.0178]], device='cuda:0')
inv_Z_H_Z_k.mean (expected to be = 0.01587301584782061) = 0.016396449878811836
Var (shape: torch.Size([20, 1])) = tensor([[0.0366],
        [0.0386],
        [0.0261],
        [0.0294],
        [0.0280],
        [0.0235],
        [0.0294],
        [0.0309],
        [0.0327],
        [0.0259],
        [0.0274],
        [0.0260],
        [0.0250],
        [0.0259],
        [0.0315],
        [0.0268],
        [0.0335],
        [0.0311],
        [0.0296],
        [0.0320]], device='cuda:0')
***********
SINR = tensor([19.3868, 19.1599, 20.8587, 20.3490, 20.5625, 21.3194, 20.3435, 20.1208,
        19.8873, 20.8940, 20.6497, 20.8788, 21.0424, 20.9015, 20.0383, 20.7391,
        19.7728, 20.0948, 20.3090, 19.9715], device='cuda:0')
Real_SINR = tensor([17.8555, 17.2972, 17.1700, 20.2975, 20.5804, 20.9764, 17.2925, 19.4489,
        20.1790, 19.4084, 21.9962, 20.4652, 21.8056, 20.4555, 18.8021, 19.9866,
        19.5773, 17.2266, 19.2509, 19.9233], device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9886, 0.9880, 0.9919, 0.9909, 0.9913, 0.9927, 0.9908, 0.9904, 0.9898,
        0.9919, 0.9915, 0.9919, 0.9922, 0.9919, 0.9902, 0.9916, 0.9896, 0.9903,
        0.9908, 0.9900], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([13, 13,  9, 10, 10,  8, 10, 11, 11,  9,  9,  9,  9,  9, 11,  9, 11, 11,
        10, 11], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/M=64/K=1/dynamic/
20 images are saved in outputs/MIMOdiffusion/M=64/K=1/nonoisenosample/
--------SNR = 7,  rho_ul = 5.011872336272722-----------
G_variance = tensor([1.0999, 0.8210, 1.0809, 1.0607, 0.7677, 0.9536, 0.9934, 1.2263, 1.1881,
        0.7608, 0.8988, 0.9238, 1.0085, 1.1227, 1.2781, 1.0191, 0.9799, 1.1335,
        1.0745, 1.0494], device='cuda:0')
G_hat_variance = tensor([0.9272, 0.6587, 0.8589, 0.9107, 0.6317, 0.8403, 0.8072, 0.9665, 0.9155,
        0.6622, 0.6772, 0.7782, 0.8257, 0.8887, 0.9974, 0.7582, 0.8182, 0.9012,
        0.8048, 0.8341], device='cuda:0')
G_tilde_var = tensor([0.1635, 0.1704, 0.1505, 0.1604, 0.1459, 0.1446, 0.2451, 0.1976, 0.1749,
        0.1845, 0.1932, 0.1517, 0.1740, 0.1595, 0.2211, 0.1846, 0.1642, 0.1853,
        0.1641, 0.1341], device='cuda:0')
gamma = tensor([[[0.8337]]], device='cuda:0')
Z_mean = tensor([ 0.0320-0.0181j, -0.0057+0.0255j, -0.0324-0.0024j, -0.1449+0.0719j,
         0.0587-0.0646j,  0.0067-0.0587j,  0.0247-0.0056j,  0.0752+0.0643j,
         0.0933-0.1096j,  0.0582-0.0136j,  0.0241+0.1035j,  0.1180-0.0245j,
        -0.0503-0.0474j, -0.0165-0.0403j, -0.0131-0.2690j, -0.0811+0.0378j,
        -0.0121+0.0032j, -0.0330+0.1097j,  0.0504-0.0529j, -0.0185+0.0073j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.1121, 0.7901, 1.0302, 1.0925, 0.7578, 1.0080, 0.9683, 1.1593, 1.0981,
        0.7943, 0.8123, 0.9335, 0.9905, 1.0661, 1.1964, 0.9095, 0.9815, 1.0810,
        0.9653, 1.0006], device='cuda:0')
Real_SNR = tensor([7.7871, 6.7660, 8.7009, 7.6268, 6.1908, 7.2177, 7.2012, 8.3539, 8.1088,
        6.2311, 6.9261, 7.0590, 7.4814, 7.8854, 8.8975, 7.2295, 7.2096, 8.2757,
        7.8209, 7.4745], device='cuda:0')
q_var = tensor([0.7198, 0.4265, 0.5737, 0.6398, 0.7661, 0.7163, 0.6677, 0.8443, 0.7045,
        0.7006, 0.8890, 0.6916, 0.7820, 0.7259, 0.5843, 0.5859, 0.8244, 0.4483,
        0.7216, 0.7546], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.7198, 0.4265, 0.5737, 0.6398, 0.7661, 0.7163, 0.6677, 0.8443, 0.7045,
        0.7006, 0.8890, 0.6916, 0.7820, 0.7259, 0.5843, 0.5859, 0.8244, 0.4483,
        0.7216, 0.7546], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([1.2001, 0.9525, 1.4825, 1.1540, 0.8320, 1.0506, 1.0483, 1.3656, 1.2963,
        0.8401, 0.9823, 1.0178, 1.1135, 1.2263, 1.5473, 1.0562, 1.0473, 1.3361,
        1.2095, 1.1115], device='cuda:0')
signal_var = tensor([6.0149, 4.7740, 7.4299, 5.7838, 4.1697, 5.2654, 5.2538, 6.8440, 6.4968,
        4.2103, 4.9234, 5.1013, 5.5807, 6.1462, 7.7547, 5.2935, 5.2489, 6.6964,
        6.0620, 5.5707], device='cuda:0')
w_var = tensor([1.0012, 1.0053, 1.0020, 0.9989, 1.0024, 0.9992, 1.0008, 0.9998, 1.0042,
        1.0028, 0.9992, 1.0041, 0.9967, 1.0002, 0.9996, 1.0018, 0.9979, 0.9960,
        1.0012, 0.9965], device='cuda:0')
y_var = tensor([7.0241, 5.7708, 8.4453, 6.7925, 5.1775, 6.2749, 6.2269, 7.8510, 7.5058,
        5.2181, 5.9066, 6.1070, 6.5780, 7.1372, 8.7497, 6.2905, 6.2473, 7.6888,
        7.0604, 6.5608], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([0.1663, 0.1663, 0.1663, 0.1663, 0.1663, 0.1663, 0.1663, 0.1663, 0.1663,
        0.1663, 0.1663, 0.1663, 0.1663, 0.1663, 0.1663, 0.1663, 0.1663, 0.1663,
        0.1663, 0.1663], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 1])) = tensor([[0.0143],
        [0.0201],
        [0.0154],
        [0.0142],
        [0.0207],
        [0.0157],
        [0.0164],
        [0.0136],
        [0.0142],
        [0.0199],
        [0.0193],
        [0.0167],
        [0.0159],
        [0.0149],
        [0.0125],
        [0.0173],
        [0.0162],
        [0.0145],
        [0.0164],
        [0.0159]], device='cuda:0')
inv_Z_H_Z_k.mean (expected to be = 0.01587301584782061) = 0.016193030402064323
Var (shape: torch.Size([20, 1])) = tensor([[0.0261],
        [0.0368],
        [0.0282],
        [0.0260],
        [0.0380],
        [0.0288],
        [0.0300],
        [0.0249],
        [0.0260],
        [0.0365],
        [0.0353],
        [0.0307],
        [0.0292],
        [0.0273],
        [0.0229],
        [0.0317],
        [0.0296],
        [0.0266],
        [0.0300],
        [0.0291]], device='cuda:0')
***********
SINR = tensor([22.0371, 20.5508, 21.7040, 22.0585, 20.4095, 21.6198, 21.4332, 22.2493,
        22.0592, 20.5899, 20.7281, 21.3391, 21.5499, 21.8558, 22.6085, 21.1965,
        21.4898, 21.9616, 21.4411, 21.5743], device='cuda:0')
Real_SINR = tensor([20.1244, 19.5123, 18.3728, 19.2500, 21.7491, 21.6550, 19.4549, 21.6057,
        20.4940, 19.1859, 20.0358, 20.8690, 18.3722, 19.7108, 21.7554, 18.9642,
        22.2272, 20.5325, 17.4738, 21.2915], device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9938, 0.9913, 0.9933, 0.9938, 0.9910, 0.9932, 0.9929, 0.9941, 0.9938,
        0.9913, 0.9916, 0.9927, 0.9931, 0.9935, 0.9945, 0.9925, 0.9930, 0.9937,
        0.9929, 0.9931], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 7, 10,  7,  7, 10,  7,  8,  6,  7,  9,  9,  8,  8,  7,  6,  8,  8,  7,
         8,  7], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/M=64/K=1/dynamic/
20 images are saved in outputs/MIMOdiffusion/M=64/K=1/nonoisenosample/
--------SNR = 8,  rho_ul = 6.309573444801933-----------
G_variance = tensor([0.9335, 0.7389, 1.0938, 1.1533, 0.9039, 0.9738, 0.9114, 0.9411, 0.9537,
        0.9132, 1.2792, 1.2692, 0.9702, 0.8710, 0.8638, 0.9312, 1.0312, 0.9907,
        0.7783, 0.9161], device='cuda:0')
G_hat_variance = tensor([0.7428, 0.6752, 0.9376, 0.9467, 0.7514, 0.9245, 0.8588, 0.8672, 0.8992,
        0.8407, 1.0343, 1.2173, 0.8053, 0.7583, 0.8475, 0.7967, 0.8031, 0.9330,
        0.6302, 0.8064], device='cuda:0')
G_tilde_var = tensor([0.1446, 0.1490, 0.1418, 0.1139, 0.1246, 0.1158, 0.1106, 0.1206, 0.1437,
        0.1194, 0.1726, 0.1199, 0.1302, 0.1297, 0.1057, 0.1389, 0.1842, 0.1244,
        0.1530, 0.1395], device='cuda:0')
gamma = tensor([[[0.8632]]], device='cuda:0')
Z_mean = tensor([ 0.0072-0.1101j,  0.0177-0.1326j,  0.0295+0.1681j, -0.0319-0.1510j,
         0.1380-0.0022j,  0.0907+0.0338j, -0.1070-0.1096j, -0.0340+0.1785j,
        -0.0373+0.0435j, -0.1070-0.0285j,  0.0412-0.0770j,  0.0097+0.1524j,
         0.0767+0.0064j, -0.0378+0.1120j,  0.0629+0.0725j, -0.0424+0.0225j,
         0.0480-0.0356j,  0.2224+0.1953j,  0.0065-0.2366j,  0.0841+0.1143j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.8605, 0.7822, 1.0861, 1.0967, 0.8705, 1.0710, 0.9949, 1.0047, 1.0417,
        0.9739, 1.1982, 1.4102, 0.9329, 0.8785, 0.9819, 0.9229, 0.9304, 1.0808,
        0.7301, 0.9342], device='cuda:0')
Real_SNR = tensor([8.1103, 7.4020, 9.7735, 8.9781, 7.8712, 8.3298, 7.8946, 8.2500, 8.1175,
        8.0409, 9.4271, 9.4713, 8.3112, 7.8102, 8.1260, 7.8520, 8.4158, 8.7932,
        7.5754, 7.9505], device='cuda:0')
q_var = tensor([0.7198, 0.4265, 0.5737, 0.6398, 0.7661, 0.7163, 0.6677, 0.8443, 0.7045,
        0.7006, 0.8890, 0.6916, 0.7820, 0.7259, 0.5843, 0.5859, 0.8244, 0.4483,
        0.7216, 0.7546], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.7198, 0.4265, 0.5737, 0.6398, 0.7661, 0.7163, 0.6677, 0.8443, 0.7045,
        0.7006, 0.8890, 0.6916, 0.7820, 0.7259, 0.5843, 0.5859, 0.8244, 0.4483,
        0.7216, 0.7546], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([1.0276, 0.8679, 1.5101, 1.2543, 0.9715, 1.0798, 0.9746, 1.0599, 1.0312,
        1.0083, 1.3957, 1.4030, 1.0734, 0.9572, 1.0244, 0.9656, 1.1037, 1.2011,
        0.9054, 0.9933], device='cuda:0')
signal_var = tensor([6.4836, 5.4760, 9.5280, 7.9140, 6.1298, 6.8131, 6.1492, 6.6877, 6.5062,
        6.3618, 8.8063, 8.8521, 6.7729, 6.0396, 6.4636, 6.0927, 6.9638, 7.5782,
        5.7129, 6.2676], device='cuda:0')
w_var = tensor([1.0018, 0.9960, 1.0038, 1.0014, 1.0008, 1.0008, 0.9985, 1.0006, 1.0036,
        0.9988, 1.0048, 0.9998, 0.9992, 1.0000, 0.9951, 0.9991, 1.0029, 1.0006,
        0.9984, 1.0047], device='cuda:0')
y_var = tensor([ 7.5033,  6.4689, 10.5219,  8.9261,  7.1204,  7.8120,  7.1592,  7.6761,
         7.5101,  7.3520,  9.7812,  9.8517,  7.7860,  7.0486,  7.4526,  7.0936,
         7.9754,  8.5818,  6.7068,  7.2708], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([0.1368, 0.1368, 0.1368, 0.1368, 0.1368, 0.1368, 0.1368, 0.1368, 0.1368,
        0.1368, 0.1368, 0.1368, 0.1368, 0.1368, 0.1368, 0.1368, 0.1368, 0.1368,
        0.1368, 0.1368], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 1])) = tensor([[0.0182],
        [0.0198],
        [0.0142],
        [0.0142],
        [0.0178],
        [0.0147],
        [0.0156],
        [0.0153],
        [0.0152],
        [0.0161],
        [0.0132],
        [0.0111],
        [0.0169],
        [0.0178],
        [0.0160],
        [0.0172],
        [0.0170],
        [0.0136],
        [0.0202],
        [0.0166]], device='cuda:0')
inv_Z_H_Z_k.mean (expected to be = 0.01587301584782061) = 0.01602647826075554
Var (shape: torch.Size([20, 1])) = tensor([[0.0339],
        [0.0369],
        [0.0265],
        [0.0264],
        [0.0332],
        [0.0274],
        [0.0290],
        [0.0285],
        [0.0283],
        [0.0300],
        [0.0245],
        [0.0206],
        [0.0315],
        [0.0331],
        [0.0298],
        [0.0320],
        [0.0317],
        [0.0253],
        [0.0376],
        [0.0310]], device='cuda:0')
***********
SINR = tensor([22.0616, 21.6849, 23.1276, 23.1477, 22.1450, 22.9883, 22.7327, 22.8147,
        22.8433, 22.5923, 23.4651, 24.2173, 22.3781, 22.1589, 22.6136, 22.3146,
        22.3555, 23.3329, 21.6115, 22.4502], device='cuda:0')
Real_SINR = tensor([20.3943, 18.7224, 22.1959, 22.0911, 22.6091, 20.9692, 22.8267, 22.2882,
        21.0712, 22.5696, 24.0398, 23.1084, 21.9156, 22.1825, 20.7648, 22.5123,
        22.3227, 21.8740, 20.5604, 23.6611], device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9938, 0.9933, 0.9952, 0.9952, 0.9939, 0.9950, 0.9947, 0.9948, 0.9948,
        0.9945, 0.9955, 0.9962, 0.9942, 0.9940, 0.9946, 0.9942, 0.9942, 0.9954,
        0.9931, 0.9943], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([7, 7, 5, 5, 7, 5, 6, 6, 6, 6, 5, 4, 6, 7, 6, 6, 6, 5, 7, 6],
       device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/M=64/K=1/dynamic/
20 images are saved in outputs/MIMOdiffusion/M=64/K=1/nonoisenosample/
--------SNR = 9,  rho_ul = 7.943282347242816-----------
G_variance = tensor([1.0204, 1.0649, 0.7872, 0.9309, 1.0127, 0.9456, 1.0931, 1.0193, 1.1318,
        0.7768, 1.1368, 1.0978, 1.1739, 0.9881, 1.0732, 1.0141, 1.0221, 1.0688,
        1.2082, 0.9389], device='cuda:0')
G_hat_variance = tensor([0.9832, 0.9606, 0.6997, 0.7989, 0.9491, 0.8542, 0.9599, 0.7991, 0.9913,
        0.7238, 1.0822, 1.0188, 1.0102, 0.9262, 0.9204, 0.9186, 0.8416, 0.9156,
        1.0726, 0.7758], device='cuda:0')
G_tilde_var = tensor([0.0959, 0.0900, 0.1266, 0.1124, 0.0891, 0.1244, 0.0951, 0.1261, 0.1025,
        0.1255, 0.1255, 0.1146, 0.1030, 0.1113, 0.1045, 0.1116, 0.0939, 0.1232,
        0.0984, 0.1360], device='cuda:0')
gamma = tensor([[[0.8882]]], device='cuda:0')
Z_mean = tensor([-0.1713-0.0006j, -0.0409+0.0835j, -0.0463+0.0134j, -0.0172-0.0345j,
         0.1394-0.0605j,  0.0869-0.0906j, -0.0527-0.0056j,  0.0800-0.1740j,
         0.0108+0.0919j, -0.0044+0.0383j,  0.1271-0.0411j, -0.0549-0.0340j,
         0.1151+0.1101j, -0.0734+0.0441j, -0.0892-0.1194j, -0.0328+0.0751j,
         0.1017+0.0873j, -0.1094+0.0921j, -0.1183+0.1884j,  0.1664-0.0671j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.1070, 1.0815, 0.7878, 0.8995, 1.0686, 0.9618, 1.0807, 0.8997, 1.1161,
        0.8149, 1.2184, 1.1470, 1.1374, 1.0428, 1.0363, 1.0342, 0.9475, 1.0309,
        1.2076, 0.8735], device='cuda:0')
Real_SNR = tensor([ 9.5668,  9.9426,  9.3271,  9.0389,  9.4567,  9.1819,  9.6126,  9.6099,
         9.8569,  8.3589,  9.9565,  9.8124, 10.1863,  9.3895, 10.0720,  9.2296,
         9.4279, 10.0476, 10.4060,  9.0766], device='cuda:0')
q_var = tensor([0.7198, 0.4265, 0.5737, 0.6398, 0.7661, 0.7163, 0.6677, 0.8443, 0.7045,
        0.7006, 0.8890, 0.6916, 0.7820, 0.7259, 0.5843, 0.5859, 0.8244, 0.4483,
        0.7216, 0.7546], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.7198, 0.4265, 0.5737, 0.6398, 0.7661, 0.7163, 0.6677, 0.8443, 0.7045,
        0.7006, 0.8890, 0.6916, 0.7820, 0.7259, 0.5843, 0.5859, 0.8244, 0.4483,
        0.7216, 0.7546], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([1.1385, 1.2413, 1.0806, 1.0100, 1.1096, 1.0490, 1.1542, 1.1512, 1.2156,
        0.8645, 1.2495, 1.2029, 1.3137, 1.0931, 1.2791, 1.0560, 1.0975, 1.2621,
        1.3774, 1.0190], device='cuda:0')
signal_var = tensor([ 9.0437,  9.8604,  8.5835,  8.0229,  8.8138,  8.3328,  9.1678,  9.1444,
         9.6558,  6.8673,  9.9253,  9.5550, 10.4353,  8.6824, 10.1604,  8.3878,
         8.7181, 10.0256, 10.9412,  8.0946], device='cuda:0')
w_var = tensor([0.9992, 0.9992, 1.0022, 1.0010, 0.9988, 1.0060, 1.0023, 1.0004, 0.9979,
        1.0021, 1.0025, 0.9977, 0.9997, 0.9993, 0.9993, 1.0016, 0.9946, 0.9916,
        0.9965, 1.0012], device='cuda:0')
y_var = tensor([10.0461, 10.8817,  9.5720,  9.0402,  9.8046,  9.3346, 10.1691, 10.1362,
        10.6440,  7.8849, 10.9237, 10.5629, 11.4361,  9.6539, 11.1645,  9.3894,
         9.7149, 11.0155, 11.9257,  9.0934], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([0.1118, 0.1118, 0.1118, 0.1118, 0.1118, 0.1118, 0.1118, 0.1118, 0.1118,
        0.1118, 0.1118, 0.1118, 0.1118, 0.1118, 0.1118, 0.1118, 0.1118, 0.1118,
        0.1118, 0.1118], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 1])) = tensor([[0.0140],
        [0.0146],
        [0.0201],
        [0.0176],
        [0.0145],
        [0.0162],
        [0.0146],
        [0.0169],
        [0.0141],
        [0.0194],
        [0.0128],
        [0.0138],
        [0.0136],
        [0.0151],
        [0.0150],
        [0.0152],
        [0.0164],
        [0.0151],
        [0.0126],
        [0.0175]], device='cuda:0')
inv_Z_H_Z_k.mean (expected to be = 0.01587301584782061) = 0.01547117717564106
Var (shape: torch.Size([20, 1])) = tensor([[0.0264],
        [0.0275],
        [0.0379],
        [0.0333],
        [0.0274],
        [0.0307],
        [0.0277],
        [0.0320],
        [0.0266],
        [0.0367],
        [0.0242],
        [0.0260],
        [0.0258],
        [0.0285],
        [0.0283],
        [0.0288],
        [0.0310],
        [0.0285],
        [0.0238],
        [0.0331]], device='cuda:0')
***********
SINR = tensor([24.2750, 24.0935, 22.6952, 23.2654, 24.1004, 23.6204, 24.0666, 23.4352,
        24.2289, 22.8370, 24.6400, 24.3297, 24.3744, 23.9310, 23.9664, 23.8927,
        23.5668, 23.9368, 24.7143, 23.2901], device='cuda:0')
Real_SINR = tensor([23.8892, 22.5442, 22.3764, 23.2518, 25.3844, 23.9398, 24.3614, 22.3938,
        24.1741, 20.8355, 23.6124, 23.8932, 24.3175, 24.5016, 23.1448, 23.7068,
        22.6971, 22.6404, 25.7819, 23.4227], device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9963, 0.9961, 0.9947, 0.9953, 0.9961, 0.9957, 0.9961, 0.9955, 0.9962,
        0.9948, 0.9966, 0.9963, 0.9964, 0.9960, 0.9960, 0.9959, 0.9956, 0.9960,
        0.9966, 0.9953], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([4, 4, 6, 5, 4, 5, 4, 5, 4, 6, 4, 4, 4, 4, 4, 4, 5, 4, 3, 5],
       device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/M=64/K=1/dynamic/
20 images are saved in outputs/MIMOdiffusion/M=64/K=1/nonoisenosample/
